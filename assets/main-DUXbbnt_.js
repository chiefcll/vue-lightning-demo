var ko=Object.defineProperty;var zo=(r,t,e)=>t in r?ko(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var l=(r,t,e)=>(zo(r,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();var $o={BASE_URL:"/vue-lightning-demo/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function Wo(r,t){const e={alpha:!0,antialias:!1,depth:!1,stencil:!0,desynchronized:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!1},s=r.getContext("webgl",e)||r.getContext("experimental-webgl",e);if(!s)throw new Error("Unable to create WebGL context");return t?new Proxy(s,{get(i,n){const o=i[n];return typeof o=="function"?(t.increment(String(n)),o.bind(i)):o}}):s}function P(r,t){if(!qr()&&!r)throw new Error(t||"Assertion failed")}function Ei(r,t,e){const s=Math.trunc(r>>>24),i=Math.trunc(r>>>16&255),n=Math.trunc(r>>>8&255),o=Math.trunc(r&255),a=Math.trunc(t>>>24),c=Math.trunc(t>>>16&255),u=Math.trunc(t>>>8&255),h=Math.trunc(t&255),d=Math.round(a*e+s*(1-e)),x=Math.round(c*e+i*(1-e)),g=Math.round(u*e+n*(1-e)),_=Math.round(h*e+o*(1-e));return(d<<24|x<<16|g<<8|_)>>>0}function Xo(r,t){const e=r>>>24,s=r>>>16&255,i=r>>>8&255,n=Math.trunc((r&255)*t);return(e<<24|s<<16|i<<8|n)>>>0}let xn=!0;function Yo(r){xn=r==="webgl"}function Zt(r,t,e=!1){const s=(r&255)/255*t,i=xn?s:1,n=Math.trunc((r>>>24)*i),o=Math.trunc((r>>>16&255)*i),a=Math.trunc((r>>>8&255)*i),c=Math.trunc(s*255);return e?(c<<24|a<<16|o<<8|n)>>>0:(n<<24|o<<16|a<<8|c)>>>0}function Cr(r,t){return Object.prototype.hasOwnProperty.call(r,t)}function qr(){return $o&&!0}class mn{constructor(t){l(this,"releaseCallback");this.releaseCallback=t}}class Ho extends mn{constructor(e,s){super(e);l(this,"textureMap",new Map);l(this,"zeroReferenceTextureSet",new Set);l(this,"options");this.options={textureCleanupIntervalMs:s.textureCleanupIntervalMs??1e4,textureCleanupAgeThreadholdMs:s.textureCleanupAgeThreadholdMs??6e4},setInterval(()=>{const i=Date.now(),n=this.options.textureCleanupAgeThreadholdMs;for(const o of this.zeroReferenceTextureSet)i-o.lastUpdate>n&&(this.releaseCallback(o.id),this.textureMap.delete(o.id),this.zeroReferenceTextureSet.delete(o))},this.options.textureCleanupIntervalMs)}registerTexture(e){var i;const s=(i=e.options)==null?void 0:i.id;if(P(s,"Texture must have an id to be registered"),!this.textureMap.has(s)){const n={id:s,nodeRefCount:0,lastUpdate:Date.now()};this.textureMap.set(s,n),this.zeroReferenceTextureSet.add(n)}}incrementTextureRefCount(e){var n;const s=(n=e.options)==null?void 0:n.id;P(s,"Texture must have an id to be registered");let i=this.textureMap.get(s);i||(this.registerTexture(e),i=this.textureMap.get(s)),P(i,"Texture must have been registered"),e.txType==="SubTexture"&&this.incrementTextureRefCount(e.props.texture),i.nodeRefCount++,i.lastUpdate=Date.now(),this.zeroReferenceTextureSet.has(i)&&this.zeroReferenceTextureSet.delete(i)}decrementTextureRefCount(e){var n;const s=(n=e.options)==null?void 0:n.id;P(s,"Texture must have an id to be registered");const i=this.textureMap.get(s);P(i,"Texture must have been registered"),i.nodeRefCount--,i.lastUpdate=Date.now(),i.nodeRefCount===0&&this.zeroReferenceTextureSet.add(i),e.txType==="SubTexture"&&this.decrementTextureRefCount(e.props.texture)}}class Go extends mn{constructor(e){super(e);l(this,"registry");this.registry=new FinalizationRegistry(e)}registerTexture(e){var s,i;P((s=e.options)==null?void 0:s.id,"Texture must have an ID to be registered"),this.registry.register(e,(i=e.options)==null?void 0:i.id)}incrementTextureRefCount(){}decrementTextureRefCount(){}}class it{constructor(){l(this,"eventListeners",{})}on(t,e){let s=this.eventListeners[t];s||(s=[]),s.push(e),this.eventListeners[t]=s}off(t,e){const s=this.eventListeners[t];if(!s)return;if(!e){delete this.eventListeners[t];return}const i=s.indexOf(e);i>=0&&s.splice(i,1)}once(t,e){const s=(i,n)=>{this.off(t,s),e(i,n)};this.on(t,s)}emit(t,e){const s=this.eventListeners[t];s&&[...s].forEach(i=>{i(this,e)})}removeAllListeners(){this.eventListeners={}}}const Kt={alpha:r=>r===1?null:{prop:"opacity",value:`${r}`},x:r=>({prop:"left",value:`${r}px`}),y:r=>({prop:"top",value:`${r}px`}),width:r=>r===0?null:{prop:"width",value:`${r}px`},height:r=>r===0?null:{prop:"height",value:`${r}px`},zIndex:()=>"zIndex",fontFamily:()=>"font-family",fontSize:()=>"font-size",fontStyle:()=>"font-style",fontWeight:()=>"font-weight",fontStretch:()=>"font-stretch",lineHeight:()=>"line-height",letterSpacing:()=>"letter-spacing",textAlign:()=>"text-align",overflowSuffix:()=>"overflow-suffix",maxLines:()=>"max-lines",contain:()=>"contain",verticalAlign:()=>"vertical-align",clipping:r=>r===!1?null:{prop:"overflow",value:r?"hidden":"visible"},rotation:r=>r===0?null:{prop:"transform",value:`rotate(${r}rad)`},scale:r=>r===1?null:{prop:"transform",value:`scale(${r})`},scaleX:r=>r===1?null:{prop:"transform",value:`scaleX(${r})`},scaleY:r=>r===1?null:{prop:"transform",value:`scaleY(${r})`},color:r=>r===0?null:{prop:"color",value:_n(r)}},_n=r=>{const t=(r&255)/255,e=r>>8&255,s=r>>16&255;return`rgba(${r>>24&255},${s},${e},${t})`},Vo={id:"id"};class jo{constructor(t,e){l(this,"root",null);l(this,"canvas",null);l(this,"height",1080);l(this,"width",1920);l(this,"scaleX",1);l(this,"scaleY",1);if(qr())return;if(!e)throw new Error("settings is required");this.height=Math.ceil(e.appHeight??1080/(e.deviceLogicalPixelRatio??1)),this.width=Math.ceil(e.appWidth??1900/(e.deviceLogicalPixelRatio??1)),this.scaleX=e.deviceLogicalPixelRatio??1,this.scaleY=e.deviceLogicalPixelRatio??1,this.canvas=t,this.root=document.createElement("div"),this.setRootPosition(),document.body.appendChild(this.root),new MutationObserver(this.setRootPosition.bind(this)).observe(t,{attributes:!0,childList:!1,subtree:!1}),new ResizeObserver(this.setRootPosition.bind(this)).observe(t),window.addEventListener("resize",this.setRootPosition.bind(this)),console.warn("Inspector is enabled, this will impact performance")}setRootPosition(){if(this.root===null||this.canvas===null)return;const t=this.canvas.getBoundingClientRect(),e=document.documentElement.scrollTop+t.top,s=document.documentElement.scrollLeft+t.left;this.root.id="root",this.root.style.left=`${s}px`,this.root.style.top=`${e}px`,this.root.style.width=`${this.width}px`,this.root.style.height=`${this.height}px`,this.root.style.position="absolute",this.root.style.transformOrigin="0 0 0",this.root.style.transform=`scale(${this.scaleX}, ${this.scaleY})`,this.root.style.overflow="hidden",this.root.style.zIndex="65534"}createDiv(t,e){const s=document.createElement("div");s.style.position="absolute",s.id=t.id.toString();for(const i in e)this.updateNodeProperty(s,i,e[i]);return s}createNode(t,e){const s=t.createNode(e),i=this.createDiv(s,e);return i.node=s,s.div=i,this.createProxy(s,i)}createTextNode(t,e){const s=t.createTextNode(e),i=this.createDiv(s,e);return i.node=s,s.div=i,this.createProxy(s,i)}createProxy(t,e){return new Proxy(t,{set:(s,i,n)=>(this.updateNodeProperty(e,i,n),Reflect.set(s,i,n)),get:(s,i,n)=>(i==="destroy"&&this.destroyNode(s),i==="animate"?(o,a)=>{const c=s.animate(o,a);return new Proxy(c,{get:(u,h,d)=>(h==="start"&&this.animateNode(e,t,o,a),Reflect.get(u,h,d))})}:Reflect.get(s,i,n))})}destroyNode(t){const e=document.getElementById(t.id.toString());e==null||e.remove()}updateNodeProperty(t,e,s){var i;if(!(this.root===null||s===void 0||s===null)){if(e==="parent"){const n=s.id;if(n===1){this.root.appendChild(t);return}const o=document.getElementById(n.toString());o==null||o.appendChild(t);return}if(e==="text"){t.innerHTML=String(s),t.style.visibility="hidden";return}if(e==="src"&&s){t.setAttribute("data-src",String(s));return}if(Kt[e]){const n=(i=Kt[e])==null?void 0:i.call(Kt,s);if(n===null)return;if(typeof n=="string"){t.style.setProperty(n,String(s));return}typeof n=="object"&&t.style.setProperty(n.prop,n.value);return}if(Vo[e]){t.setAttribute(String(Kt[e]),String(s));return}if(e==="data"){for(const n in s){const o=s[n];o===void 0?t.removeAttribute(`data-${n}`):t.setAttribute(`data-${n}`,String(o))}return}}}animateNode(t,e,s,i){const{duration:n=1e3,delay:o=0}=i,{x:a,y:c,width:u,height:h,alpha:d=1,rotation:x=0,scale:g=1,color:_}=s;function m(){setTimeout(()=>{t.style.top=`${c}px`,t.style.left=`${a}px`,t.style.width=`${u}px`,t.style.height=`${h}px`,t.style.opacity=`${d}`,t.style.rotate=`${x}rad`,t.style.scale=`${g}`,t.style.color=_n(_)},n)}setTimeout(m,o)}}const Ko="modulepreload",qo=function(r){return"/vue-lightning-demo/"+r},Ci={},Qo=function(t,e,s){let i=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),o=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));i=Promise.all(e.map(a=>{if(a=qo(a),a in Ci)return;Ci[a]=!0;const c=a.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":Ko,c||(h.as="script",h.crossOrigin=""),h.href=a,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((d,x)=>{h.addEventListener("load",d),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${a}`)))})}))}return i.then(()=>t()).catch(n=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=n,window.dispatchEvent(o),!o.defaultPrevented)throw n})};class yn{static makeCacheKey(t){return!1}static resolveDefaults(t){return{}}}function Ii(r,t,e){const s=r.createShader(t);if(!s)throw new Error;if(r.shaderSource(s,e),r.compileShader(s),r.getShaderParameter(s,r.COMPILE_STATUS))return s;console.log(r.getShaderInfoLog(s)),r.deleteShader(s)}function Zo(r,t,e){const s=r.createProgram();if(!s)throw new Error;if(r.attachShader(s,t),r.attachShader(s,e),r.linkProgram(s),r.getProgramParameter(s,r.LINK_STATUS))return s;console.log(r.getProgramInfoLog(s)),r.deleteProgram(s)}function Jo(r){return self.WebGL2RenderingContext&&r instanceof self.WebGL2RenderingContext}class rt extends yn{constructor(e){super();l(this,"boundBufferCollection",null);l(this,"buffersBound",!1);l(this,"program");l(this,"vao");l(this,"renderer");l(this,"glw");l(this,"attributeBuffers");l(this,"attributeLocations");l(this,"attributeNames");l(this,"uniformLocations");l(this,"uniformTypes");l(this,"supportsIndexedTextures");const s=this.renderer=e.renderer,i=this.glw=this.renderer.glw;this.supportsIndexedTextures=e.supportsIndexedTextures||!1;const n=i.isWebGl2(),o=n&&e.webgl2Extensions||!n&&e.webgl1Extensions||[],a=n?"2.0":"1.0";o.forEach(m=>{if(!i.getExtension(m))throw new Error(`Shader "${this.constructor.name}" requires extension "${m}" for WebGL ${a} but wasn't found`)});const c=e.shaderSources||this.constructor.shaderSources;if(c)n&&(c!=null&&c.webGl2)&&(c.fragment=c.webGl2.fragment,c.vertex=c.webGl2.vertex,delete c.webGl2);else throw new Error(`Shader "${this.constructor.name}" is missing shaderSources.`);const u=s.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,h=c.vertex instanceof Function?c.vertex(u):c.vertex,d=c.fragment instanceof Function?c.fragment(u):c.fragment,x=Ii(i,i.VERTEX_SHADER,h),g=Ii(i,i.FRAGMENT_SHADER,d);if(!x||!g)throw new Error;const _=Zo(i,x,g);if(!_)throw new Error;if(this.program=_,n){const m=i.createVertexArray();if(!m)throw new Error;this.vao=m,i.bindVertexArray(this.vao)}this.attributeLocations={},this.attributeBuffers={},this.attributeNames=[],[...e.attributes].forEach(m=>{const v=i.getAttribLocation(this.program,m);if(v<0)throw new Error(`${this.constructor.name}: Vertex shader must have an attribute "${m}"!`);const T=i.createBuffer();if(!T)throw new Error(`${this.constructor.name}: Could not create buffer for attribute "${m}"`);this.attributeLocations[m]=v,this.attributeBuffers[m]=T,this.attributeNames.push(m)}),this.uniformLocations={},this.uniformTypes={},e.uniforms.forEach(m=>{const v=i.getUniformLocation(this.program,m.name);if(this.uniformTypes[m.name]=m.uniform,!v){console.warn(`Shader "${this.constructor.name}" could not get uniform location for "${m.name}"`);return}this.uniformLocations[m.name]=v})}bindBufferAttribute(e,s,i){const{glw:n}=this;n.enableVertexAttribArray(e),n.vertexAttribPointer(s,e,i.size,i.type,i.normalized,i.stride,i.offset)}disableAttribute(e){this.glw.disableVertexAttribArray(e)}disableAttributes(){for(const e in this.attributeLocations)this.disableAttribute(this.attributeLocations[e]);this.boundBufferCollection=null}canBatchShaderProps(e,s){return!1}bindRenderOp(e,s){this.bindBufferCollection(e.buffers),e.textures.length>0&&this.bindTextures(e.textures);const{glw:i}=e;if(this.setUniform("u_resolution",[i.canvas.width,i.canvas.height]),this.setUniform("u_pixelRatio",e.options.pixelRatio),s){if(Cr(s,"$dimensions")){let n=s.$dimensions;n||(n=e.dimensions),this.setUniform("u_dimensions",[n.width,n.height])}if(Cr(s,"$alpha")){let n=s.$alpha;n||(n=e.alpha),this.setUniform("u_alpha",n)}this.bindProps(s)}}setUniform(e,...s){this.glw.setUniform(this.uniformTypes[e],this.uniformLocations[e],...s)}bindBufferCollection(e){if(this.boundBufferCollection!==e){for(const s in this.attributeLocations){const i=e.getBuffer(s),n=e.getAttributeInfo(s);P(i,`Buffer for "${s}" not found`),P(n),this.bindBufferAttribute(this.attributeLocations[s],i,n)}this.boundBufferCollection=e}}bindProps(e){}bindTextures(e){}attach(){this.glw.useProgram(this.program),this.glw.useProgram(this.program),this.glw.isWebGl2()&&this.vao&&this.glw.bindVertexArray(this.vao)}detach(){this.disableAttributes()}}l(rt,"shaderSources");class ve{constructor(t){l(this,"priority",1);l(this,"name","");l(this,"ref");l(this,"target");l(this,"passParameters","");l(this,"declaredUniforms","");l(this,"uniformInfo",{});const{ref:e,target:s,props:i={}}=t;this.ref=e,this.target=s;const n={},o=[];let a="";const c=this.constructor.uniforms||{};for(const u in c){const h=c[u],d=h.type,x=`${e}_${u}`;let g="";h.size&&(g=`[${h.size(i)}]`),o.push(x),a+=`uniform ${d} ${x}${g};`,n[u]={name:x,uniform:c[u].method}}this.passParameters=o.join(","),this.declaredUniforms=a,this.uniformInfo=n}static getEffectKey(t){return""}static getMethodParameters(t,e){const s=[];for(const i in t){const n=t[i];let o="";n.size&&(o=`[${n.size(e)}]`),s.push(`${n.type} ${i}${o}`)}return s.join(",")}static resolveDefaults(t){return{}}static makeEffectKey(t){return!1}}l(ve,"uniforms",{}),l(ve,"methods"),l(ve,"onShaderMask"),l(ve,"onColorize"),l(ve,"onEffectMask");class vs extends it{constructor(e){super();l(this,"txManager");l(this,"dimensions",null);l(this,"error",null);l(this,"state","freed");l(this,"renderableOwners",new Set);this.txManager=e}setRenderableOwner(e,s){s?this.renderableOwners.add(e):this.renderableOwners.delete(e)}get renderable(){return this.renderableOwners.size>0}setState(e,...s){if(this.state!==e){if(this.state=e,e==="loaded"){const i=s;this.dimensions=i[0]}else if(e==="failed"){const i=s;this.error=i[0]}this.emit(e,...s)}}static makeCacheKey(e){return!1}static resolveDefaults(e){return{}}}const ea={x:(r,t)=>{r.props.x=t},y:(r,t)=>{r.props.y=t},width:(r,t)=>{r.props.width=t},height:(r,t)=>{r.props.height=t},color:(r,t)=>{r.props.color=t},zIndex:(r,t)=>{r.props.zIndex=t},fontFamily:(r,t)=>{r.props.fontFamily=t},fontWeight:(r,t)=>{r.props.fontWeight=t},fontStyle:(r,t)=>{r.props.fontStyle=t},fontStretch:(r,t)=>{r.props.fontStretch=t},fontSize:(r,t)=>{r.props.fontSize=t},text:(r,t)=>{r.props.text=t},textAlign:(r,t)=>{r.props.textAlign=t},contain:(r,t)=>{r.props.contain=t},offsetY:(r,t)=>{r.props.offsetY=t},scrollable:(r,t)=>{r.props.scrollable=t},scrollY:(r,t)=>{r.props.scrollY=t},letterSpacing:(r,t)=>{r.props.letterSpacing=t},lineHeight:(r,t)=>{r.props.lineHeight=t},maxLines:(r,t)=>{r.props.maxLines=t},textBaseline:(r,t)=>{r.props.textBaseline=t},verticalAlign:(r,t)=>{r.props.verticalAlign=t},overflowSuffix:(r,t)=>{r.props.overflowSuffix=t},debug:(r,t)=>{r.props.debug=t}};class vn{constructor(t){l(this,"stage");l(this,"set");this.stage=t;const e={...ea,...this.getPropertySetters()};this.set=Object.freeze(Object.fromEntries(Object.entries(e).map(([s,i])=>[s,(n,o)=>{n.props[s]!==o&&(i(n,o),this.stage.requestRender())}])))}setStatus(t,e,s){t.status!==e&&(t.status=e,t.emitter.emit(e,s))}setIsRenderable(t,e){t.isRenderable=e}destroyState(t){["loading","loaded","failed"].forEach(s=>{t.emitter.off(s)})}scheduleUpdateState(t){t.updateScheduled||(t.updateScheduled=!0,queueMicrotask(()=>{t.updateScheduled=!1,this.updateState(t)}))}}const He=r=>{const t=r>>>24,e=r>>>16&255,s=r>>>8&255,i=r&255;return[t/255,e/255,s/255,i/255]},ta=r=>{const t=r>>>24,e=r>>>16&255,s=r>>>8&255,i=r&255;return[t,e,s,i]};function sa(r){return(r&255)/255}function dr(r){const t=Math.floor(r[0]*255),e=Math.floor(r[1]*255),s=Math.floor(r[2]*255),i=Math.floor(r[3]*255);return`rgba(${t},${e},${s},${i.toFixed(4)})`}function ut(r,t,e,s,i){return i?(i.x1=r,i.y1=t,i.x2=e,i.y2=s,i):{x1:r,y1:t,x2:e,y2:s}}function ra(r,t,e){const s=ut(Math.max(r.x1,t.x1),Math.max(r.y1,t.y1),Math.min(r.x2,t.x2),Math.min(r.y2,t.y2),e);return s.x1<s.x2&&s.y1<s.y2?s:ut(0,0,0,0,s)}function fr(r,t){return r.x1<t.x2&&r.x2>t.x1&&r.y1<t.y2&&r.y2>t.y1}function ia(r,t){return t?(t.x=r.x1,t.y=r.y1,t.width=r.x2-r.x1,t.height=r.y2-r.y1,t):{x:r.x1,y:r.y1,width:r.x2-r.x1,height:r.y2-r.y1}}function Qr(r,t,e){const s=Math.max(r.x,t.x),i=Math.max(r.y,t.y),n=Math.min(r.x+r.width,t.x+t.width)-s,o=Math.min(r.y+r.height,t.y+t.height)-i;return n>0&&o>0?e?(e.x=s,e.y=i,e.width=n,e.height=o,e):{x:s,y:i,width:n,height:o}:e?(e.x=0,e.y=0,e.width=0,e.height=0,e):{x:0,y:0,width:0,height:0}}function Tn(r,t){return t?(t.x=r.x,t.y=r.y,t.width=r.width,t.height=r.height,t):{x:r.x,y:r.y,width:r.width,height:r.height}}function na(r,t){return r===t?!0:r===null||t===null?!1:r.x===t.x&&r.y===t.y&&r.width===t.width&&r.height===t.height}function Ai(r,t){return r.x1<=t.x2&&r.y1<=t.y2&&r.x2>=t.x1&&r.y2>=t.y1}function oa(r){return r.x1<r.x2&&r.y1<r.y2}class wn extends it{constructor(e,s){super();l(this,"fontFamily");l(this,"descriptors");l(this,"loaded",!1);this.fontFamily=e,this.descriptors={style:"normal",weight:"normal",stretch:"normal",...s}}static convertToCssFontFaceDescriptors(e){return{style:e.style,weight:typeof e.weight=="number"?`${e.weight}`:e.weight,stretch:e.stretch,unicodeRange:e.unicodeRange,variant:e.variant,featureSettings:e.featureSettings,display:e.display}}}class Mi extends wn{constructor(e,s,i){super(e,s);l(this,"fontFace");l(this,"fontUrl");const n=i.replace(/\(|\)/g,""),o=this.descriptors,a={style:o.style,weight:typeof o.weight=="number"?`${o.weight}`:o.weight,stretch:o.stretch,unicodeRange:o.unicodeRange,variant:o.variant,featureSettings:o.featureSettings,display:o.display},c=new FontFace(e,`url(${n})`,a);c.load().then(()=>{this.loaded=!0,this.emit("loaded")}).catch(console.error),this.fontFace=c,this.fontUrl=i}}const Li=2048;function Ni(r,t,e,s,i){const n=r!=="bottom"?.5*t:0;return e*(s-1)+n+Math.max(e,t)+(i||0)}class aa{constructor(t,e){l(this,"_canvas");l(this,"_context");l(this,"_settings");l(this,"renderInfo");this._canvas=t,this._context=e,this._settings=this.mergeDefaults({})}set settings(t){this._settings=this.mergeDefaults(t)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const t=[this._settings.fontFace],e=[];for(let s=0,i=t.length;s<i;s++)t[s]==="serif"||t[s]==="sans-serif"?e.push(t[s]):e.push(`"${t[s]}"`);return`${this._settings.fontStyle} ${this._settings.fontSize*this.getPrecision()}px ${e.join(",")}`}_load(){if(document.fonts){const t=this._getFontSetting();try{if(!document.fonts.check(t,this._settings.text))return document.fonts.load(t,this._settings.text).catch(e=>{console.warn("[Lightning] Font load error",e,t)}).then(()=>{document.fonts.check(t,this._settings.text)||console.warn("[Lightning] Font not found",t)})}catch{console.warn("[Lightning] Can't check font loading for "+t)}}}calculateRenderInfo(){const t={},e=this.getPrecision(),s=this._settings.paddingLeft*e,i=this._settings.paddingRight*e,n=this._settings.fontSize*e;let o=this._settings.offsetY===null?null:this._settings.offsetY*e,a=(this._settings.lineHeight||n)*e;const c=this._settings.w*e,u=this._settings.h*e;let h=this._settings.wordWrapWidth*e;const d=this._settings.cutSx*e,x=this._settings.cutEx*e,g=this._settings.cutSy*e,_=this._settings.cutEy*e,m=(this._settings.letterSpacing||0)*e,v=this._settings.textIndent*e;this.setFontProperties();let T=c||2048/this.getPrecision(),O=T-s;if(O<10&&(T+=10-O,O=10),h||(h=O),this._settings.textOverflow&&!this._settings.wordWrap){let D;switch(this._settings.textOverflow){case"clip":D="";break;case"ellipsis":D=this._settings.overflowSuffix;break;default:D=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,h-v,D)}let R;if(this._settings.wordWrap)R=this.wrapText(this._settings.text,h,m,v);else{R={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const D=R.l.length;for(let k=0;k<D-1;k++)R.n.push(k)}let E=R.l;if(this._settings.maxLines&&E.length>this._settings.maxLines){const D=E.slice(0,this._settings.maxLines);let k=null;if(this._settings.overflowSuffix){const se=this._settings.overflowSuffix?this.measureText(this._settings.overflowSuffix):0,G=this.wrapText(D[D.length-1],h-se,m,v);D[D.length-1]=`${G.l[0]}${this._settings.overflowSuffix}`,k=[G.l.length>1?G.l[1]:""]}else k=[""];let Y;const X=E.length;let ee=0;const J=R.n.length;for(Y=this._settings.maxLines;Y<X;Y++)k[ee]+=`${k[ee]?" ":""}${E[Y]}`,Y+1<J&&R.n[Y+1]&&ee++;t.remainingText=k.join(`
`),t.moreTextLines=!0,E=D}else t.moreTextLines=!1,t.remainingText="";let F=0;const B=[];for(let D=0;D<E.length;D++){const k=this.measureText(E[D],m)+(D===0?v:0);B.push(k),F=Math.max(F,k)}t.lineWidths=B,c||(T=F+s+i,O=F),a=a||n;let w;return u?w=u:w=Ni(this._settings.textBaseline,n,a,E.length,o),o===null&&(o=n),t.w=T,t.h=w,t.lines=E,t.precision=e,T||(T=1),w||(w=1),(d||x)&&(T=Math.min(T,x-d)),(g||_)&&(w=Math.min(w,_-g)),t.width=T,t.innerWidth=O,t.height=w,t.fontSize=n,t.cutSx=d,t.cutSy=g,t.cutEx=x,t.cutEy=_,t.lineHeight=a,t.lineWidths=B,t.offsetY=o,t.paddingLeft=s,t.paddingRight=i,t.letterSpacing=m,t.textIndent=v,t}draw(t,e){const s=this.getPrecision(),i=(e==null?void 0:e.lines)||t.lines,n=(e==null?void 0:e.lineWidths)||t.lineWidths,o=e?Ni(this._settings.textBaseline,t.fontSize,t.lineHeight,e.lines.length,this._settings.offsetY===null?null:this._settings.offsetY*s):t.height;this._canvas.width=Math.min(Math.ceil(t.width+this._settings.textRenderIssueMargin),Li),this._canvas.height=Math.min(Math.ceil(o),Li),this.setFontProperties(),t.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(t.cutSx||t.cutSy)&&this._context.translate(-t.cutSx,-t.cutSy);let a,c;const u=[];for(let d=0,x=i.length;d<x;d++)a=d===0?t.textIndent:0,c=d*t.lineHeight+t.offsetY,this._settings.verticalAlign=="middle"?c+=(t.lineHeight-t.fontSize)/2:this._settings.verticalAlign=="bottom"&&(c+=t.lineHeight-t.fontSize),this._settings.textAlign==="right"?a+=t.innerWidth-n[d]:this._settings.textAlign==="center"&&(a+=(t.innerWidth-n[d])/2),a+=t.paddingLeft,u.push({text:i[d],x:a,y:c,w:n[d]});if(this._settings.highlight){const d=this._settings.highlightColor,x=this._settings.highlightHeight*s||t.fontSize*1.5,g=this._settings.highlightOffset*s,_=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*s:t.paddingLeft,m=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*s:t.paddingRight;this._context.fillStyle=dr(d);for(let v=0;v<u.length;v++){const T=u[v];this._context.fillRect(T.x-_,T.y-t.offsetY+g,T.w+m+_,x)}}let h=null;this._settings.shadow&&(h=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=dr(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*s,this._context.shadowOffsetY=this._settings.shadowOffsetY*s,this._context.shadowBlur=this._settings.shadowBlur*s),this._context.fillStyle=dr(this._settings.textColor);for(let d=0,x=u.length;d<x;d++){const g=u[d];if(t.letterSpacing===0)this._context.fillText(g.text,g.x,g.y);else{const _=g.text.split("");let m=g.x;for(let v=0,T=_.length;v<T;v++)this._context.fillText(_[v],m,g.y),m+=this.measureText(_[v],t.letterSpacing)}}h&&(this._context.shadowColor=h[0],this._context.shadowOffsetX=h[1],this._context.shadowOffsetY=h[2],this._context.shadowBlur=h[3]),(t.cutSx||t.cutSy)&&this._context.translate(t.cutSx,t.cutSy),this.renderInfo=t}wrapWord(t,e,s){const i=this._context.measureText(s).width,n=t.length,o=this._context.measureText(t).width;if(o<=e)return t;let a=Math.floor(e*n/o),c=this._context.measureText(t.substring(0,a)).width+i;if(c>e)for(;a>0&&(c=this._context.measureText(t.substring(0,a)).width+i,c>e);)a-=1;else for(;a<n;)if(c=this._context.measureText(t.substring(0,a)).width+i,c<e)a+=1;else{a-=1;break}return t.substring(0,a)+(e>=i?s:"")}wrapText(t,e,s,i=0){const n=t.split(/\r?\n/g);let o=[];const a=[];for(let c=0;c<n.length;c++){const u=[];let h="",d=e-i;const x=n[c].split(" ");for(let g=0;g<x.length;g++){const _=this.measureText(x[g],s),m=_+this.measureText(" ",s);g===0||m>d?(g>0&&(u.push(h),h=""),h+=x[g],d=e-_-(g===0?i:0)):(d-=m,h+=` ${x[g]}`)}u.push(h),h="",o=o.concat(u),c<n.length-1&&a.push(o.length)}return{l:o,n:a}}measureText(t,e=0){return e?t.split("").reduce((s,i)=>s+this._context.measureText(i).width+e,0):this._context.measureText(t).width}mergeDefaults(t){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,overflowSuffix:"...",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...t}}}const Pi=typeof self>"u"?globalThis:self;var gn;const Oi=((gn=Pi.document)==null?void 0:gn.fonts)||Pi.fonts;function la(r){const{fontFamily:t,fontStyle:e,fontWeight:s,fontStretch:i,fontSize:n}=r;return[e,s,i,`${n}px`,t].join(" ")}const ca=ut(0,0,0,0);class Fi extends vn{constructor(e){super(e);l(this,"canvas");l(this,"context");l(this,"rendererBounds");typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let s=this.canvas.getContext("2d");s||(this.canvas=document.createElement("canvas"),s=this.canvas.getContext("2d")),P(s),this.context=s,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,s)=>{e.props.fontFamily=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,s)=>{e.props.fontWeight=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,s)=>{e.props.fontStyle=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,s)=>{e.props.fontStretch=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontSize:(e,s)=>{e.props.fontSize=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},text:(e,s)=>{e.props.text=s,this.invalidateLayoutCache(e)},textAlign:(e,s)=>{e.props.textAlign=s,this.invalidateLayoutCache(e)},color:(e,s)=>{e.props.color=s,this.invalidateLayoutCache(e)},x:(e,s)=>{e.props.x=s,this.invalidateVisibleWindowCache(e)},y:(e,s)=>{e.props.y=s,this.invalidateVisibleWindowCache(e)},contain:(e,s)=>{e.props.contain=s,this.invalidateLayoutCache(e)},width:(e,s)=>{e.props.width=s,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,s)=>{e.props.height=s,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,s)=>{e.props.offsetY=s,this.invalidateLayoutCache(e)},scrollY:(e,s)=>{e.props.scrollY=s},letterSpacing:(e,s)=>{e.props.letterSpacing=s,this.invalidateLayoutCache(e)},lineHeight:(e,s)=>{e.props.lineHeight=s,this.invalidateLayoutCache(e)},maxLines:(e,s)=>{e.props.maxLines=s,this.invalidateLayoutCache(e)},textBaseline:(e,s)=>{e.props.textBaseline=s,this.invalidateLayoutCache(e)},verticalAlign:(e,s)=>{e.props.verticalAlign=s,this.invalidateLayoutCache(e)},overflowSuffix:(e,s)=>{e.props.overflowSuffix=s,this.invalidateLayoutCache(e)}}}canRenderFont(e){return!0}isFontFaceSupported(e){return e instanceof Mi}addFontFace(e){P(e instanceof Mi),Oi.add(e.fontFace)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new it,canvasPages:void 0,lightning2TextRenderer:new aa(this.canvas,this.context),renderWindow:void 0,visibleWindow:{x1:0,y1:0,x2:0,y2:0,valid:!1},renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,fontFaceLoadedHandler:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(e){var _,m;if(e.status==="initialState"&&this.setStatus(e,"loading"),!e.fontInfo){const v=la(e.props);if(e.fontInfo={cssString:v,loaded:!1},!e.fontInfo.loaded){Oi.load(v).then(this.onFontLoaded.bind(this,e,v)).catch(this.onFontLoadError.bind(this,e,v));return}}if(!e.fontInfo.loaded)return;if(!e.renderInfo){const v=e.props.maxLines,T=e.props.contain==="both"?Math.floor((e.props.height-e.props.offsetY)/e.props.lineHeight):0,O=T>0&&v>0?Math.min(T,v):Math.max(T,v);e.lightning2TextRenderer.settings={text:e.props.text,textAlign:e.props.textAlign,fontFace:e.props.fontFamily,fontSize:e.props.fontSize,fontStyle:[e.props.fontStretch,e.props.fontStyle,e.props.fontWeight].join(" "),textColor:He(e.props.color),offsetY:e.props.fontSize+e.props.offsetY,wordWrap:e.props.contain!=="none",wordWrapWidth:e.props.contain==="none"?void 0:e.props.width,letterSpacing:e.props.letterSpacing,lineHeight:e.props.lineHeight,maxLines:O,textBaseline:e.props.textBaseline,verticalAlign:e.props.verticalAlign,overflowSuffix:e.props.overflowSuffix},e.renderInfo=e.lightning2TextRenderer.calculateRenderInfo(),e.textH=e.renderInfo.lineHeight*e.renderInfo.lines.length,e.textW=e.renderInfo.width,e.renderWindow=void 0}const{x:s,y:i,width:n,height:o,scrollY:a,contain:c}=e.props,{visibleWindow:u}=e;let{renderWindow:h,canvasPages:d}=e;if(!u.valid){const v=ut(s,i,c!=="none"?s+n:1/0,c==="both"?i+o:1/0,ca);ra(this.rendererBounds,v,u),u.valid=!0}const x=u.y2-u.y1,g=Math.ceil(x/e.renderInfo.lineHeight);if(x===0){d=void 0,h=void 0,this.setStatus(e,"loaded");return}else if(h&&d){const v=s+h.x1,T=i-a+h.y1,O=s+h.x2,R=i-a+h.y2;if(v<=u.x1&&O>=u.x2&&T<=u.y1&&R>=u.y2){this.setStatus(e,"loaded");return}R<u.y2?(h.y1+=g*e.renderInfo.lineHeight,h.y2+=g*e.renderInfo.lineHeight,d.push(d.shift()),d[2].lineNumStart=d[1].lineNumStart+g,d[2].lineNumEnd=d[2].lineNumStart+g,d[2].valid=!1):T>u.y1&&(h.y1-=g*e.renderInfo.lineHeight,h.y2-=g*e.renderInfo.lineHeight,d.unshift(d.pop()),d[0].lineNumStart=d[1].lineNumStart-g,d[0].lineNumEnd=d[0].lineNumStart+g,d[0].valid=!1)}else{const v=e.renderInfo.lineHeight*g,T=Math.ceil(a/v),O=T*g,R=O-g,E=O+g;d=[{texture:d==null?void 0:d[0].texture,lineNumStart:R,lineNumEnd:R+g,valid:!1},{texture:d==null?void 0:d[1].texture,lineNumStart:O,lineNumEnd:O+g,valid:!1},{texture:d==null?void 0:d[2].texture,lineNumStart:E,lineNumEnd:E+g,valid:!1}],e.canvasPages=d;const F=T*v;h={x1:0,y1:F-v,x2:n,y2:F+v*2}}e.renderWindow=h,performance.now();for(const v of d)if(!v.valid){if(v.lineNumStart<0){(_=v.texture)==null||_.setRenderableOwner(e,!1),v.texture=this.stage.txManager.loadTexture("ImageTexture",{src:""}),v.texture.setRenderableOwner(e,e.isRenderable),v.valid=!0;continue}e.lightning2TextRenderer.draw(e.renderInfo,{lines:e.renderInfo.lines.slice(v.lineNumStart,v.lineNumEnd),lineWidths:e.renderInfo.lineWidths.slice(v.lineNumStart,v.lineNumEnd)}),this.canvas.width===0||this.canvas.height===0||((m=v.texture)==null||m.setRenderableOwner(e,!1),v.texture=this.stage.txManager.loadTexture("ImageTexture",{src:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)},{preload:!0}),v.texture.setRenderableOwner(e,e.isRenderable)),v.valid=!0}this.setStatus(e,"loaded")}renderQuads(e,s,i,n){var D,k,Y,X,ee,J,se,G,W,V,K,ie;const{stage:o}=this,{canvasPages:a,textW:c=0,textH:u=0,renderWindow:h}=e;if(!a||!h)return;const{x:d,y:x,scrollY:g,contain:_,width:m,height:v}=e.props,T={x:d,y:x,width:_!=="none"?m:c,height:_==="both"?v:u};Qr({x:0,y:0,width:o.options.appWidth,height:o.options.appHeight},T),P(a,"canvasPages is not defined"),P(h,"renderWindow is not defined");const R=(h.y2-h.y1)/3,{zIndex:E,color:F}=e.props,B=n*sa(F),w=Zt(4294967295,B);a[0].valid&&this.stage.renderer.addQuad({alpha:B,clippingRect:i,colorBl:w,colorBr:w,colorTl:w,colorTr:w,width:((k=(D=a[0].texture)==null?void 0:D.dimensions)==null?void 0:k.width)||0,height:((X=(Y=a[0].texture)==null?void 0:Y.dimensions)==null?void 0:X.height)||0,texture:a[0].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:E,tx:s.tx,ty:s.ty-g+h.y1,ta:s.ta,tb:s.tb,tc:s.tc,td:s.td}),a[1].valid&&this.stage.renderer.addQuad({alpha:B,clippingRect:i,colorBl:w,colorBr:w,colorTl:w,colorTr:w,width:((J=(ee=a[1].texture)==null?void 0:ee.dimensions)==null?void 0:J.width)||0,height:((G=(se=a[1].texture)==null?void 0:se.dimensions)==null?void 0:G.height)||0,texture:a[1].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:E,tx:s.tx,ty:s.ty-g+h.y1+R,ta:s.ta,tb:s.tb,tc:s.tc,td:s.td}),a[2].valid&&this.stage.renderer.addQuad({alpha:B,clippingRect:i,colorBl:w,colorBr:w,colorTl:w,colorTr:w,width:((V=(W=a[2].texture)==null?void 0:W.dimensions)==null?void 0:V.width)||0,height:((ie=(K=a[2].texture)==null?void 0:K.dimensions)==null?void 0:ie.height)||0,texture:a[2].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:E,tx:s.tx,ty:s.ty-g+h.y1+R+R,ta:s.ta,tb:s.tb,tc:s.tc,td:s.td})}setIsRenderable(e,s){var i;super.setIsRenderable(e,s),(i=e.canvasPages)==null||i.forEach(n=>{var o;(o=n.texture)==null||o.setRenderableOwner(e,s)})}destroyState(e){var s;(s=e.canvasPages)==null||s.forEach(i=>{var n;(n=i.texture)==null||n.setRenderableOwner(e,!1)})}invalidateVisibleWindowCache(e){e.visibleWindow.valid=!1,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}invalidateLayoutCache(e){e.renderInfo=void 0,e.visibleWindow.valid=!1,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}onFontLoaded(e,s){var i;s!==((i=e.fontInfo)==null?void 0:i.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,this.scheduleUpdateState(e))}onFontLoadError(e,s,i){var n;s!==((n=e.fontInfo)==null?void 0:n.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,console.error(`CanvasTextRenderer: Error loading font '${e.fontInfo.cssString}'`,i),this.scheduleUpdateState(e))}}const hs=class hs extends vs{constructor(e,s){super(e);l(this,"props");this.props=hs.resolveDefaults(s||{})}get color(){return this.props.color}set color(e){this.props.color=e}async getTextureData(){const e=new Uint32Array([this.color]),s=new Uint8ClampedArray(e.buffer);return{data:new ImageData(s,1,1),premultiplyAlpha:!0}}static makeCacheKey(e){return`ColorTexture,${hs.resolveDefaults(e).color}`}static resolveDefaults(e){return{color:e.color||4294967295}}};l(hs,"z$__type__Props");let js=hs;class Sn{constructor(t,e){l(this,"memManager");l(this,"textureSource");this.memManager=t,this.textureSource=e}}class bn{constructor(t){l(this,"options");l(this,"mode");l(this,"stage");l(this,"txManager");l(this,"txMemManager");l(this,"shManager");this.options=t,this.stage=t.stage,this.txManager=t.txManager,this.txMemManager=t.txMemManager,this.shManager=t.shManager}}class ha{}class Rn extends ha{constructor(e,s,i,n,o,a,c,u,h,d){super();l(this,"glw");l(this,"options");l(this,"buffers");l(this,"shader");l(this,"shaderProps");l(this,"alpha");l(this,"clippingRect");l(this,"dimensions");l(this,"bufferIdx");l(this,"zIndex");l(this,"length",0);l(this,"numQuads",0);l(this,"textures",[]);l(this,"maxTextures");this.glw=e,this.options=s,this.buffers=i,this.shader=n,this.shaderProps=o,this.alpha=a,this.clippingRect=c,this.dimensions=u,this.bufferIdx=h,this.zIndex=d,this.maxTextures=n.supportsIndexedTextures?e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS):1}addTexture(e){const{textures:s,maxTextures:i}=this,n=s.findIndex(a=>a===e);if(n!==-1)return n;const o=s.length;return o>=i?4294967295:(this.textures.push(e),o)}draw(){const{glw:e,shader:s,shaderProps:i,options:n}=this,{shManager:o}=n;o.useShader(s),s.bindRenderOp(this,i);const a=this.bufferIdx/24*6*2;if(this.clippingRect.valid){const{x:c,y:u,width:h,height:d}=this.clippingRect,x=n.pixelRatio,g=n.canvas.height,_=Math.round(c*x),m=Math.round(h*x),v=Math.round(d*x),T=Math.round(g-v-u*x);e.setScissorTest(!0),e.scissor(_,T,m,v)}else e.setScissorTest(!1);e.drawElements(e.TRIANGLES,6*this.numQuads,e.UNSIGNED_SHORT,a)}}function ua(r){const t={MAX_RENDERBUFFER_SIZE:0,MAX_TEXTURE_SIZE:0,MAX_VIEWPORT_DIMS:0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:0,MAX_TEXTURE_IMAGE_UNITS:0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:0,MAX_VERTEX_ATTRIBS:0,MAX_VARYING_VECTORS:0,MAX_VERTEX_UNIFORM_VECTORS:0,MAX_FRAGMENT_UNIFORM_VECTORS:0};return Object.keys(t).forEach(s=>{t[s]=r.getParameter(r[s])}),t}function da(r){const t={ANGLE_instanced_arrays:null,WEBGL_compressed_texture_s3tc:null,WEBGL_compressed_texture_astc:null,WEBGL_compressed_texture_etc:null,WEBGL_compressed_texture_etc1:null,WEBGL_compressed_texture_pvrtc:null,WEBKIT_WEBGL_compressed_texture_pvrtc:null,WEBGL_compressed_texture_s3tc_srgb:null,OES_vertex_array_object:null};return Object.keys(t).forEach(s=>{t[s]=r.getExtension(s)}),t}function fa(r,t){const e=~~(t/80),s=new Uint16Array(e*6);for(let n=0,o=0;n<e;n+=6,o+=4)s[n]=o,s[n+1]=o+1,s[n+2]=o+2,s[n+3]=o+2,s[n+4]=o+1,s[n+5]=o+3;const i=r.createBuffer();r.elementArrayBufferData(i,s,r.STATIC_DRAW)}function pa(r){return r!==null&&typeof r=="object"&&r.constructor&&r.constructor.name==="HTMLImageElement"}function Zr(r,t){var e=0,s,i;t=t||{};function n(){var o=s,a=arguments.length,c,u;e:for(;o;){if(o.args.length!==arguments.length){o=o.next;continue}for(u=0;u<a;u++)if(o.args[u]!==arguments[u]){o=o.next;continue e}return o!==s&&(o===i&&(i=o.prev),o.prev.next=o.next,o.next&&(o.next.prev=o.prev),o.next=s,o.prev=null,s.prev=o,s=o),o.val}for(c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return o={args:c,val:r.apply(null,c)},s?(s.prev=o,o.next=s):i=o,e===t.maxSize?(i=i.prev,i.next=null):e++,s=o,o.val}return n.clear=function(){s=null,i=null,e=0},n}const Bi=r=>r&&!(r&r-1),Te=(r,t,e,s)=>{const i=3*r,n=3*(e-r)-i,o=1-i-n,a=3*t,c=3*(s-t)-a,u=1-a-c;return function(h){if(h>=1)return 1;if(h<=0)return 0;let d=.5,x,g,_;for(let T=0;T<20;T++){if(x=d*(d*(d*o+n)+i),_=h-x,_>-1e-8&&_<1e-8)return d*(d*(d*u+c)+a);if(g=d*(d*(3*o)+2*n)+i,g>1e-10&&g<1e-10)break;d+=_/g}let m=0,v=1;for(let T=0;T<20;T++){if(d=.5*(m+v),x=d*(d*(d*o+n)+i),_=h-x,_>-1e-8&&_<1e-8)return d*(d*(d*u+c)+a);_<0?v=d:m=d}}},ga=Zr(r=>{switch(r){case"linear":return function(e){return e};case"ease":return Te(.25,.1,.25,1);case"ease-in":return Te(.42,0,1,1);case"ease-out":return Te(0,0,.58,1);case"ease-in-out":return Te(.42,0,.58,1);case"ease-in-sine":return Te(.12,0,.39,0);case"ease-out-sine":return Te(.12,0,.39,0);case"ease-in-out-sine":return Te(.37,0,.63,1);case"ease-in-cubic":return Te(.32,0,.67,0);case"ease-out-cubic":return Te(.33,1,.68,1);case"ease-in-out-cubic":return Te(.65,0,.35,1);case"ease-in-circ":return Te(.55,0,1,.45);case"ease-out-circ":return Te(0,.55,.45,1);case"ease-in-out-circ":return Te(.85,0,.15,1);case"ease-in-back":return Te(.36,0,.66,-.56);case"ease-out-back":return Te(.34,1.56,.64,1);case"ease-in-out-back":return Te(.68,-.6,.32,1.6);case"step-start":return function(){return 1};case"step-end":return function(e){return e===1?1:0};default:const t="cubic-bezier(";if(r&&r.indexOf(t)===0){const e=r.substr(t.length,r.length-t.length-1).split(",");if(e.length!==4)return console.warn("Unknown timing function: "+r),function(a){return a};const s=parseFloat(e[0]||"0.42"),i=parseFloat(e[1]||"0"),n=parseFloat(e[2]||"1"),o=parseFloat(e[3]||"1");return isNaN(s)||isNaN(i)||isNaN(n)||isNaN(o)?(console.warn(" Unknown timing function: "+r),function(a){return a}):Te(s,i,n,o)}else return console.warn("Unknown timing function: "+r),function(e){return e}}});Math.hypot||(Math.hypot=(...r)=>{let t=0,e=r.length;for(;e--;)t+=r[e]*r[e];return Math.sqrt(t)});const ws=new Uint8Array([0,0,0,0]);class Ir extends Sn{constructor(e,s,i){super(s,i);l(this,"glw");l(this,"_nativeCtxTexture",null);l(this,"_state","freed");l(this,"_w",0);l(this,"_h",0);this.glw=e}get ctxTexture(){return this._state==="freed"&&this.load(),P(this._nativeCtxTexture),this._nativeCtxTexture}get renderable(){return this.textureSource.renderable}get w(){return this._w}get h(){return this._h}load(){this._state==="loading"||this._state==="loaded"||(this._state="loading",this.textureSource.setState("loading"),this._nativeCtxTexture=this.createNativeCtxTexture(),this.onLoadRequest().then(({width:e,height:s})=>{this._state!=="freed"&&(this._state="loaded",this._w=e,this._h=s,this.textureSource.setState("loaded",{width:e,height:s}))}).catch(e=>{this._state="failed",this.textureSource.setState("failed",e),console.error(e)}))}async onLoadRequest(){var a;const{glw:e,memManager:s}=this;e.activeTexture(0),e.bindTexture(this._nativeCtxTexture),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,ws),s.setTextureMemUse(this,ws.byteLength);const i=await((a=this.textureSource)==null?void 0:a.getTextureData());if(!this._nativeCtxTexture)return P(this._state==="freed"),{width:0,height:0};let n=0,o=0;if(P(this._nativeCtxTexture),e.activeTexture(0),i.data instanceof ImageBitmap||i.data instanceof ImageData||pa(i.data)){const c=i.data;n=c.width,o=c.height,e.bindTexture(this._nativeCtxTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!i.premultiplyAlpha),e.texImage2D(0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,c),s.setTextureMemUse(this,n*o*4),(e.isWebGl2()||Bi(n)&&Bi(o))&&e.generateMipmap()}else if(i.data===null)n=0,o=0,e.bindTexture(this._nativeCtxTexture),e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,ws),s.setTextureMemUse(this,ws.byteLength);else if("mipmaps"in i.data&&i.data.mipmaps){const{mipmaps:c,width:u=0,height:h=0,type:d,glInternalFormat:x}=i.data,g=d==="ktx"?new DataView(c[0]??new ArrayBuffer(0)):c[0];e.bindTexture(this._nativeCtxTexture),e.compressedTexImage2D(0,x,u,h,0,g),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),s.setTextureMemUse(this,g.byteLength)}else console.error("WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",i);return{width:n,height:o}}free(){if(this._state==="freed"||(this._state="freed",this.textureSource.setState("freed"),this._w=0,this._h=0,!this._nativeCtxTexture))return;const{glw:e,memManager:s}=this;e.deleteTexture(this._nativeCtxTexture),s.setTextureMemUse(this,0),this._nativeCtxTexture=null}createNativeCtxTexture(){const{glw:e}=this,s=e.createTexture();if(!s)throw new Error("Could not create WebGL Texture");return s}}const tr=class tr extends vs{constructor(e,s){super(e);l(this,"props");l(this,"parentTexture");l(this,"onParentTxLoaded",()=>{this.setState("loaded",{width:this.props.width,height:this.props.height})});l(this,"onParentTxFailed",(e,s)=>{this.setState("failed",s)});this.parentTexture=this.txManager.loadTexture(s.texture.txType,s.texture.props,s.texture.options),this.props=tr.resolveDefaults(s||{}),queueMicrotask(()=>{const i=this.parentTexture;i.state==="loaded"?this.onParentTxLoaded(i,i.dimensions):i.state==="failed"&&this.onParentTxFailed(i,i.error),i.on("loaded",this.onParentTxLoaded),i.on("failed",this.onParentTxFailed)})}async getTextureData(){return{data:this.props}}static makeCacheKey(e){return!1}static resolveDefaults(e){return{texture:e.texture,x:e.x||0,y:e.y||0,width:e.width||0,height:e.height||0}}};l(tr,"z$__type__Props");let Gt=tr;class xa extends Ir{constructor(t,e,s){super(t,e,s)}async onLoadRequest(){var e,s;const t=await this.textureSource.getTextureData();return{width:((e=t.data)==null?void 0:e.width)||0,height:((s=t.data)==null?void 0:s.height)||0}}}class En extends rt{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}}l(En,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRESICISON_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;


      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRESICISON_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
          vec4 color = texture2D(u_texture, v_textureCoordinate);
          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);
      }
    `});class Cn extends rt{constructor(e){super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]});l(this,"supportsIndexedTextures",!0)}bindTextures(e){const{renderer:s,glw:i}=this;if(e.length>s.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error(`DefaultShaderBatched: Cannot bind more than ${s.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS} textures`);e.forEach((o,a)=>{i.activeTexture(a),i.bindTexture(o.ctxTexture)});const n=Array.from(Array(e.length).keys());this.setUniform("u_textures[0]",n)}}l(Cn,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRESICISON_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_textureCoordinate;
      attribute vec2 a_position;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      void main(){
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;
        v_textureIndex = a_textureIndex;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:e=>`
      #define txUnits ${e}
      # ifdef GL_FRAGMENT_PRESICISON_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_image;
      uniform sampler2D u_textures[txUnits];

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      vec4 sampleFromTexture(sampler2D textures[${e}], int idx, vec2 uv) {
        ${Array.from(Array(e).keys()).map(s=>`
          ${s!==0?"else ":""}if (idx == ${s}) {
            return texture2D(textures[${s}], uv);
          }
        `).join("")}
        return texture2D(textures[0], uv);
      }

      void main(){
        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);
      }
    `});const pr=new Map,ma=(r,t)=>{const e=JSON.stringify(r);if(pr.has(e))return pr.get(e);const s=(r??[]).map(i=>({type:i.type,props:t[i.type].resolveDefaults(i.props||{})}));return pr.set(e,s),s},tt=class tt extends rt{constructor(e,s,i){const n=tt.createShader(s,i);super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...n.uniforms],shaderSources:{vertex:n.vertex,fragment:n.fragment}});l(this,"effects",[]);this.effects=n.effects,this.calculateProps=Zr(this.calculateProps.bind(this))}bindTextures(e){const{glw:s}=this;s.activeTexture(0),s.bindTexture(e[0].ctxTexture)}calculateProps(e){const s=this.renderer.shManager.getRegisteredEffects(),i=[];return e==null||e.forEach((n,o)=>{const a=this.effects[o],c=s[a.name],u=n.props??{},h=a.uniformInfo;Object.keys(u).forEach(d=>{const x=c.uniforms[d],g=h[d];let _=x.validator?x.validator(u[d],u):u[d];Array.isArray(_)&&(_=new Float32Array(_)),i.push({name:g.name,value:_})})}),i}bindProps(e){this.calculateProps(e.effects).forEach(i=>{this.setUniform(i.name,i.value)})}canBatchShaderProps(e,s){if(e.$dimensions.width!==s.$dimensions.width||e.$dimensions.height!==s.$dimensions.height||e.effects.length!==s.effects.length)return!1;const i=e.effects.length;let n=0;for(;n<i;n++){const o=e.effects[n],a=s.effects[n];if(o.type!==a.type)return!1;for(const c in o.props)if(a.props&&!a.props[c]||o.props[c]!==a.props[c])return!1}return!0}static createShader(e,s){const i={},n={};let o="";const a=[],c=[],u=e.effects.map(_=>{const m=s[_.type],v=m.getEffectKey(_.props||{});i[v]=i[v]?++i[v]:1;const T=i[v];T===1&&c.push({key:v,type:_.type,props:_.props});const O=new m({ref:`${v}${T===1?"":T}`,target:v,props:_.props});return o+=O.declaredUniforms,a.push(...Object.values(O.uniformInfo)),O});let h="";c==null||c.forEach(_=>{const m=s[_.type],v=m.resolveDefaults(_.props??{}),T=[];for(const w in m.methods){let D=w;const k=m.methods[w];n[w]&&n[w]!==k&&(D=tt.resolveMethodDuplicate(w,k,n)),n[D]=k.replace("function",D),T.push({m:w,cm:D})}let O=m.onShaderMask instanceof Function?m.onShaderMask(v):m.onShaderMask,R=m.onColorize instanceof Function?m.onColorize(v):m.onColorize,E=m.onEffectMask instanceof Function?m.onEffectMask(v):m.onEffectMask;T.forEach(w=>{const{m:D,cm:k}=w,Y=new RegExp(`\\$${D}`,"g");O&&(O=O.replace(Y,k)),R&&(R=R.replace(Y,k)),E&&(E=E.replace(Y,k))});const F=m.getMethodParameters(m.uniforms,v),B=F.length>0?`, ${F}`:"";O&&(h+=`
        float fx_${_.key}_onShaderMask(float shaderMask ${B}) {
          ${O}
        }
        `),R&&(h+=`
          vec4 fx_${_.key}_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor${B}) {
            ${R}
          }
        `),E&&(h+=`
          vec4 fx_${_.key}_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor${B}) {
            ${E}
          }
        `)});let d="";for(const _ in n)d+=n[_];let x="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",g=`

    `;for(let _=0;_<u.length;_++){const m=u[_],v=m.passParameters.length>0?`, ${m.passParameters}`:"",T=s[m.name];T.onShaderMask&&(g+=`
        shaderMask = fx_${m.target}_onShaderMask(shaderMask ${v});
        `),T.onColorize&&(g+=`
        maskColor = fx_${m.target}_onColorize(shaderMask, maskColor, shaderColor${v});
        `),T.onEffectMask&&(x=`fx_${m.target}_onEffectMask(shaderMask, maskColor, shaderColor${v})`);const O=u[_+1];(O===void 0||s[O.name].onEffectMask)&&(g+=`
          shaderColor = ${x};
        `)}return{effects:u,uniforms:a,fragment:tt.fragment(o,d,h,g),vertex:tt.vertex()}}static resolveMethodDuplicate(e,s,i,n=0){const o=e+(n>0?n:"");return i[o]&&i[o]!==s?this.resolveMethodDuplicate(e,s,i,++n):o}static resolveDefaults(e,s){return{effects:ma(e.effects,s),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(e,s){var n;let i="";return(n=e.effects)==null||n.forEach(o=>{const c=s[o.type].getEffectKey(o.props||{});i+=`,${c}`}),`DynamicShader${i}`}};l(tt,"z$__type__Props"),l(tt,"vertex",()=>`
    # ifdef GL_FRAGMENT_PRESICISON_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    attribute vec2 a_textureCoordinate;
    attribute vec2 a_position;
    attribute vec4 a_color;
    attribute float a_textureIndex;

    uniform vec2 u_resolution;
    uniform float u_pixelRatio;

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;
    varying float v_textureIndex;

    void main(){
      vec2 normalized = a_position * u_pixelRatio / u_resolution;
      vec2 zero_two = normalized * 2.0;
      vec2 clip_space = zero_two - 1.0;

      // pass to fragment
      v_color = a_color;
      v_textureCoordinate = a_textureCoordinate;
      v_textureIndex = a_textureIndex;

      // flip y
      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
    }
  `),l(tt,"fragment",(e,s,i,n)=>`
    # ifdef GL_FRAGMENT_PRESICISON_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    #define PI 3.14159265359

    uniform vec2 u_resolution;
    uniform vec2 u_dimensions;
    uniform float u_alpha;
    uniform float u_radius;
    uniform sampler2D u_texture;
    uniform float u_pixelRatio;

    ${e}

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;

    ${s}

    ${i}

    void main() {
      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;
      vec2 d = abs(p) - (u_dimensions) * 0.5;
      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));

      vec4 shaderColor = vec4(0.0);
      float shaderMask = lng_DefaultMask;

      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;

      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));

      ${n}

      gl_FragColor = shaderColor * u_alpha;
    }
  `);let zt=tt;class Ar extends rt{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(t){return{radius:t.radius||10,$dimensions:{width:0,height:0}}}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){this.setUniform("u_radius",t.radius)}canBatchShaderProps(t,e){return t.radius===e.radius&&t.$dimensions.width===e.$dimensions.width&&t.$dimensions.height===e.$dimensions.height}}l(Ar,"z$__type__Props"),l(Ar,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRESICISON_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRESICISON_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform vec2 u_dimensions;
      uniform float u_radius;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      float boxDist(vec2 p, vec2 size, float radius){
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }

      float fillMask(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }

      void main() {
        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;
        vec2 halfDimensions = u_dimensions * 0.5;

        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);
        gl_FragColor = mix(vec4(0.0), color, fillMask(d));
      }
    `});const _a=new Float32Array([1,0,0,0,1,0,0,0,1]),sr=class sr extends rt{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=sr.resolveDefaults(t);for(const s in e)if(s==="transform")this.setUniform("u_transform",!1,e[s]);else if(s==="scrollY")this.setUniform("u_scrollY",e[s]);else if(s==="color"){const i=He(e.color);this.setUniform("u_color",i)}else s==="size"?this.setUniform("u_size",e[s]):s==="distanceRange"?this.setUniform("u_distanceRange",e[s]):s==="debug"&&this.setUniform("u_debug",e[s]?1:0)}static resolveDefaults(t={}){return{transform:t.transform??_a,scrollY:t.scrollY??0,color:t.color??4294967295,size:t.size??16,distanceRange:t.distanceRange??1,debug:t.debug??!1}}};l(sr,"shaderSources",{vertex:`
      // an attribute is an input (in) to a vertex shader.
      // It will receive data from a buffer
      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;

      uniform vec2 u_resolution;
      uniform mat3 u_transform;
      uniform float u_scrollY;
      uniform float u_pixelRatio;
      uniform float u_size;

      varying vec2 v_texcoord;

      void main() {
        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);
        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;
        gl_Position = vec4((transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1), 0, 1);
        v_texcoord = a_textureCoordinate;
      }
    `,fragment:`
      precision highp float;

      uniform vec4 u_color;
      uniform sampler2D u_texture;
      uniform float u_distanceRange;
      uniform float u_pixelRatio;
      uniform int u_debug;

      varying vec2 v_texcoord;

      float median(float r, float g, float b) {
          return max(min(r, g), min(max(r, g), b));
      }

      void main() {
          vec3 sample = texture2D(u_texture, v_texcoord).rgb;
          if (u_debug == 1) {
            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);
            return;
          }
          float scaledDistRange = u_distanceRange * u_pixelRatio;
          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);
          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;

          // Build the final color.
          // IMPORTANT: We must premultiply the color by the alpha value before returning it.
          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);
      }
    `});let Mr=sr;class Lt extends ve{constructor(){super(...arguments);l(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(e){return{radius:e.radius??10}}}l(Lt,"z$__type__Props"),l(Lt,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",validator:e=>{let s=e;return Array.isArray(s)?s.length===2?s=[s[0],s[1],s[0],s[1]]:s.length===3?s=[s[0],s[1],s[2],s[0]]:s.length!==4&&(s=[s[0],s[0],s[0],s[0]]):typeof s=="number"&&(s=[s,s,s,s]),s}}}),l(Lt,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),l(Lt,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);
  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);
  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);
  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);
  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);
  `),l(Lt,"onEffectMask",`
  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));
  `);class Jt extends ve{constructor(){super(...arguments);l(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}l(Jt,"z$__type__Props"),l(Jt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>He(e),method:"uniform4fv",type:"vec4"}}),l(Jt,"onEffectMask",`
  float mask = clamp(shaderMask + width, 0.0, 1.0) - clamp(shaderMask, 0.0, 1.0);
  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);
  `),l(Jt,"onColorize",`
    return color;
  `);const ht=class ht extends ve{constructor(){super(...arguments);l(this,"name","linearGradient")}static getEffectKey(e){return`linearGradient${e.colors.length}`}static resolveDefaults(e){const s=e.colors??[4278190080,4294967295];let i=e.stops||[];if(i.length===0||i.length!==s.length){const n=s.length;let o=0;const a=i;for(;o<n;o++)i[o]?(a[o]=i[o],i[o-1]===void 0&&a[o-2]!==void 0&&(a[o-1]=a[o-2]+(i[o]-a[o-2])/2)):a[o]=o*(1/(s.length-1));i=a}return{colors:s,stops:i,angle:e.angle??0}}};l(ht,"z$__type__Props"),l(ht,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:e=>e.map(i=>He(i)).reduce((i,n)=>i.concat(n),[]),size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),l(ht,"methods",{fromLinear:`
      vec4 function(vec4 linearRGB) {
        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);
        vec4 lower = linearRGB * vec4(12.92);
        return mix(higher, lower, 1.0);
      }
    `,toLinear:`
      vec4 function(vec4 sRGB) {
        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));
        vec4 lower = sRGB/vec4(12.92);
        return mix(higher, lower, 1.0);
      }
    `,calcPoint:`
      vec2 function(float d, float angle) {
        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);
      }
    `}),l(ht,"ColorLoop",e=>{let s="";for(let i=2;i<e;i++)s+=`colorOut = mix(colorOut, colors[${i}], clamp((dist - stops[${i-1}]) / (stops[${i}] - stops[${i-1}]), 0.0, 1.0));`;return s}),l(ht,"onColorize",e=>{const s=e.colors.length||1;return`
      float a = angle - (PI / 180.0 * 90.0);
      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));
      vec2 f = $calcPoint(lineDist * 0.5, a);
      vec2 t = $calcPoint(lineDist * 0.5, a + PI);
      vec2 gradVec = t - f;
      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);

      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);
      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));
      ${ht.ColorLoop(s)}
      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
    `});let Lr=ht;class Nr extends ve{constructor(){super(...arguments);l(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(e){return{amount:e.amount??1}}}l(Nr,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),l(Nr,"onColorize",`
    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;
    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);
  `);class Nt extends ve{constructor(){super(...arguments);l(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}l(Nt,"z$__type__Props"),l(Nt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>He(e),method:"uniform4fv",type:"vec4"}}),l(Nt,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),l(Nt,"onEffectMask",`
  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),l(Nt,"onColorize",`
    return color;
  `);class Pt extends ve{constructor(){super(...arguments);l(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}l(Pt,"z$__type__Props"),l(Pt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>He(e),method:"uniform4fv",type:"vec4"}}),l(Pt,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),l(Pt,"onEffectMask",`
  vec2 pos = vec2(0.0, width * 0.5);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),l(Pt,"onColorize",`
    return color;
  `);class Ot extends ve{constructor(){super(...arguments);l(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}l(Ot,"z$__type__Props"),l(Ot,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>He(e),method:"uniform4fv",type:"vec4"}}),l(Ot,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),l(Ot,"onEffectMask",`
  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),l(Ot,"onColorize",`
    return color;
  `);class Ft extends ve{constructor(){super(...arguments);l(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}l(Ft,"z$__type__Props"),l(Ft,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>He(e),method:"uniform4fv",type:"vec4"}}),l(Ft,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),l(Ft,"onEffectMask",`
  vec2 pos = vec2(width * 0.5, 0.0);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),l(Ft,"onColorize",`
    return color;
  `);class es extends ve{constructor(){super(...arguments);l(this,"name","glitch")}static getEffectKey(e){return"glitch"}static resolveDefaults(e){return{amplitude:e.amplitude??.2,narrowness:e.narrowness??4,blockiness:e.blockiness??2,minimizer:e.minimizer??8,time:e.time??Date.now()}}}l(es,"z$__type__Props"),l(es,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",validator:e=>(Date.now()-e)%1e3,type:"float"}}),l(es,"methods",{rand:`
      float function(vec2 p, float time) {
        float t = floor(time * 20.) / 10.;
        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);
      }
    `,noise:`
      float function(vec2 uv, float blockiness, float time) {
        vec2 lv = fract(uv);
        vec2 id = floor(uv);

        float n1 = rand(id, time);
        float n2 = rand(id+vec2(1,0), time);
        float n3 = rand(id+vec2(0,1), time);
        float n4 = rand(id+vec2(1,1), time);
        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);
        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);
      }
    `,fbm:`
      float function(vec2 uv, int count, float blockiness, float complexity, float time) {
        float val = 0.0;
        float amp = 0.5;
        const int MAX_ITERATIONS = 10;

        for(int i = 0; i < MAX_ITERATIONS; i++) {
          if(i >= count) {break;}
          val += amp * noise(uv, blockiness, time);
          amp *= 0.5;
          uv *= complexity;
        }
        return val;
      }
    `}),l(es,"onColorize",`
    vec2 uv = v_textureCoordinate.xy;
    float aspect = u_dimensions.x / u_dimensions.y;
    vec2 a = vec2(uv.x * aspect , uv.y);
    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));

    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);
    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);
    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);
    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);

    vec3 f = vec3(colR, colG, colB);
    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);
  `);class $s extends ve{constructor(){super(...arguments);l(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(e){return{fade:e.fade??10}}}l($s,"z$__type__Props"),l($s,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:e=>{let s=e;return Array.isArray(s)?s.length===2?s=[s[0],s[1],s[0],s[1]]:s.length===3?s=[s[0],s[1],s[2],s[0]]:s.length!==4&&(s=[s[0],s[0],s[0],s[0]]):typeof s=="number"&&(s=[s,s,s,s]),s}}}),l($s,"onColorize",`
  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;
  vec2 pos1;
  vec2 pos2;
  vec2 d;
  float c;
  vec4 result = maskColor;


  if(fade[0] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x, point.y + fade[0]);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[1] > 0.0) {
    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);
    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[2] > 0.0) {
    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);
    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[3] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x + fade[3], point.y);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  return result;
  `);const St=class St extends ve{constructor(){super(...arguments);l(this,"name","radialGradient")}static getEffectKey(e){return`radialGradient${e.colors.length}`}static resolveDefaults(e){const s=e.colors??[4278190080,4294967295];let i=e.stops||[];if(i.length===0||i.length!==s.length){const n=s.length;let o=0;const a=i;for(;o<n;o++)i[o]?(a[o]=i[o],i[o-1]===void 0&&a[o-2]!==void 0&&(a[o-1]=a[o-2]+(i[o]-a[o-2])/2)):a[o]=o*(1/(s.length-1));i=a}return{colors:s,stops:i,width:e.width??0,height:e.height??e.width??0,pivot:e.pivot??[.5,.5]}}};l(St,"z$__type__Props"),l(St,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:e=>e.map(i=>He(i)).reduce((i,n)=>i.concat(n),[]),size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),l(St,"ColorLoop",e=>{let s="";for(let i=2;i<e;i++)s+=`colorOut = mix(colorOut, colors[${i}], clamp((dist - stops[${i-1}]) / (stops[${i}] - stops[${i-1}]), 0.0, 1.0));`;return s}),l(St,"onColorize",e=>{const s=e.colors.length||1;return`
      vec2 point = v_textureCoordinate.xy * u_dimensions;
      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);

      float dist = length((point - projection) / vec2(width, height));

      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);
      vec4 colorOut = mix(colors[0], colors[1], stopCalc);
      ${St.ColorLoop(s)}
      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
    `});let Pr=St;class Bt extends ve{constructor(){super(...arguments);l(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(e){return{width:e.width??10,progress:e.progress??.5,offset:e.offset??0,range:e.range??Math.PI*2,rounded:e.rounded??!1,radius:e.radius??1,color:e.color??4294967295}}}l(Bt,"z$__type__Props"),l(Bt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:e=>e?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>He(e),method:"uniform4fv",type:"vec4"}}),l(Bt,"methods",{rotateUV:`
    vec2 function(vec2 uv, float d) {
      float s = sin(d);
      float c = cos(d);
      mat2 rotMatrix = mat2(c, -s, s, c);
      return uv * rotMatrix;
    }
    `,drawDot:`
    float function(vec2 uv, vec2 p, float r) {
      uv += p;
      float circle = length(uv) - r;
      return clamp(-circle, 0.0, 1.0);
    }
    `}),l(Bt,"onEffectMask",`
    float outerRadius = radius * u_dimensions.y * 0.5;

    float endAngle = range * progress - 0.0005;

    vec2 uv = v_textureCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;

    uv = $rotateUV(uv, -(offset));
    float linewidth = width * u_pixelRatio;
    float circle = length(uv) - (outerRadius - linewidth) ;
    circle = abs(circle) - linewidth;
    circle = clamp(-circle, 0.0, 1.0);

    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);
    float p = endAngle / (PI * 2.);

    circle *= step(fract(angle), fract(p));

    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));
    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));

    return mix(shaderColor, maskColor, circle);
  `),l(Bt,"onColorize",`
    return color;
  `);class Dt extends ve{constructor(){super(...arguments);l(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(e){return{x:e.x||0,y:e.y||0,width:e.width||50,height:e.height||50,radius:e.radius??0}}}l(Dt,"z$__type__Props"),l(Dt,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",validator:e=>{let s=e;return Array.isArray(s)?s.length===2?s=[s[0],s[1],s[0],s[1]]:s.length===3?s=[s[0],s[1],s[2],s[0]]:s.length!==4&&(s=[s[0],s[0],s[0],s[0]]):typeof s=="number"&&(s=[s,s,s,s]),s}}}),l(Dt,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),l(Dt,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  vec2 size = vec2(width, height) * 0.5;
  vec2 basePos = v_textureCoordinate.xy * u_dimensions.xy - vec2(x, y);
  vec2 pos = basePos - size;
  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);
  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);
  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);
  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);
  return $boxDist(pos, size, r);
  `),l(Dt,"onEffectMask",`
  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));
  `);const In="RoundedRectangle";class An extends yn{constructor(e){super();l(this,"shType");this.shType=e,e!==In&&console.warn("Unsupported shader:",e)}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class ya{constructor(){l(this,"shCache",new Map);l(this,"shConstructors",{});l(this,"attachedShader",null);l(this,"effectConstructors",{});l(this,"renderer");this.registerShaderType("DefaultShader",En),this.registerShaderType("DefaultShaderBatched",Cn),this.registerShaderType("RoundedRectangle",Ar),this.registerShaderType("DynamicShader",zt),this.registerShaderType("SdfShader",Mr),this.registerEffectType("border",Jt),this.registerEffectType("borderBottom",Ot),this.registerEffectType("borderLeft",Ft),this.registerEffectType("borderRight",Nt),this.registerEffectType("borderTop",Pt),this.registerEffectType("fadeOut",$s),this.registerEffectType("linearGradient",Lr),this.registerEffectType("radialGradient",Pr),this.registerEffectType("grayscale",Nr),this.registerEffectType("glitch",es),this.registerEffectType("radius",Lt),this.registerEffectType("radialProgress",Bt),this.registerEffectType("holePunch",Dt)}registerShaderType(t,e){this.shConstructors[t]=e}registerEffectType(t,e){this.effectConstructors[t]=e}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(t,e){if(!this.renderer)throw new Error("Renderer is not been defined");const s=this.shConstructors[t];if(!s)throw new Error(`Shader type "${t}" is not registered`);if(this.renderer.mode==="canvas"&&s.prototype instanceof rt)return{shader:new An(t),props:e};if(t==="DynamicShader")return this.loadDynamicShader(e);const i=s.resolveDefaults(e),n=s.makeCacheKey(i)||s.name;if(n&&this.shCache.has(n))return{shader:this.shCache.get(n),props:i};const o=new s(this.renderer,e);return n&&this.shCache.set(n,o),{shader:o,props:i}}loadDynamicShader(t){if(!this.renderer)throw new Error("Renderer is not been defined");const e=zt.resolveDefaults(t,this.effectConstructors),s=zt.makeCacheKey(e,this.effectConstructors);if(s&&this.shCache.has(s))return{shader:this.shCache.get(s),props:e};const i=new zt(this.renderer,t,this.effectConstructors);return s&&this.shCache.set(s,i),{shader:i,props:e}}useShader(t){this.attachedShader!==t&&(this.attachedShader&&this.attachedShader.detach(),t.attach(),this.attachedShader=t)}}class Mn{constructor(t){l(this,"config");this.config=t}getBuffer(t){var e;return(e=this.config.find(s=>s.attributes[t]))==null?void 0:e.buffer}getAttributeInfo(t){var e;return(e=this.config.find(s=>s.attributes[t]))==null?void 0:e.attributes[t]}}class va{constructor(t){l(this,"gl");l(this,"activeTextureUnit",0);l(this,"texture2dUnits");l(this,"texture2dParams",new WeakMap);l(this,"scissorEnabled");l(this,"scissorX");l(this,"scissorY");l(this,"scissorWidth");l(this,"scissorHeight");l(this,"blendEnabled");l(this,"blendSrcRgb");l(this,"blendDstRgb");l(this,"blendSrcAlpha");l(this,"blendDstAlpha");l(this,"boundArrayBuffer");l(this,"boundElementArrayBuffer");l(this,"curProgram");l(this,"programUniforms",new WeakMap);l(this,"canvas");l(this,"MAX_RENDERBUFFER_SIZE");l(this,"MAX_TEXTURE_SIZE");l(this,"MAX_VIEWPORT_DIMS");l(this,"MAX_VERTEX_TEXTURE_IMAGE_UNITS");l(this,"MAX_TEXTURE_IMAGE_UNITS");l(this,"MAX_COMBINED_TEXTURE_IMAGE_UNITS");l(this,"MAX_VERTEX_ATTRIBS");l(this,"MAX_VARYING_VECTORS");l(this,"MAX_VERTEX_UNIFORM_VECTORS");l(this,"MAX_FRAGMENT_UNIFORM_VECTORS");l(this,"TEXTURE_MAG_FILTER");l(this,"TEXTURE_MIN_FILTER");l(this,"TEXTURE_WRAP_S");l(this,"TEXTURE_WRAP_T");l(this,"LINEAR");l(this,"CLAMP_TO_EDGE");l(this,"RGBA");l(this,"UNSIGNED_BYTE");l(this,"UNPACK_PREMULTIPLY_ALPHA_WEBGL");l(this,"FLOAT");l(this,"TRIANGLES");l(this,"UNSIGNED_SHORT");l(this,"ONE");l(this,"ONE_MINUS_SRC_ALPHA");l(this,"VERTEX_SHADER");l(this,"FRAGMENT_SHADER");l(this,"STATIC_DRAW");l(this,"COMPILE_STATUS");l(this,"LINK_STATUS");l(this,"DYNAMIC_DRAW");this.gl=t,this.activeTextureUnit=t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0;const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.texture2dUnits=new Array(e).fill(void 0).map((i,n)=>(this.activeTexture(n),t.getParameter(t.TEXTURE_BINDING_2D))),this.activeTexture(this.activeTextureUnit),this.scissorEnabled=t.isEnabled(t.SCISSOR_TEST);const s=t.getParameter(t.SCISSOR_BOX);this.scissorX=s[0],this.scissorY=s[1],this.scissorWidth=s[2],this.scissorHeight=s[3],this.blendEnabled=t.isEnabled(t.BLEND),this.blendSrcRgb=t.getParameter(t.BLEND_SRC_RGB),this.blendDstRgb=t.getParameter(t.BLEND_DST_RGB),this.blendSrcAlpha=t.getParameter(t.BLEND_SRC_ALPHA),this.blendDstAlpha=t.getParameter(t.BLEND_DST_ALPHA),this.boundArrayBuffer=t.getParameter(t.ARRAY_BUFFER_BINDING),this.boundElementArrayBuffer=t.getParameter(t.ELEMENT_ARRAY_BUFFER_BINDING),this.curProgram=t.getParameter(t.CURRENT_PROGRAM),this.canvas=t.canvas,this.MAX_RENDERBUFFER_SIZE=t.MAX_RENDERBUFFER_SIZE,this.MAX_TEXTURE_SIZE=t.MAX_TEXTURE_SIZE,this.MAX_VIEWPORT_DIMS=t.MAX_VIEWPORT_DIMS,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.MAX_TEXTURE_IMAGE_UNITS=t.MAX_TEXTURE_IMAGE_UNITS,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS,this.MAX_VERTEX_ATTRIBS=t.MAX_VERTEX_ATTRIBS,this.MAX_VARYING_VECTORS=t.MAX_VARYING_VECTORS,this.MAX_VERTEX_UNIFORM_VECTORS=t.MAX_VERTEX_UNIFORM_VECTORS,this.MAX_FRAGMENT_UNIFORM_VECTORS=t.MAX_FRAGMENT_UNIFORM_VECTORS,this.TEXTURE_MAG_FILTER=t.TEXTURE_MAG_FILTER,this.TEXTURE_MIN_FILTER=t.TEXTURE_MIN_FILTER,this.TEXTURE_WRAP_S=t.TEXTURE_WRAP_S,this.TEXTURE_WRAP_T=t.TEXTURE_WRAP_T,this.LINEAR=t.LINEAR,this.CLAMP_TO_EDGE=t.CLAMP_TO_EDGE,this.RGBA=t.RGBA,this.UNSIGNED_BYTE=t.UNSIGNED_BYTE,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.FLOAT=t.FLOAT,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.ONE=t.ONE,this.ONE_MINUS_SRC_ALPHA=t.ONE_MINUS_SRC_ALPHA,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.VERTEX_SHADER=t.VERTEX_SHADER,this.FRAGMENT_SHADER=t.FRAGMENT_SHADER,this.STATIC_DRAW=t.STATIC_DRAW,this.COMPILE_STATUS=t.COMPILE_STATUS,this.LINK_STATUS=t.LINK_STATUS,this.DYNAMIC_DRAW=t.DYNAMIC_DRAW}isWebGl2(){return Jo(this.gl)}activeTexture(t){const{gl:e}=this;this.activeTextureUnit!==t&&(e.activeTexture(t+e.TEXTURE0),this.activeTextureUnit=t)}bindTexture(t){const{gl:e,activeTextureUnit:s,texture2dUnits:i}=this;i[s]!==t&&(i[s]=t,e.bindTexture(this.gl.TEXTURE_2D,t))}_getActiveTexture(){const{activeTextureUnit:t,texture2dUnits:e}=this;return e[t]}texParameteri(t,e){const{gl:s,texture2dParams:i}=this,n=this._getActiveTexture();if(!n)throw new Error("No active texture");let o=i.get(n);o||(o={},i.set(n,o)),o[t]!==e&&(o[t]=e,s.texParameteri(s.TEXTURE_2D,t,e))}texImage2D(t,e,s,i,n,o,a,c){const{gl:u}=this;o?u.texImage2D(u.TEXTURE_2D,t,e,s,i,n,o,a,c):u.texImage2D(u.TEXTURE_2D,t,e,s,i,n)}compressedTexImage2D(t,e,s,i,n,o){const{gl:a}=this;a.compressedTexImage2D(a.TEXTURE_2D,t,e,s,i,n,o)}pixelStorei(t,e){const{gl:s}=this;s.pixelStorei(t,e)}generateMipmap(){const{gl:t}=this;t.generateMipmap(t.TEXTURE_2D)}createTexture(){const{gl:t}=this;return t.createTexture()}deleteTexture(t){const{gl:e}=this;t&&this.texture2dParams.delete(t),e.deleteTexture(t)}viewport(t,e,s,i){const{gl:n}=this;n.viewport(t,e,s,i)}clearColor(t,e,s,i){const{gl:n}=this;n.clearColor(t,e,s,i)}setScissorTest(t){const{gl:e,scissorEnabled:s}=this;t!==s&&(t?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),this.scissorEnabled=t)}scissor(t,e,s,i){const{gl:n,scissorX:o,scissorY:a,scissorWidth:c,scissorHeight:u}=this;(t!==o||e!==a||s!==c||i!==u)&&(n.scissor(t,e,s,i),this.scissorX=t,this.scissorY=e,this.scissorWidth=s,this.scissorHeight=i)}setBlend(t){const{gl:e,blendEnabled:s}=this;t!==s&&(t?e.enable(e.BLEND):e.disable(e.BLEND),this.blendEnabled=t)}blendFunc(t,e){const{gl:s,blendSrcRgb:i,blendDstRgb:n,blendSrcAlpha:o,blendDstAlpha:a}=this;(t!==i||e!==n||t!==o||e!==a)&&(s.blendFunc(t,e),this.blendSrcRgb=t,this.blendDstRgb=e,this.blendSrcAlpha=t,this.blendDstAlpha=e)}createBuffer(){const{gl:t}=this;return t.createBuffer()}clear(){const{gl:t}=this;t.clear(t.COLOR_BUFFER_BIT)}arrayBufferData(t,e,s){const{gl:i,boundArrayBuffer:n}=this;n!==t&&(i.bindBuffer(i.ARRAY_BUFFER,t),this.boundArrayBuffer=t),i.bufferData(i.ARRAY_BUFFER,e,s)}elementArrayBufferData(t,e,s){const{gl:i,boundElementArrayBuffer:n}=this;n!==t&&(i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t),this.boundElementArrayBuffer=t),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e,s)}vertexAttribPointer(t,e,s,i,n,o,a){const{gl:c,boundArrayBuffer:u}=this;u!==t&&(c.bindBuffer(c.ARRAY_BUFFER,t),this.boundArrayBuffer=t),c.vertexAttribPointer(e,s,i,n,o,a)}useProgram(t){const{gl:e,curProgram:s}=this;s!==t&&(e.useProgram(t),this.curProgram=t)}setUniform(t,e,...s){const{gl:i,programUniforms:n}=this;let o=n.get(this.curProgram);o||(o=new Map,n.set(this.curProgram,o));const a=o.get(e);(!a||!Ta(a,s))&&(o.set(e,s),i[t](e,...s))}getParameter(t){const{gl:e}=this;return e.getParameter(t)}drawElements(t,e,s,i){const{gl:n}=this;n.drawElements(t,e,s,i)}getExtension(t){const{gl:e}=this;return e.getExtension(t)}createVertexArray(){const{gl:t}=this;return P(t instanceof WebGL2RenderingContext),t.createVertexArray()}bindVertexArray(t){const{gl:e}=this;P(e instanceof WebGL2RenderingContext),e.bindVertexArray(t)}getAttribLocation(t,e){const{gl:s}=this;return s.getAttribLocation(t,e)}getUniformLocation(t,e){const{gl:s}=this;return s.getUniformLocation(t,e)}enableVertexAttribArray(t){const{gl:e}=this;e.enableVertexAttribArray(t)}disableVertexAttribArray(t){const{gl:e}=this;e.disableVertexAttribArray(t)}createShader(t){const{gl:e}=this;return e.createShader(t)}compileShader(t){const{gl:e}=this;e.compileShader(t)}attachShader(t,e){const{gl:s}=this;s.attachShader(t,e)}linkProgram(t){const{gl:e}=this;e.linkProgram(t)}deleteProgram(t){const{gl:e}=this;e.deleteProgram(t)}getShaderParameter(t,e){const{gl:s}=this;return s.getShaderParameter(t,e)}getShaderInfoLog(t){const{gl:e}=this;return e.getShaderInfoLog(t)}createProgram(){const{gl:t}=this;return t.createProgram()}getProgramParameter(t,e){const{gl:s}=this;return s.getProgramParameter(t,e)}getProgramInfoLog(t){const{gl:e}=this;return e.getProgramInfoLog(t)}shaderSource(t,e){const{gl:s}=this;s.shaderSource(t,e)}deleteShader(t){const{gl:e}=this;e.deleteShader(t)}}function Ta(r,t){return r.length!==t.length?!1:r.every((e,s)=>Array.isArray(e)||e instanceof Float32Array?!1:e===t[s])}const wa=24;class Jr extends bn{constructor(e){super(e);l(this,"glw");l(this,"system");l(this,"quadBuffer",new ArrayBuffer(1024*1024*4));l(this,"fQuadBuffer",new Float32Array(this.quadBuffer));l(this,"uiQuadBuffer",new Uint32Array(this.quadBuffer));l(this,"renderOps",[]);l(this,"curBufferIdx",0);l(this,"curRenderOp",null);l(this,"renderables",[]);l(this,"defaultShader");l(this,"quadBufferCollection");l(this,"defaultTexture");this.mode="webgl";const{canvas:s,clearColor:i,bufferMemory:n}=e;this.defaultTexture=new js(this.txManager),this.defaultTexture.once("loaded",()=>{this.stage.requestRender()});const o=Wo(s,e.contextSpy),a=this.glw=new va(o),c=He(i);a.viewport(0,0,s.width,s.height),a.clearColor(c[0],c[1],c[2],c[3]),a.setBlend(!0),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),fa(a,n),this.system={parameters:ua(this.glw),extensions:da(this.glw)},this.shManager.renderer=this,this.defaultShader=this.shManager.loadShader("DefaultShader").shader;const u=a.createBuffer();P(u);const h=6*Float32Array.BYTES_PER_ELEMENT;this.quadBufferCollection=new Mn([{buffer:u,attributes:{a_position:{name:"a_position",size:2,type:a.FLOAT,normalized:!1,stride:h,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:a.FLOAT,normalized:!1,stride:h,offset:2*Float32Array.BYTES_PER_ELEMENT},a_color:{name:"a_color",size:4,type:a.UNSIGNED_BYTE,normalized:!0,stride:h,offset:4*Float32Array.BYTES_PER_ELEMENT},a_textureIndex:{name:"a_textureIndex",size:1,type:a.FLOAT,normalized:!1,stride:h,offset:5*Float32Array.BYTES_PER_ELEMENT}}}])}reset(){const{glw:e}=this;this.curBufferIdx=0,this.curRenderOp=null,this.renderOps.length=0,e.setScissorTest(!1),e.clear()}getShaderManager(){return this.shManager}createCtxTexture(e){return e instanceof Gt?new xa(this.glw,this.txMemManager,e):new Ir(this.glw,this.txMemManager,e)}addQuad(e){const{fQuadBuffer:s,uiQuadBuffer:i}=this,{width:n,height:o,colorTl:a,colorTr:c,colorBl:u,colorBr:h,textureOptions:d,shader:x,shaderProps:g,alpha:_,clippingRect:m,tx:v,ty:T,ta:O,tb:R,tc:E,td:F}=e;let{texture:B}=e;if(g&&Cr(g,"$dimensions")){const le=g.$dimensions;le.width=n,le.height=o}B=B??this.defaultTexture,P(B instanceof vs,"Invalid texture type");let{curBufferIdx:w,curRenderOp:D}=this;const k={width:n,height:o},Y=x||this.defaultShader;P(Y instanceof rt),D&&(D.shader!==Y||!na(D.clippingRect,m)||D.shader!==this.defaultShader&&(!g||!D.shader.canBatchShaderProps(D.shaderProps,g)))&&(D=null),P(Y instanceof rt),D||(this.newRenderOp(Y,g,_,k,m,w),D=this.curRenderOp,P(D));const X=(d==null?void 0:d.flipX)??!1,ee=(d==null?void 0:d.flipY)??!1;let J=0,se=0,G=1,W=1;if(B instanceof Gt){const{x:le,y:xe,width:me,height:It}=B.props,{width:At=0,height:et=0}=B.parentTexture.dimensions||{width:0,height:0};J=le/At,G=J+me/At,se=xe/et,W=se+It/et,B=B.parentTexture}X&&([J,G]=[G,J]),ee&&([se,W]=[W,se]);const{txManager:V}=this.stage,K=V.getCtxTexture(B);P(K instanceof Ir);const ie=this.addTexture(K,w);if(D=this.curRenderOp,P(D),R!==0||E!==0)s[w++]=v,s[w++]=T,s[w++]=J,s[w++]=se,i[w++]=a,s[w++]=ie,s[w++]=v+n*O,s[w++]=T+n*E,s[w++]=G,s[w++]=se,i[w++]=c,s[w++]=ie,s[w++]=v+o*R,s[w++]=T+o*F,s[w++]=J,s[w++]=W,i[w++]=u,s[w++]=ie,s[w++]=v+n*O+o*R,s[w++]=T+n*E+o*F,s[w++]=G,s[w++]=W,i[w++]=h,s[w++]=ie;else{const le=v+n*O,xe=T+o*F;s[w++]=v,s[w++]=T,s[w++]=J,s[w++]=se,i[w++]=a,s[w++]=ie,s[w++]=le,s[w++]=T,s[w++]=G,s[w++]=se,i[w++]=c,s[w++]=ie,s[w++]=v,s[w++]=xe,s[w++]=J,s[w++]=W,i[w++]=u,s[w++]=ie,s[w++]=le,s[w++]=xe,s[w++]=G,s[w++]=W,i[w++]=h,s[w++]=ie}D.length+=wa,D.numQuads++,this.curBufferIdx=w}newRenderOp(e,s,i,n,o,a){const c=new Rn(this.glw,this.options,this.quadBufferCollection,e,s,i,o,n,a,0);this.curRenderOp=c,this.renderOps.push(c)}addTexture(e,s,i){const{curRenderOp:n}=this;P(n);const o=n.addTexture(e);if(o===4294967295){if(i)throw new Error("Unable to add texture to render op");const{shader:a,shaderProps:c,dimensions:u,clippingRect:h,alpha:d}=n;return this.newRenderOp(a,c,d,u,h,s),this.addTexture(e,s,!0)}return o}addRenderOp(e){this.renderOps.push(e),this.curRenderOp=null}render(e="screen"){const{glw:s,quadBuffer:i}=this,n=new Float32Array(i,0,this.curBufferIdx),o=this.quadBufferCollection.getBuffer("a_position")??null;s.arrayBufferData(o,n,s.STATIC_DRAW),this.renderOps.forEach((a,c)=>{a.draw()}),this.renderables=[]}}function Sa(r){return/\.(ktx|pvr)$/.test(r)}const ba=async r=>{const e=await(await fetch(r)).arrayBuffer();return r.indexOf(".ktx")!==-1?Ra(e):Ea(e)},Ra=async r=>{const t=new DataView(r),e=t.getUint32(12)===16909060,s=[],i={glInternalFormat:t.getUint32(28,e),pixelWidth:t.getUint32(36,e),pixelHeight:t.getUint32(40,e),numberOfMipmapLevels:t.getUint32(56,e),bytesOfKeyValueData:t.getUint32(60,e)};let n=64;n+=i.bytesOfKeyValueData;for(let o=0;o<i.numberOfMipmapLevels;o++){const a=t.getUint32(n);n+=4,s.push(t.buffer.slice(n,a)),n+=a}return{data:{glInternalFormat:i.glInternalFormat,mipmaps:s,width:i.pixelWidth||0,height:i.pixelHeight||0,type:"ktx"},premultiplyAlpha:!1}},Ea=async r=>{const a=r,c=new Int32Array(a,0,13),u=c[12]+52,h=new Uint8Array(a,u),d=[],x={pixelWidth:c[7],pixelHeight:c[6],numberOfMipmapLevels:c[11]||0};let g=0,_=x.pixelWidth||0,m=x.pixelHeight||0;for(let v=0;v<x.numberOfMipmapLevels;v++){const T=(_+3>>2)*(m+3>>2)*8,O=new Uint8Array(a,h.byteOffset+g,T);d.push(O),g+=T,_=_>>1,m=m>>1}return{data:{glInternalFormat:36196,mipmaps:d,width:x.pixelWidth||0,height:x.pixelHeight||0,type:"pvr"},premultiplyAlpha:!1}},us=class us extends vs{constructor(e,s){super(e);l(this,"props");this.props=us.resolveDefaults(s)}hasAlphaChannel(e){return e.indexOf("image/png")!==-1}async getTextureData(){const{src:e,premultiplyAlpha:s}=this.props;if(!e)return{data:null};if(e instanceof ImageData)return{data:e,premultiplyAlpha:s};if(Sa(e))return ba(e);if(this.txManager.imageWorkerManager)return await this.txManager.imageWorkerManager.getImage(e,s);if(this.txManager.hasCreateImageBitmap){const n=await(await fetch(e)).blob(),o=s??this.hasAlphaChannel(n.type);return{data:await createImageBitmap(n,{premultiplyAlpha:o?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:o}}else{const i=new Image;return e.substr(0,5)!=="data:"&&(i.crossOrigin="Anonymous"),i.src=e,await new Promise((n,o)=>{i.onload=()=>n(),i.onerror=()=>o(new Error("Failed to load image"))}).catch(n=>{console.error(n)}),{data:i,premultiplyAlpha:s??!0}}}static makeCacheKey(e){const s=us.resolveDefaults(e);return s.src instanceof ImageData?!1:`ImageTexture,${s.src},${s.premultiplyAlpha}`}static resolveDefaults(e){return{src:e.src??"",premultiplyAlpha:e.premultiplyAlpha??!0}}};l(us,"z$__type__Props");let Or=us;const Ca={LINE_FEED:10,CARRIAGE_RETURN:13,SPACE:32,TAB:9,ZERO_WIDTH_SPACE:8203,ZERO_WIDTH_NON_JOINER:8204,ZERO_WIDTH_JOINER:8205,LEFT_TO_RIGHT_MARK:8206,RIGHT_TO_LEFT_MARK:8207,LEFT_TO_RIGHT_EMBEDDING:8234,RIGHT_TO_LEFT_EMBEDDING:8235,POP_DIRECTIONAL_FORMATTING:8236,LEFT_TO_RIGHT_OVERRIDE:8237,RIGHT_TO_LEFT_OVERRIDE:8238,LINE_SEPARATOR:8232,PARAGRAPH_SEPARATOR:8233,OBJECT_REPLACEMENT_CHARACTER:65532,REPLACEMENT_CHARACTER:65533,ZERO_WIDTH_NO_BREAK_SPACE:65279,LEFT_TO_RIGHT_ISOLATE:8294,RIGHT_TO_LEFT_ISOLATE:8295,FIRST_STRONG_ISOLATE:8296,POP_DIRECTIONAL_ISOLATE:8297,INHIBIT_SYMMETRIC_SWAPPING:8298,ACTIVATE_SYMMETRIC_SWAPPING:8299,INHIBIT_ARABIC_FORM_SHAPING:8300,ACTIVATE_ARABIC_FORM_SHAPING:8301,NATIONAL_DIGIT_SHAPES:8302,NOMINAL_DIGIT_SHAPES:8303,LEFT_TO_RIGHT_BOUNDARY:8206,RIGHT_TO_LEFT_BOUNDARY:8207};class Ia{}class Aa extends Ia{constructor(e,s){super();l(this,"data");l(this,"glyphMap");l(this,"kernings");this.data=e,this.glyphMap=s;const i=this.kernings={};e.kernings.forEach(n=>{const o=n.second,a=i[o]=i[o]||{};a[n.first]=n.amount}),this.kernings=i}*shapeText(e,s){var o;let i,n;for(;(i=s.peek())&&!i.done;){const a=i.value,c=this.glyphMap.get(a);if(s.next(),c!==void 0){const u=n!==void 0?(((o=this.kernings[c.id])==null?void 0:o[n])||0)+e.letterSpacing:0;n=c.id,yield{mapped:!0,glyphId:c.id,codepoint:a,cluster:s.lastIndex,xAdvance:c.xadvance+u,yAdvance:0,xOffset:c.xoffset+u,yOffset:c.yoffset,xBearing:0,yBearing:0,width:c.width,height:c.height}}else a===Ca.LINE_FEED&&(n=void 0),yield{mapped:!1,codepoint:a,cluster:s.lastIndex}}}}class Di extends wn{constructor(e,s,i,n,o,a){super(e,s);l(this,"type");l(this,"texture");l(this,"maxCharHeight",0);l(this,"data");l(this,"shaper");l(this,"glyphMap",new Map);this.type=i;const c=n.renderer;P(c instanceof Jr,"SDF Font Faces can only be used with the WebGL Renderer"),this.texture=n.txManager.loadTexture("ImageTexture",{src:o,premultiplyAlpha:!1},{preload:!0}),this.texture.on("loaded",()=>{this.checkLoaded()}),fetch(a).then(async u=>{this.data=await u.json();let h=0;this.data.chars.forEach(d=>{this.glyphMap.set(d.id,d);const x=d.yoffset+d.height;x>h&&(h=x)}),this.maxCharHeight=h,this.shaper=new Aa(this.data,this.glyphMap),this.checkLoaded()}).catch(console.error)}getAtlasEntry(e){const s=this.glyphMap.get(e);if(s===void 0)throw new Error(`Glyph ${e} not found in font ${this.fontFamily}`);return{x:s.x,y:s.y,width:s.width,height:s.height}}checkLoaded(){this.loaded||this.texture.state==="loaded"&&this.data&&(this.loaded=!0,this.emit("loaded"))}}const Ma=24;function La(r,t,e,s,i,n,o,a,c){const u=Math.min(Math.max(o.firstLineIdx,0),a.length),h=0;let d=0;s==="middle"?d=(t-r)/2:s==="bottom"&&(d=t-r);const g=i/n+u*t+d;if(!(c&&g>=c/n))return{sdfX:h,sdfY:g,lineIndex:u}}class ts{constructor(t,e=0){l(this,"iterator");l(this,"peekBuffer",[]);l(this,"_lastIndex");this.iterator=t,this.iterator=t,this._lastIndex=e-1,this.peekBuffer=[]}next(){const t=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return t.done?this._lastIndex=-1:this._lastIndex++,t}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const t=this.iterator.next();return this.peekBuffer.push(t),t}get lastIndex(){return this._lastIndex}}function*ss(r,t=0){let e=t;for(;e<r.length;){const s=r.codePointAt(e);if(s===void 0)throw new Error("Invalid Unicode code point");yield s,e+=s<=65535?1:2}}function Na(r,t,e){const s=e.shapeText(t,new ts(ss(r,0),0));let i=0;for(const n of s)n.mapped&&(i+=n.xAdvance);return i}function Pa(r,t,e,s,i,n,o,a,c,u,h,d,x,g,_,m,v,T,O){P(_,"Font face must be loaded"),P(_.loaded,"Font face must be loaded"),P(_.data,"Font face must be loaded"),P(_.shaper,"Font face must be loaded");const R=a/_.data.info.size,E=c/R,F=n/R,B=u/R,w=x[r],D=(w==null?void 0:w.codepointIndex)||0,k=(w==null?void 0:w.maxX)||0,Y=(w==null?void 0:w.maxY)||0;let X=k,ee=Y,J=t,se=e,G=0;const W={codepointIndex:-1,bufferOffset:-1,xStart:-1},V=_.shaper,K={letterSpacing:B};let ie=V.shapeText(K,new ts(ss(s,D),D)),le,xe=-1;const me=[],It=o/R,At=Na(T,K,V);let et=!0;for(;et;){const _e=(O===0||r+1<O)&&(d!=="both"||v||se+E+_.maxCharHeight<=It),Ae=_e?F:F-At;let ge=0;const ot=se+E>=g.y1,ze=se<=g.y2,Oe=ot&&ze;for(;(le=ie.next())&&!le.done;){const ce=le.value;if(r===x.length)x.push({codepointIndex:ce.cluster,maxY:ee,maxX:X});else if(r>x.length)throw new Error("Unexpected lineCache length");if(ce.codepoint===32||ce.codepoint===10?W.codepointIndex!==-1&&(W.codepointIndex=-1,ge=J):W.codepointIndex===-1&&(W.codepointIndex=ce.cluster,W.bufferOffset=G,W.xStart=ge),ce.mapped){const f=J+ce.xOffset+ce.width;if(d!=="none"&&f>=Ae&&W.codepointIndex!==-1&&W.xStart>0)if(_e){ie=V.shapeText(K,new ts(ss(s,W.codepointIndex),W.codepointIndex)),G=W.bufferOffset;break}else ie=V.shapeText(K,new ts(ss(T,0),0)),J=W.xStart,G=W.bufferOffset,d="none";else{const p=J+ce.xOffset,y=se+ce.yOffset;if(Oe){xe===-1&&(xe=G);const S=_.getAtlasEntry(ce.glyphId),b=S.x/_.data.common.scaleW,I=S.y/_.data.common.scaleH,L=S.width/_.data.common.scaleW,A=S.height/_.data.common.scaleH;h[G++]=p,h[G++]=y,h[G++]=b,h[G++]=I,h[G++]=p+ce.width,h[G++]=y,h[G++]=b+L,h[G++]=I,h[G++]=p,h[G++]=y+ce.height,h[G++]=b,h[G++]=I+A,h[G++]=p+ce.width,h[G++]=y+ce.height,h[G++]=b+L,h[G++]=I+A}ee=Math.max(ee,y+ce.height),X=Math.max(X,p+ce.width),J+=ce.xAdvance}}else if(ce.codepoint===10){if(_e)break;ie=V.shapeText(K,new ts(ss(T,0),0)),d="none"}}xe!==-1&&(me.push({bufferStart:xe,bufferEnd:G}),xe=-1),J=0,se+=E,r++,W.codepointIndex=-1,ge=0,!m&&d==="both"&&se>g.y2||le&&le.done?et=!1:_e||(et=!1)}if(i==="center"){const _e=d==="none"?X:F;for(let Ae=0;Ae<me.length;Ae++){const ge=me[Ae],ot=h[ge.bufferEnd-4]-h[ge.bufferStart],ze=(_e-ot)/2;for(let Oe=ge.bufferStart;Oe<ge.bufferEnd;Oe+=4)h[Oe]+=ze}}else if(i==="right"){const _e=d==="none"?X:F;for(let Ae=0;Ae<me.length;Ae++){const ge=me[Ae],ot=ge.bufferEnd===ge.bufferStart?0:h[ge.bufferEnd-4]-h[ge.bufferStart],ze=_e-ot;for(let Oe=ge.bufferStart;Oe<ge.bufferEnd;Oe+=4)h[Oe]+=ze}}return P(le),{bufferNumFloats:G,bufferNumQuads:G/16,layoutNumCharacters:le.done?s.length-D:le.value.cluster-D+1,fullyProcessed:!!le.done,maxX:X,maxY:ee}}function Oa(r,t){return Math.ceil(r/t)*t}function Fa(r,t){return Math.floor(r/t)*t}function Ba(r,t,e,s,i,n,o,a){const{screen:c,sdf:u}=r;if(!oa(o))c.x1=0,c.y1=0,c.x2=0,c.y2=0,u.x1=0,u.y1=0,u.x2=0,u.y2=0,r.numLines=0,r.firstLineIdx=0;else{const h=o.x1-t,d=h+(o.x2-o.x1),x=o.y1-e+s,g=Fa(x-n,i||1),_=Oa(x+(o.y2-o.y1)+n,i||1);c.x1=h,c.y1=g,c.x2=d,c.y2=_,u.x1=h/a,u.y1=g/a,u.x2=d/a,u.y2=_/a,r.numLines=Math.ceil((_-g)/i),r.firstLineIdx=i?Math.floor(g/i):0}r.valid=!0}const Da={normal:400,bold:700,bolder:900,lighter:100},Ui=r=>typeof r=="number"?r:Da[r]||400;function Ua(r,t,e,s,i){let n=Ui(e);for(const o of r){const a=o[t];if(!a)continue;if(a.size===1)return console.warn(`TrFontManager: Only one font face found for family: '${t}' - will be used for all weights and styles`),a.values().next().value;const c=new Map;for(const h of a){const d=Ui(h.descriptors.weight);if(d===n&&h.descriptors.style===s&&h.descriptors.stretch===i)return h;c.set(d,h)}const u=`TrFontManager: No exact match: '${t} Weight: ${n} Style: ${s} Stretch: ${i}'`;if(console.error(u),n===400&&c.has(500))return c.get(500);if(n===500&&c.has(400))return c.get(400);if(n<400){for(;n>0;){if(c.has(n))return c.get(n);n-=100}n=600}for(;n<1e3;){if(c.has(n))return c.get(n);n+=100}for(n=500;n>0;){if(c.has(n))return c.get(n);n-=100}}}const ka=Zr(Ua);class Ln{constructor(t){l(this,"textRenderers");this.textRenderers=t}addFontFace(t){for(const e in this.textRenderers){const s=this.textRenderers[e];s&&s.isFontFaceSupported(t)&&s.addFontFace(t)}}static resolveFontFace(t,e){const{fontFamily:s,fontWeight:i,fontStyle:n,fontStretch:o}=e;return ka(t,s,i,n,o)}}const za={x:0,y:0,width:0,height:0};class $a extends vn{constructor(e){super(e);l(this,"ssdfFontFamilies",{});l(this,"msdfFontFamilies",{});l(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]);l(this,"sdfShader");l(this,"rendererBounds");this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,s)=>{e.props.fontFamily=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontWeight:(e,s)=>{e.props.fontWeight=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStyle:(e,s)=>{e.props.fontStyle=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStretch:(e,s)=>{e.props.fontStretch=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontSize:(e,s)=>{e.props.fontSize=s,this.invalidateLayoutCache(e)},text:(e,s)=>{e.props.text=s,this.invalidateLayoutCache(e)},textAlign:(e,s)=>{e.props.textAlign=s,this.invalidateLayoutCache(e)},color:(e,s)=>{e.props.color=s},x:(e,s)=>{e.props.x=s,e.elementBounds.valid&&(this.setElementBoundsX(e),!e.renderWindow.valid&&fr(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},y:(e,s)=>{e.props.y=s,e.elementBounds.valid&&(this.setElementBoundsY(e),!e.renderWindow.valid&&fr(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},contain:(e,s)=>{e.props.contain=s,this.invalidateLayoutCache(e)},width:(e,s)=>{e.props.width=s,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,s)=>{e.props.height=s,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,s)=>{e.props.offsetY=s,this.invalidateLayoutCache(e)},scrollable:(e,s)=>{e.props.scrollable=s,this.invalidateLayoutCache(e)},scrollY:(e,s)=>{e.props.scrollY=s,this.scheduleUpdateState(e)},letterSpacing:(e,s)=>{e.props.letterSpacing=s,this.invalidateLayoutCache(e)},lineHeight:(e,s)=>{e.props.lineHeight=s,this.invalidateLayoutCache(e)},maxLines:(e,s)=>{e.props.maxLines=s,this.invalidateLayoutCache(e)},textBaseline:(e,s)=>{e.props.textBaseline=s,this.invalidateLayoutCache(e)},verticalAlign:(e,s)=>{e.props.verticalAlign=s,this.invalidateLayoutCache(e)},overflowSuffix:(e,s)=>{e.props.overflowSuffix=s,this.invalidateLayoutCache(e)},debug:(e,s)=>{e.props.debug=s}}}canRenderFont(e){const{fontFamily:s}=e;return s in this.ssdfFontFamilies||s in this.msdfFontFamilies||s==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(e){return e instanceof Di}addFontFace(e){P(e instanceof Di);const s=e.fontFamily,i=e.type==="ssdf"?this.ssdfFontFamilies:e.type==="msdf"?this.msdfFontFamilies:void 0;if(!i){console.warn(`Invalid font face type: ${e.type}`);return}let n=i[s];n||(n=new Set,i[s]=n),n.add(e)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new it,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(e){let{trFontFace:s}=e;const{textH:i,lineCache:n,debugData:o,forceFullLayoutCalc:a}=e;if(o.updateCount++,e.status==="initialState"&&this.setStatus(e,"loading"),!s){if(s=this.resolveFontFace(e.props),e.trFontFace=s,!s){const V=`SdfTextRenderer: Could not resolve font face for family: '${e.props.fontFamily}'`;console.error(V),this.setStatus(e,"failed",new Error(V));return}s.texture.setRenderableOwner(e,e.isRenderable)}if(!s.loaded){s.once("loaded",()=>{this.scheduleUpdateState(e)});return}P(s.data,"Font face data should be loaded");const{text:c,fontSize:u,x:h,y:d,contain:x,width:g,height:_,lineHeight:m,verticalAlign:v,scrollable:T,overflowSuffix:O,maxLines:R}=e.props,E=x==="both"&&T?e.props.scrollY:0,{renderWindow:F}=e,B=s.data.info.size,w=u/B,D=m/w;e.distanceRange=w*s.data.distanceField.distanceRange;const k=c.length*Ma;let Y=e.vertexBuffer;(!Y||Y.length<k)&&(Y=new Float32Array(k*2));const X=e.elementBounds;if(X.valid||(this.setElementBoundsX(e),this.setElementBoundsY(e),X.valid=!0),!a&&F.valid){const V=F.screen;if(h+V.x1<=X.x1&&h+V.x2>=X.x2&&d-E+V.y1<=X.y1&&d-E+V.y2>=X.y2){this.setStatus(e,"loaded");return}F.valid=!1,this.setStatus(e,"loading")}const{offsetY:ee,textAlign:J}=e.props;if(!F.valid){if(!fr(X,this.rendererBounds))return;Ba(F,h,d,E,m,x==="both"?X.y2-X.y1:0,X,w)}const se=La(B,D,m,v,ee,w,F,n,i);if(!se){this.setStatus(e,"loaded");return}const{letterSpacing:G}=e.props,W=Pa(se.lineIndex,se.sdfX,se.sdfY,c,J,g,_,u,m,G,Y,x,n,F.sdf,s,a,T,O,R);e.bufferUploaded=!1,e.bufferNumFloats=W.bufferNumFloats,e.bufferNumQuads=W.bufferNumQuads,e.vertexBuffer=Y,e.renderWindow=F,o.lastLayoutNumCharacters=W.layoutNumCharacters,o.bufferSize=Y.byteLength,W.fullyProcessed&&(e.textW=W.maxX*w,e.textH=W.maxY*w),this.setStatus(e,"loaded")}renderQuads(e,s,i,n){var k,Y;if(!e.vertexBuffer)return;const o=this.stage.renderer;P(o instanceof Jr);const{fontSize:a,color:c,contain:u,scrollable:h,zIndex:d,debug:x}=e.props,g=u==="both"&&h?e.props.scrollY:0,{textW:_=0,textH:m=0,distanceRange:v,vertexBuffer:T,bufferUploaded:O,trFontFace:R,elementBounds:E}=e;let{webGlBuffers:F}=e;if(!F){const X=o.glw,ee=4*Float32Array.BYTES_PER_ELEMENT,J=X.createBuffer();P(J),e.webGlBuffers=new Mn([{buffer:J,attributes:{a_position:{name:"a_position",size:2,type:X.FLOAT,normalized:!1,stride:ee,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:X.FLOAT,normalized:!1,stride:ee,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),e.bufferUploaded=!1,P(e.webGlBuffers),F=e.webGlBuffers}if(!O){const X=o.glw,ee=(F==null?void 0:F.getBuffer("a_textureCoordinate"))??null;X.arrayBufferData(ee,T,X.STATIC_DRAW),e.bufferUploaded=!0}if(P(R),h&&u==="both"){P(E.valid);const X=ia(E,za);i.valid?(e.clippingRect.valid=!0,i=Qr(i,X,e.clippingRect)):(e.clippingRect.valid=!0,i=Tn(X,e.clippingRect))}const B=new Rn(o.glw,o.options,F,this.sdfShader,{transform:s.data,color:Xo(c,n),size:a/(((k=R.data)==null?void 0:k.info.size)||0),scrollY:g,distanceRange:v,debug:x.sdfShaderDebug},n,i,{height:m,width:_},0,d),w=(Y=e.trFontFace)==null?void 0:Y.texture;P(w);const D=this.stage.txManager.getCtxTexture(w);B.addTexture(D),B.length=e.bufferNumFloats,B.numQuads=e.bufferNumQuads,o.addRenderOp(B)}setIsRenderable(e,s){var i;super.setIsRenderable(e,s),(i=e.trFontFace)==null||i.texture.setRenderableOwner(e,s)}destroyState(e){var s;super.destroyState(e),(s=e.trFontFace)==null||s.texture.setRenderableOwner(e,!1)}resolveFontFace(e){return Ln.resolveFontFace(this.fontFamilyArray,e)}releaseFontFace(e){e.trFontFace&&(e.trFontFace.texture.setRenderableOwner(e,!1),e.trFontFace=void 0)}invalidateLayoutCache(e){e.renderWindow.valid=!1,e.elementBounds.valid=!1,e.textH=void 0,e.textW=void 0,e.lineCache=[],this.setStatus(e,"loading"),this.scheduleUpdateState(e)}setElementBoundsX(e){const{x:s,contain:i,width:n}=e.props,{elementBounds:o}=e;o.x1=s,o.x2=i!=="none"?s+n:1/0}setElementBoundsY(e){const{y:s,contain:i,height:n}=e.props,{elementBounds:o}=e;o.y1=s,o.y2=i==="both"?s+n:1/0}}class Wa{}function Xa(r){return r.prototype instanceof Wa}async function Ya(r,t){let e;try{console.log("Loading core extension",r),e=await Qo(()=>import(r),[])}catch(i){console.error(`The core extension module at '${r}' could not be loaded.`),console.error(i);return}if(!e.default){console.error(`The core extension module at '${r}' does not have a default export.`);return}const s=e.default;if(Xa(s)){const i=new s;try{await i.run(t)}catch(n){console.error(`The core extension at '${r}' threw an error.`),console.error(n)}}else console.error(`The core extension at '${r}' does not extend CoreExtension.`)}function Nn(r){const t={boolean:!0,string:!0,number:!0,undefined:!0},e=Object.keys(r);for(let s=0;s<e.length;s++){const i=e[s];if(!i)continue;const n=r[i],o=typeof n;o==="string"&&n.length>2048&&(console.warn(`Custom Data value for ${i} is too long, it will be truncated to 2048 characters`),r[i]=n.substring(0,2048)),t[o]||(console.warn(`Custom Data value for ${i} is not a boolean, string, or number, it will be ignored`),delete r[i])}return r}class Ha extends it{constructor(e,s,i){super();l(this,"root",null);l(this,"driver");l(this,"canvas");l(this,"settings");l(this,"inspector",null);l(this,"nodes",new Map);l(this,"nextTextureId",1);l(this,"textureTracker");const n={appWidth:e.appWidth||1920,appHeight:e.appHeight||1080,txMemByteThreshold:e.txMemByteThreshold||124e6,boundsMargin:e.boundsMargin||0,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:e.clearColor??0,coreExtensionModule:e.coreExtensionModule||null,experimental_FinalizationRegistryTextureUsageTracker:e.experimental_FinalizationRegistryTextureUsageTracker??!1,textureCleanupOptions:e.textureCleanupOptions||{},fpsUpdateInterval:e.fpsUpdateInterval||0,numImageWorkers:e.numImageWorkers!==void 0?e.numImageWorkers:2,enableContextSpy:e.enableContextSpy??!1,enableInspector:e.enableInspector??!1,renderMode:e.renderMode??"webgl"};this.settings=n;const{appWidth:o,appHeight:a,deviceLogicalPixelRatio:c,devicePhysicalPixelRatio:u,enableInspector:h}=n,d=T=>{this.driver.releaseTexture(T)},x=n.experimental_FinalizationRegistryTextureUsageTracker&&typeof FinalizationRegistry=="function";this.textureTracker=x?new Go(d):new Ho(d,this.settings.textureCleanupOptions);const g=o*c,_=a*c;this.driver=i;const m=document.createElement("canvas");this.canvas=m,m.width=g*u,m.height=_*u,m.style.width=`${g}px`,m.style.height=`${_}px`;let v;if(typeof s=="string"?v=document.getElementById(s):v=s,!v)throw new Error("Could not find target element");i.onCreateNode=T=>{this.nodes.set(T.id,T)},i.onBeforeDestroyNode=T=>{this.nodes.delete(T.id)},i.onFpsUpdate=T=>{this.emit("fpsUpdate",T)},i.onFrameTick=T=>{this.emit("frameTick",T)},i.onIdle=()=>{this.emit("idle")},v.appendChild(m),h&&!qr()&&(this.inspector=new jo(m,n))}async init(){await this.driver.init(this,this.settings,this.canvas),this.root=this.driver.getRootNode()}createNode(e){return this.inspector?this.inspector.createNode(this.driver,this.resolveNodeDefaults(e)):this.driver.createNode(this.resolveNodeDefaults(e))}createTextNode(e){const s=e.fontSize??16,i={...this.resolveNodeDefaults(e),text:e.text??"",textRendererOverride:e.textRendererOverride??null,fontSize:s,fontFamily:e.fontFamily??"sans-serif",fontStyle:e.fontStyle??"normal",fontWeight:e.fontWeight??"normal",fontStretch:e.fontStretch??"normal",textAlign:e.textAlign??"left",contain:e.contain??"none",scrollable:e.scrollable??!1,scrollY:e.scrollY??0,offsetY:e.offsetY??0,letterSpacing:e.letterSpacing??0,lineHeight:e.lineHeight??s,maxLines:e.maxLines??0,textBaseline:e.textBaseline??"alphabetic",verticalAlign:e.verticalAlign??"top",overflowSuffix:e.overflowSuffix??"...",debug:e.debug??{}};return this.inspector?this.inspector.createTextNode(this.driver,i):this.driver.createTextNode(i)}resolveNodeDefaults(e){const s=e.color??4294967295,i=e.colorTl??e.colorTop??e.colorLeft??s,n=e.colorTr??e.colorTop??e.colorRight??s,o=e.colorBl??e.colorBottom??e.colorLeft??s,a=e.colorBr??e.colorBottom??e.colorRight??s,c=Nn(e.data??{});return{x:e.x??0,y:e.y??0,width:e.width??0,height:e.height??0,alpha:e.alpha??1,autosize:e.autosize??!1,clipping:e.clipping??!1,color:s,colorTop:e.colorTop??s,colorBottom:e.colorBottom??s,colorLeft:e.colorLeft??s,colorRight:e.colorRight??s,colorBl:o,colorBr:a,colorTl:i,colorTr:n,zIndex:e.zIndex??0,zIndexLocked:e.zIndexLocked??0,parent:e.parent??null,texture:e.texture??null,shader:e.shader??null,src:e.src??"",scale:e.scale??null,scaleX:e.scaleX??e.scale??1,scaleY:e.scaleY??e.scale??1,mount:e.mount??0,mountX:e.mountX??e.mount??0,mountY:e.mountY??e.mount??0,pivot:e.pivot??.5,pivotX:e.pivotX??e.pivot??.5,pivotY:e.pivotY??e.pivot??.5,rotation:e.rotation??0,data:c}}destroyNode(e){return this.inspector&&this.inspector.destroyNode(e),this.driver.destroyNode(e)}createTexture(e,s,i){const n=this.nextTextureId++,o={descType:"texture",txType:e,props:s,options:{...i,id:n}};return this.textureTracker.registerTexture(o),o}createShader(e,s){return{descType:"shader",shType:e,props:s}}getNodeById(e){return this.nodes.get(e)||null}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}rerender(){throw new Error("Not implemented")}}class Ga extends it{constructor(e,s,i){super();l(this,"node");l(this,"props");l(this,"settings");l(this,"propStartValues",{});l(this,"restoreValues",{});l(this,"progress",0);l(this,"delayFor",0);l(this,"timingFunction");l(this,"propsList");this.node=e,this.props=s,this.settings=i,this.propStartValues={},this.propsList=Object.keys(s),this.propsList.forEach(n=>{this.propStartValues[n]=e[n]}),this.timingFunction=n=>n,i.easing&&typeof i.easing=="string"&&(this.timingFunction=ga(i.easing)),this.delayFor=i.delay||0}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restore(){this.reset(),Object.keys(this.props).forEach(e=>{this.node[e]=this.propStartValues[e]})}reverse(){this.progress=0,Object.keys(this.props).forEach(e=>{const s=this.props[e],i=this.propStartValues[e];this.props[e]=i,this.propStartValues[e]=s}),this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(e,s,i){return(this.timingFunction(e)||e)*(i-s)+s}update(e){const{duration:s,loop:i,easing:n,stopMethod:o}=this.settings;if(!s){this.emit("finished",{});return}if(this.delayFor>0){this.delayFor-=e;return}if(this.delayFor<=0&&this.progress===0&&this.emit("start",{}),this.progress+=e/s,this.progress>1&&(this.progress=i?0:1,o)){this.emit("finished",{});return}for(let a=0;a<this.propsList.length;a++){const c=this.propsList[a],u=this.props[c],h=this.propStartValues[c],d=u;if(c.indexOf("color")!==-1){if(h===d){this.node[c]=h;continue}if(n){const x=this.timingFunction(this.progress)||this.progress,g=Ei(h,d,x);this.node[c]=g;continue}this.node[c]=Ei(h,d,this.progress);continue}if(n){this.node[c]=this.applyEasing(this.progress,h,d);continue}this.node[c]=h+(d-h)*this.progress}this.progress===1&&this.emit("finished",{})}}class Va{constructor(t,e){l(this,"manager");l(this,"animation");l(this,"startedPromise",null);l(this,"startedResolve",null);l(this,"stoppedPromise",null);l(this,"stoppedResolve",null);l(this,"state");this.manager=t,this.animation=e,this.state="stopped"}start(){return this.makeStartedPromise(),this.animation.once("start",this.started.bind(this)),this.makeStoppedPromise(),this.animation.once("finished",this.finished.bind(this)),this.manager.activeAnimations.has(this.animation)||this.manager.registerAnimation(this.animation),this.state="running",this}stop(){return this.manager.unregisterAnimation(this.animation),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null),this.animation.reset(),this.state="stopped",this}pause(){return this.manager.unregisterAnimation(this.animation),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStarted(){this.makeStartedPromise();const t=this.startedPromise;return P(t),t}waitUntilStopped(){this.makeStoppedPromise();const t=this.stoppedPromise;return P(t),t}makeStartedPromise(){this.startedResolve===null&&(this.startedPromise=new Promise(t=>{this.startedResolve=t}))}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(t=>{this.stoppedResolve=t}))}started(){P(this.startedResolve),this.startedResolve(this),this.startedResolve=null}finished(){P(this.stoppedResolve);const{loop:t,stopMethod:e}=this.animation.settings;if(e==="reverse"){this.animation.reverse(),this.start();return}this.stoppedResolve(),this.stoppedResolve=null,!t&&this.manager.unregisterAnimation(this.animation)}}const de=0,fe=3,Se=6,he=1,pe=4,Re=7,Fe=2,Be=5,De=8;class Ue{constructor(t){l(this,"data");t?(this.data=new Float32Array(9),this.data[de]=t[0],this.data[fe]=t[3],this.data[Se]=t[6],this.data[he]=t[1],this.data[pe]=t[4],this.data[Re]=t[7],this.data[Fe]=t[2],this.data[Be]=t[5],this.data[De]=t[8]):this.data=new Float32Array(9)}static get temp(){return ja}static multiply(t,e,s){const i=t.data[de]*e.data[de]+t.data[fe]*e.data[he]+t.data[Se]*e.data[Fe],n=t.data[de]*e.data[fe]+t.data[fe]*e.data[pe]+t.data[Se]*e.data[Be],o=t.data[de]*e.data[Se]+t.data[fe]*e.data[Re]+t.data[Se]*e.data[De],a=t.data[he]*e.data[de]+t.data[pe]*e.data[he]+t.data[Re]*e.data[Fe],c=t.data[he]*e.data[fe]+t.data[pe]*e.data[pe]+t.data[Re]*e.data[Be],u=t.data[he]*e.data[Se]+t.data[pe]*e.data[Re]+t.data[Re]*e.data[De],h=t.data[Fe]*e.data[de]+t.data[Be]*e.data[he]+t.data[De]*e.data[Fe],d=t.data[Fe]*e.data[fe]+t.data[Be]*e.data[pe]+t.data[De]*e.data[Be],x=t.data[Fe]*e.data[Se]+t.data[Be]*e.data[Re]+t.data[De]*e.data[De];return s||(s=new Ue),s.data[de]=i,s.data[fe]=n,s.data[Se]=o,s.data[he]=a,s.data[pe]=c,s.data[Re]=u,s.data[Fe]=h,s.data[Be]=d,s.data[De]=x,s}static identity(t){return t||(t=new Ue),t.data[de]=1,t.data[fe]=0,t.data[Se]=0,t.data[he]=0,t.data[pe]=1,t.data[Re]=0,t.data[Fe]=0,t.data[Be]=0,t.data[De]=1,t}static translate(t,e,s){return s||(s=new Ue),s.data[de]=1,s.data[fe]=0,s.data[Se]=t,s.data[he]=0,s.data[pe]=1,s.data[Re]=e,s.data[Fe]=0,s.data[Be]=0,s.data[De]=1,s}static scale(t,e,s){return s||(s=new Ue),s.data[de]=t,s.data[fe]=0,s.data[Se]=0,s.data[he]=0,s.data[pe]=e,s.data[Re]=0,s.data[Fe]=0,s.data[Be]=0,s.data[De]=1,s}static rotate(t,e){const s=Math.cos(t),i=Math.sin(t);return e||(e=new Ue),e.data[de]=s,e.data[fe]=-i,e.data[Se]=0,e.data[he]=i,e.data[pe]=s,e.data[Re]=0,e.data[Fe]=0,e.data[Be]=0,e.data[De]=1,e}static copy(t,e,s){return e||(e=new Ue),e.data[0]=t.data[0],e.data[1]=t.data[1],e.data[2]=t.data[2],e.data[3]=t.data[3],e.data[4]=t.data[4],e.data[5]=t.data[5],e.data[6]=t.data[6],e.data[7]=t.data[7],e.data[8]=t.data[8],e}translate(t,e){return this.data[Se]=this.data[de]*t+this.data[fe]*e+this.data[Se],this.data[Re]=this.data[he]*t+this.data[pe]*e+this.data[Re],this}scale(t,e){return this.data[de]=this.data[de]*t,this.data[fe]=this.data[fe]*e,this.data[he]=this.data[he]*t,this.data[pe]=this.data[pe]*e,this}rotate(t){if(t===0||!(t%Math.PI*2))return this;const e=Math.cos(t),s=Math.sin(t),i=this.data[de]*e+this.data[fe]*s,n=this.data[fe]*e-this.data[de]*s,o=this.data[he]*e+this.data[pe]*s,a=this.data[pe]*e-this.data[he]*s;return this.data[de]=i,this.data[fe]=n,this.data[he]=o,this.data[pe]=a,this}multiply(t){return Ue.multiply(this,t,this)}get tx(){return this.data[Se]}get ty(){return this.data[Re]}get ta(){return this.data[de]}get tb(){return this.data[fe]}get tc(){return this.data[he]}get td(){return this.data[pe]}transformPoint(t,e){return[this.data[de]*t+this.data[fe]*e+this.data[Se],this.data[he]*t+this.data[pe]*e+this.data[he]]}}const ja=new Ue,Ss=0,bs=2,Rs=4,Es=6,Cs=1,Is=3,As=5,Ms=7;class Ks{constructor(t){l(this,"data");this.data=new Float32Array(8),t&&(this.data[Ss]=t[Ss],this.data[bs]=t[bs],this.data[Rs]=t[Rs],this.data[Es]=t[Es],this.data[Cs]=t[Cs],this.data[Is]=t[Is],this.data[As]=t[As],this.data[Ms]=t[Ms])}static translate(t,e,s,i,n,o,a,c,u){return u||(u=new Ks),u.data[Ss]=t,u.data[bs]=s,u.data[Rs]=n,u.data[Es]=a,u.data[Cs]=e,u.data[Is]=i,u.data[As]=o,u.data[Ms]=c,u}get x1(){return this.data[Ss]}get x2(){return this.data[bs]}get x3(){return this.data[Rs]}get x4(){return this.data[Es]}get y1(){return this.data[Cs]}get y2(){return this.data[Is]}get y3(){return this.data[As]}get y4(){return this.data[Ms]}}var ue;(function(r){r[r.Init=0]="Init",r[r.OutOfBounds=2]="OutOfBounds",r[r.InBounds=4]="InBounds",r[r.InViewport=8]="InViewport"})(ue||(ue={}));const bt=new Map;bt.set(ue.Init,"init");bt.set(ue.OutOfBounds,"outOfBounds");bt.set(ue.InBounds,"inBounds");bt.set(ue.InViewport,"inViewport");var N;(function(r){r[r.Children=1]="Children",r[r.ScaleRotate=2]="ScaleRotate",r[r.Local=4]="Local",r[r.Global=8]="Global",r[r.Clipping=16]="Clipping",r[r.CalculatedZIndex=32]="CalculatedZIndex",r[r.ZIndexSortedChildren=64]="ZIndexSortedChildren",r[r.PremultipliedColors=128]="PremultipliedColors",r[r.WorldAlpha=256]="WorldAlpha",r[r.RenderState=512]="RenderState",r[r.IsRenderable=1024]="IsRenderable",r[r.None=0]="None",r[r.All=2047]="All"})(N||(N={}));class ei extends it{constructor(e,s){super();l(this,"stage");l(this,"children",[]);l(this,"props");l(this,"updateType",N.All);l(this,"globalTransform");l(this,"scaleRotateTransform");l(this,"localTransform");l(this,"renderCoords");l(this,"renderBound");l(this,"strictBound");l(this,"preloadBound");l(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1});l(this,"isRenderable",!1);l(this,"renderState",ue.Init);l(this,"worldAlpha",1);l(this,"premultipliedColorTl",0);l(this,"premultipliedColorTr",0);l(this,"premultipliedColorBl",0);l(this,"premultipliedColorBr",0);l(this,"calcZIndex",0);l(this,"onTextureLoaded",(e,s)=>{this.autosizeNode(s),this.stage.requestRender(),this.emit("loaded",{type:"texture",dimensions:s})});l(this,"onTextureFailed",(e,s)=>{this.emit("failed",{type:"texture",error:s})});l(this,"onTextureFreed",e=>{this.emit("freed",{type:"texture"})});this.stage=e,this.props={...s,parent:null},this.parent=s.parent,this.updateScaleRotateTransform()}loadTexture(e,s,i=null){this.props.texture&&this.unloadTexture();const{txManager:n}=this.stage,o=n.loadTexture(e,s,i);this.props.texture=o,this.props.textureOptions=i,this.setUpdateType(N.IsRenderable),queueMicrotask(()=>{o.state==="loaded"?this.onTextureLoaded(o,o.dimensions):o.state==="failed"?this.onTextureFailed(o,o.error):o.state==="freed"&&this.onTextureFreed(o),o.on("loaded",this.onTextureLoaded),o.on("failed",this.onTextureFailed),o.on("freed",this.onTextureFreed)})}unloadTexture(){if(this.props.texture){const{texture:e}=this.props;e.off("loaded",this.onTextureLoaded),e.off("failed",this.onTextureFailed),e.off("freed",this.onTextureFreed),e.setRenderableOwner(this,!1)}this.props.texture=null,this.props.textureOptions=null,this.setUpdateType(N.IsRenderable)}autosizeNode(e){this.autosize&&(this.width=e.width,this.height=e.height)}loadShader(e,s){const i=this.stage.renderer.getShaderManager();P(i);const{shader:n,props:o}=i.loadShader(e,s);this.props.shader=n,this.props.shaderProps=o,this.setUpdateType(N.IsRenderable)}setUpdateType(e){this.updateType|=e;const s=this.props.parent;s&&!(s.updateType&N.Children)&&s.setUpdateType(N.Children)}sortChildren(){this.children.sort((e,s)=>e.calcZIndex-s.calcZIndex)}updateScaleRotateTransform(){this.scaleRotateTransform=Ue.rotate(this.props.rotation,this.scaleRotateTransform).scale(this.props.scaleX,this.props.scaleY)}updateLocalTransform(){P(this.scaleRotateTransform);const e=this.props.pivotX*this.props.width,s=this.props.pivotY*this.props.height,i=this.props.mountX*this.props.width,n=this.props.mountY*this.props.height;this.localTransform=Ue.translate(e-i+this.props.x,s-n+this.props.y,this.localTransform).multiply(this.scaleRotateTransform).translate(-e,-s),this.setUpdateType(N.Global)}update(e,s){this.updateType&N.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(N.Local)),this.updateType&N.Local&&(this.updateLocalTransform(),this.setUpdateType(N.Global));const i=this.props.parent;let n=N.None;this.updateType&N.Global&&(P(this.localTransform),this.globalTransform=Ue.copy((i==null?void 0:i.globalTransform)||this.localTransform,this.globalTransform),i&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(N.Clipping|N.RenderState|N.Children),n|=N.Global),this.updateType&N.Clipping&&(this.calculateClippingRect(s),this.setUpdateType(N.Children),n|=N.Clipping),this.updateType&N.WorldAlpha&&(i?this.worldAlpha=i.worldAlpha*this.props.alpha:this.worldAlpha=this.props.alpha,this.setUpdateType(N.Children|N.PremultipliedColors|N.IsRenderable),n|=N.WorldAlpha),this.updateType&N.PremultipliedColors&&(this.premultipliedColorTl=Zt(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=Zt(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=Zt(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=Zt(this.props.colorBr,this.worldAlpha,!0))),this.updateType&N.RenderState&&(this.updateRenderState(s),this.setUpdateType(N.IsRenderable)),this.updateType&N.IsRenderable&&this.updateIsRenderable(),i&&this.updateType&N.CalculatedZIndex&&(this.calculateZIndex(),i.setUpdateType(N.ZIndexSortedChildren)),this.updateType&N.Children&&this.children.length&&this.children.forEach(o=>{o.setUpdateType(n),o.updateType!==0&&o.update(e,this.clippingRect)}),this.updateType&N.ZIndexSortedChildren&&this.sortChildren(),this.updateType=0}checkRenderProps(){return this.props.texture?!0:!this.props.width||!this.props.height?!1:!!(this.props.shader||this.props.clipping||this.props.color!==0||this.props.colorTop!==0||this.props.colorBottom!==0||this.props.colorLeft!==0||this.props.colorRight!==0||this.props.colorTl!==0||this.props.colorTr!==0||this.props.colorBl!==0||this.props.colorBr!==0)}checkRenderBounds(e){P(this.renderBound);const s=e.width||this.stage.root.width,i=e.height||this.stage.root.height;this.strictBound=ut(e.x,e.y,e.x+s,e.y+i,this.strictBound);const n=this.stage.boundsMargin;return this.preloadBound=ut(e.x-n[3],e.y-n[0],e.x+s+n[1],e.y+i+n[2],this.preloadBound),Ai(this.renderBound,this.strictBound)?ue.InViewport:Ai(this.renderBound,this.preloadBound)?ue.InBounds:ue.OutOfBounds}updateRenderState(e){const s=this.checkRenderBounds(e);if(s!==this.renderState){let i=this.renderState;this.renderState=s,i===ue.InViewport&&this.emit("outOfViewport",{previous:i,current:s}),i<ue.InBounds&&s===ue.InViewport?(this.emit(bt.get(ue.InBounds),{previous:i,current:s}),i=ue.InBounds):i>ue.InBounds&&s===ue.OutOfBounds&&(this.emit(bt.get(ue.InBounds),{previous:i,current:s}),i=ue.InBounds);const n=bt.get(s);P(n),this.emit(n,{previous:i,current:s})}}setRenderState(e){e!==this.renderState&&(this.renderState=e,this.emit(ue[e]))}updateIsRenderable(){let e;this.worldAlpha===0||!this.checkRenderProps()?e=!1:e=this.renderState>ue.OutOfBounds,this.isRenderable!==e&&(this.isRenderable=e,this.onChangeIsRenderable(e))}onChangeIsRenderable(e){var s;(s=this.props.texture)==null||s.setRenderableOwner(this,e)}calculateRenderCoords(){const{width:e,height:s,globalTransform:i}=this;P(i);const{tx:n,ty:o,ta:a,tb:c,tc:u,td:h}=i;if(c===0&&u===0){const d=n,x=n+e*a,g=o,_=o+s*h;this.renderCoords=Ks.translate(d,g,x,g,x,_,d,_,this.renderCoords)}else this.renderCoords=Ks.translate(n,o,n+e*a,o+e*u,n+e*a+s*c,o+e*u+s*h,n+s*c,o+s*h,this.renderCoords)}updateBoundingRect(){const{renderCoords:e,globalTransform:s}=this;P(s),P(e);const{tb:i,tc:n}=s,{x1:o,y1:a,x3:c,y3:u}=e;if(i===0||n===0)this.renderBound=ut(o,a,c,u,this.renderBound);else{const{x2:h,x4:d,y2:x,y4:g}=e;this.renderBound=ut(Math.min(o,h,c,d),Math.min(a,x,u,g),Math.max(o,h,c,d),Math.max(a,x,u,g),this.renderBound)}}calculateClippingRect(e){P(this.globalTransform);const{clippingRect:s,props:i,globalTransform:n}=this,{clipping:o}=i,a=n.tb!==0||n.tc!==0;o&&!a?(s.x=n.tx,s.y=n.ty,s.width=this.width*n.ta,s.height=this.height*n.td,s.valid=!0):s.valid=!1,e.valid&&s.valid?Qr(e,s,s):e.valid&&(Tn(e,s),s.valid=!0)}calculateZIndex(){var o,a;const e=this.props,s=e.zIndex||0,i=((o=e.parent)==null?void 0:o.zIndex)||0;let n=s;(a=e.parent)!=null&&a.zIndexLocked&&(n=s<i?s:i),this.calcZIndex=n}destroy(){this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,delete this.renderCoords,delete this.renderBound,delete this.strictBound,delete this.preloadBound,delete this.globalTransform,delete this.scaleRotateTransform,delete this.localTransform,this.props.texture=null,this.props.shader=null,this.removeAllListeners(),this.parent=null}renderQuads(e){const{width:s,height:i,texture:n,textureOptions:o,shader:a,shaderProps:c}=this.props,{premultipliedColorTl:u,premultipliedColorTr:h,premultipliedColorBl:d,premultipliedColorBr:x}=this,{zIndex:g,worldAlpha:_,globalTransform:m,clippingRect:v}=this;P(m),e.addQuad({width:s,height:i,colorTl:u,colorTr:h,colorBl:d,colorBr:x,texture:n,textureOptions:o,zIndex:g,shader:a,shaderProps:c,alpha:_,clippingRect:v,tx:m.tx,ty:m.ty,ta:m.ta,tb:m.tb,tc:m.tc,td:m.td})}get id(){return this.props.id}get x(){return this.props.x}set x(e){this.props.x!==e&&(this.props.x=e,this.setUpdateType(N.Local))}get absX(){var e,s,i;return this.props.x+(((e=this.props.parent)==null?void 0:e.absX)||((i=(s=this.props.parent)==null?void 0:s.globalTransform)==null?void 0:i.tx)||0)}get absY(){var e;return this.props.y+(((e=this.props.parent)==null?void 0:e.absY)??0)}get y(){return this.props.y}set y(e){this.props.y!==e&&(this.props.y=e,this.setUpdateType(N.Local))}get width(){return this.props.width}set width(e){this.props.width!==e&&(this.props.width=e,this.setUpdateType(N.Local))}get height(){return this.props.height}set height(e){this.props.height!==e&&(this.props.height=e,this.setUpdateType(N.Local))}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e}get scaleX(){return this.props.scaleX}set scaleX(e){this.props.scaleX!==e&&(this.props.scaleX=e,this.setUpdateType(N.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(e){this.props.scaleY!==e&&(this.props.scaleY=e,this.setUpdateType(N.ScaleRotate))}get mount(){return this.props.mount}set mount(e){(this.props.mountX!==e||this.props.mountY!==e)&&(this.props.mountX=e,this.props.mountY=e,this.props.mount=e,this.setUpdateType(N.Local))}get mountX(){return this.props.mountX}set mountX(e){this.props.mountX!==e&&(this.props.mountX=e,this.setUpdateType(N.Local))}get mountY(){return this.props.mountY}set mountY(e){this.props.mountY!==e&&(this.props.mountY=e,this.setUpdateType(N.Local))}get pivot(){return this.props.pivot}set pivot(e){(this.props.pivotX!==e||this.props.pivotY!==e)&&(this.props.pivotX=e,this.props.pivotY=e,this.props.pivot=e,this.setUpdateType(N.Local))}get pivotX(){return this.props.pivotX}set pivotX(e){this.props.pivotX!==e&&(this.props.pivotX=e,this.setUpdateType(N.Local))}get pivotY(){return this.props.pivotY}set pivotY(e){this.props.pivotY!==e&&(this.props.pivotY=e,this.setUpdateType(N.Local))}get rotation(){return this.props.rotation}set rotation(e){this.props.rotation!==e&&(this.props.rotation=e,this.setUpdateType(N.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(e){this.props.alpha=e,this.setUpdateType(N.PremultipliedColors|N.WorldAlpha)}get autosize(){return this.props.autosize}set autosize(e){this.props.autosize=e}get clipping(){return this.props.clipping}set clipping(e){this.props.clipping=e,this.setUpdateType(N.Clipping)}get color(){return this.props.color}set color(e){(this.props.colorTl!==e||this.props.colorTr!==e||this.props.colorBl!==e||this.props.colorBr!==e)&&(this.colorTl=e,this.colorTr=e,this.colorBl=e,this.colorBr=e),this.props.color=e,this.setUpdateType(N.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(e){(this.props.colorTl!==e||this.props.colorTr!==e)&&(this.colorTl=e,this.colorTr=e),this.props.colorTop=e,this.setUpdateType(N.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(e){(this.props.colorBl!==e||this.props.colorBr!==e)&&(this.colorBl=e,this.colorBr=e),this.props.colorBottom=e,this.setUpdateType(N.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(e){(this.props.colorTl!==e||this.props.colorBl!==e)&&(this.colorTl=e,this.colorBl=e),this.props.colorLeft=e,this.setUpdateType(N.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(e){(this.props.colorTr!==e||this.props.colorBr!==e)&&(this.colorTr=e,this.colorBr=e),this.props.colorRight=e,this.setUpdateType(N.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(e){this.props.colorTl=e,this.setUpdateType(N.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(e){this.props.colorTr=e,this.setUpdateType(N.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(e){this.props.colorBl=e,this.setUpdateType(N.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(e){this.props.colorBr=e,this.setUpdateType(N.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(e){this.props.zIndexLocked=e,this.setUpdateType(N.CalculatedZIndex|N.Children),this.children.forEach(s=>{s.setUpdateType(N.CalculatedZIndex)})}get zIndex(){return this.props.zIndex}set zIndex(e){this.props.zIndex=e,this.setUpdateType(N.CalculatedZIndex|N.Children),this.children.forEach(s=>{s.setUpdateType(N.CalculatedZIndex)})}get parent(){return this.props.parent}set parent(e){const s=this.props.parent;if(s!==e){if(this.props.parent=e,s){const i=s.children.indexOf(this);P(i!==-1,"CoreNode.parent: Node not found in old parent's children!"),s.children.splice(i,1),s.setUpdateType(N.Children|N.ZIndexSortedChildren)}e&&(e.children.push(this),this.setUpdateType(N.All),e.setUpdateType(N.Children|N.ZIndexSortedChildren)),this.updateScaleRotateTransform()}}}let Ka=1;function ti(){return Ka++}class Fr extends it{constructor(e,s,i,n){super();l(this,"rendererMain");l(this,"stage");l(this,"id");l(this,"coreNode");l(this,"_children",[]);l(this,"_src","");l(this,"_parent",null);l(this,"_texture",null);l(this,"_shader",null);l(this,"_data",{});l(this,"onTextureLoaded",(e,s)=>{this.emit("loaded",s)});l(this,"onTextureFailed",(e,s)=>{this.emit("failed",s)});l(this,"onTextureFreed",(e,s)=>{this.emit("freed",s)});l(this,"onOutOfBounds",(e,s)=>{this.emit("outOfBounds",s)});l(this,"onInBounds",(e,s)=>{this.emit("inBounds",s)});l(this,"onOutOfViewport",(e,s)=>{this.emit("outOfViewport",s)});l(this,"onInViewport",(e,s)=>{this.emit("inViewport",s)});this.rendererMain=s,this.stage=i,this.id=(n==null?void 0:n.id)??ti(),this.coreNode=n||new ei(this.stage,{id:this.id,x:e.x,y:e.y,width:e.width,height:e.height,alpha:e.alpha,autosize:e.autosize,clipping:e.clipping,color:e.color,colorTop:e.colorTop,colorBottom:e.colorBottom,colorLeft:e.colorLeft,colorRight:e.colorRight,colorTl:e.colorTl,colorTr:e.colorTr,colorBl:e.colorBl,colorBr:e.colorBr,zIndex:e.zIndex,zIndexLocked:e.zIndexLocked,scaleX:e.scaleX,scaleY:e.scaleY,mountX:e.mountX,mountY:e.mountY,mount:e.mount,pivot:e.pivot,pivotX:e.pivotX,pivotY:e.pivotY,rotation:e.rotation,parent:null,shader:null,shaderProps:null,texture:null,textureOptions:null}),this.coreNode.on("loaded",this.onTextureLoaded),this.coreNode.on("failed",this.onTextureFailed),this.coreNode.on("freed",this.onTextureFreed),this.coreNode.on("outOfBounds",this.onOutOfBounds),this.coreNode.on("inBounds",this.onInBounds),this.coreNode.on("outOfViewport",this.onOutOfViewport),this.coreNode.on("inViewport",this.onInViewport),this.parent=e.parent,this.shader=e.shader,this.texture=e.texture,this.src=e.src,this._data=e.data}get x(){return this.coreNode.x}set x(e){this.coreNode.x=e}get y(){return this.coreNode.y}set y(e){this.coreNode.y=e}get width(){return this.coreNode.width}set width(e){this.coreNode.width=e}get height(){return this.coreNode.height}set height(e){this.coreNode.height=e}get alpha(){return this.coreNode.alpha}set alpha(e){this.coreNode.alpha=e}get autosize(){return this.coreNode.autosize}set autosize(e){this.coreNode.autosize=e}get clipping(){return this.coreNode.clipping}set clipping(e){this.coreNode.clipping=e}get color(){return this.coreNode.color}set color(e){this.coreNode.color=e}get colorTop(){return this.coreNode.colorTop}set colorTop(e){this.coreNode.colorTop=e}get colorBottom(){return this.coreNode.colorBottom}set colorBottom(e){this.coreNode.colorBottom=e}get colorLeft(){return this.coreNode.colorLeft}set colorLeft(e){this.coreNode.colorLeft=e}get colorRight(){return this.coreNode.colorRight}set colorRight(e){this.coreNode.colorRight=e}get colorTl(){return this.coreNode.colorTl}set colorTl(e){this.coreNode.colorTl=e}get colorTr(){return this.coreNode.colorTr}set colorTr(e){this.coreNode.colorTr=e}get colorBl(){return this.coreNode.colorBl}set colorBl(e){this.coreNode.colorBl=e}get colorBr(){return this.coreNode.colorBr}set colorBr(e){this.coreNode.colorBr=e}get scale(){return this.scaleX!==this.scaleY?null:this.coreNode.scaleX}set scale(e){e!==null&&(this.coreNode.scaleX=e,this.coreNode.scaleY=e)}get scaleX(){return this.coreNode.scaleX}set scaleX(e){this.coreNode.scaleX=e}get scaleY(){return this.coreNode.scaleY}set scaleY(e){this.coreNode.scaleY=e}get mount(){return this.coreNode.mount}set mount(e){this.coreNode.mount=e}get mountX(){return this.coreNode.mountX}set mountX(e){this.coreNode.mountX=e}get mountY(){return this.coreNode.mountY}set mountY(e){this.coreNode.mountY=e}get pivot(){return this.coreNode.pivot}set pivot(e){this.coreNode.pivot=e}get pivotX(){return this.coreNode.pivotX}set pivotX(e){this.coreNode.pivotX=e}get pivotY(){return this.coreNode.pivotY}set pivotY(e){this.coreNode.pivotY=e}get rotation(){return this.coreNode.rotation}set rotation(e){this.coreNode.rotation=e}get parent(){return this._parent}set parent(e){const s=this._parent;if(this._parent=e,this.coreNode.parent=(e==null?void 0:e.coreNode)??null,s){const i=s.children.indexOf(this);P(i!==-1,"MainOnlyNode.parent: Node not found in old parent's children!"),s.children.splice(i,1)}e&&e.children.push(this)}get children(){return this._children}get zIndex(){return this.coreNode.zIndex}set zIndex(e){this.coreNode.zIndex=e}get zIndexLocked(){return this.coreNode.zIndexLocked}set zIndexLocked(e){this.coreNode.zIndexLocked=e}get src(){return this._src}set src(e){if(this._src!==e){if(this._src=e,!e){this.texture=null;return}this.texture=this.rendererMain.createTexture("ImageTexture",{src:e})}}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this.rendererMain.textureTracker.decrementTextureRefCount(this._texture),e&&this.rendererMain.textureTracker.incrementTextureRefCount(e),this._texture=e,e?this.coreNode.loadTexture(e.txType,e.props,e.options):this.coreNode.unloadTexture())}get shader(){return this._shader}set shader(e){this._shader!==e&&(this._shader=e,e&&this.coreNode.loadShader(e.shType,e.props))}get data(){return this._data}set data(e){this._data=Nn(e)}destroy(){this.emit("beforeDestroy",{});let e=this.children[0];for(;e;)e.destroy(),e=this.children[0];this.coreNode.destroy(),this.parent=null,this.texture=null,this.emit("afterDestroy",{}),this.removeAllListeners()}flush(){}animate(e,s){const i=new Ga(this.coreNode,e,s);return new Va(this.stage.animationManager,i)}}const qa=r=>{let t=!1;const e=()=>{if(r.updateAnimations(),!r.hasSceneUpdates()){r.calculateFps(),setTimeout(e,16.666666666666668),t||(r.emit("idle"),t=!0);return}t=!1,r.drawFrame(),requestAnimationFrame(e)};requestAnimationFrame(e)},Qa=()=>performance?performance.now():Date.now();class Za{constructor(){l(this,"activeAnimations",new Set)}registerAnimation(t){this.activeAnimations.add(t)}unregisterAnimation(t){this.activeAnimations.delete(t)}update(t){this.activeAnimations.forEach(e=>{e.update(t)})}}class Ja{constructor(t){l(this,"imageWorkersEnabled",!0);l(this,"messageManager",{});l(this,"workers",[]);l(this,"workerIndex",0);this.workers=this.createWorkers(t),this.workers.forEach(e=>{e.onmessage=this.handleMessage.bind(this)})}handleMessage(t){const{src:e,data:s,error:i}=t.data,n=this.messageManager[e];if(n){const[o,a]=n;delete this.messageManager[e],i?a(new Error(i)):o(s)}}createWorkers(t=1){const e=`
      function hasAlphaChannel(mimeType) {
          return (mimeType.indexOf("image/png") !== -1);
      }

      function getImage(src, premultiplyAlpha) {
        return new Promise(function(resolve, reject) {
          var xhr = new XMLHttpRequest();
          xhr.open('GET', src, true);
          xhr.responseType = 'blob';

          xhr.onload = function() {
            if (xhr.status === 200) {
              var blob = xhr.response;
              var hasAlphaChannel = premultiplyAlpha !== undefined ? premultiplyAlpha : hasAlphaChannel(blob.type);

              createImageBitmap(blob, {
                premultiplyAlpha: hasAlphaChannel ? 'premultiply' : 'none',
                colorSpaceConversion: 'none',
                imageOrientation: 'none'
              }).then(function(data) {
                resolve({ data: data, premultiplyAlpha: premultiplyAlpha });
              }).catch(function(error) {
                reject(error);
              });
            } else {
              reject(new Error('Failed to load image: ' + xhr.statusText));
            }
          };

          xhr.onerror = function() {
            reject(new Error('Network error occurred while trying to fetch the image.'));
          };

          xhr.send();
        });
      }

      self.onmessage = (event) => {
        var src = event.data.src;
        var premultiplyAlpha = event.data.premultiplyAlpha;

        getImage(src, premultiplyAlpha)
          .then(function(data) {
              self.postMessage({ src: src, data: data }, [data.data]);
          })
          .catch(function(error) {
              self.postMessage({ src: src, error: error.message });
          });
      };
    `,s=new Blob([e.replace('"use strict";',"")],{type:"application/javascript"}),i=(self.URL?URL:webkitURL).createObjectURL(s),n=[];for(let o=0;o<t;o++)n.push(new Worker(i));return n}getNextWorker(){const t=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,t}convertUrlToAbsolute(t){return new URL(t,self.location.href).href}getImage(t,e){return new Promise((s,i)=>{try{if(this.workers){const n=this.convertUrlToAbsolute(t);this.messageManager[n]=[s,i],this.getNextWorker().postMessage({src:n,premultiplyAlpha:e})}}catch(n){i(n)}})}}const ds=class ds extends vs{constructor(e,s){super(e);l(this,"props");this.props=ds.resolveDefaults(s)}async getTextureData(){const{width:e,height:s}=this.props,i=e*s*4,n=new Uint8ClampedArray(i);for(let o=0;o<i;o+=4){const a=Math.floor(Math.random()*256);n[o]=a,n[o+1]=a,n[o+2]=a,n[o+3]=255}return{data:new ImageData(n,e,s)}}static makeCacheKey(e){const s=ds.resolveDefaults(e);return`NoiseTexture,${s.width},${s.height},${s.cacheId}`}static resolveDefaults(e){return{width:e.width??128,height:e.height??128,cacheId:e.cacheId??0}}};l(ds,"z$__type__Props");let Br=ds;class el{constructor(t){l(this,"usedMemory",0);l(this,"txConstructors",{});l(this,"textureKeyCache",new Map);l(this,"textureIdCache",new Map);l(this,"ctxTextureCache",new WeakMap);l(this,"textureRefCountMap",new WeakMap);l(this,"imageWorkerManager",null);l(this,"hasCreateImageBitmap",!!self.createImageBitmap);l(this,"hasWorker",!!self.Worker);l(this,"renderer");this.hasCreateImageBitmap&&this.hasWorker&&(this.imageWorkerManager=new Ja(t)),this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.registerTextureType("ImageTexture",Or),this.registerTextureType("ColorTexture",js),this.registerTextureType("NoiseTexture",Br),this.registerTextureType("SubTexture",Gt)}registerTextureType(t,e){this.txConstructors[t]=e}loadTexture(t,e,s=null){const i=this.txConstructors[t];if(!i)throw new Error(`Texture type "${t}" is not registered`);let n;if((s==null?void 0:s.id)!==void 0&&this.textureIdCache.has(s.id)&&(n=this.textureIdCache.get(s.id)),!n){const o=s==null?void 0:s.id,a=(s==null?void 0:s.cacheKey)??i.makeCacheKey(e);a&&this.textureKeyCache.has(a)?n=this.textureKeyCache.get(a):n=new i(this,e),o&&this.addTextureIdToCache(o,a,n)}return s!=null&&s.preload&&this.getCtxTexture(n).load(),n}addTextureIdToCache(t,e,s){const{textureIdCache:i,textureRefCountMap:n}=this;i.set(t,s),n.has(s)?n.get(s).count++:(n.set(s,{cacheKey:e,count:1}),e&&this.textureKeyCache.set(e,s))}removeTextureIdFromCache(t){var n;const{textureIdCache:e,textureRefCountMap:s}=this,i=e.get(t);if(i){if(e.delete(t),s.has(i)){const o=s.get(i);P(o),o.count--,o.count===0&&(s.delete(i),o.cacheKey&&this.textureKeyCache.delete(o.cacheKey))}(n=this.ctxTextureCache.get(i))==null||n.free()}}getDebugInfo(){return{keyCacheSize:this.textureKeyCache.size,idCacheSize:this.textureIdCache.size}}getCtxTexture(t){if(this.ctxTextureCache.has(t))return this.ctxTextureCache.get(t);const e=this.renderer.createCtxTexture(t);return this.ctxTextureCache.set(t,e),e}}class tl{constructor(){l(this,"data",{})}reset(){this.data={}}increment(t){this.data[t]||(this.data[t]=0),this.data[t]++}getData(){return{...this.data}}}class sl{constructor(t){l(this,"memUsed",0);l(this,"textures",new Map);l(this,"threshold");this.threshold=t,t===0&&(this.setTextureMemUse=()=>{})}setTextureMemUse(t,e){if(this.textures.has(t)&&(this.memUsed-=this.textures.get(t)),e===0){this.textures.delete(t);return}else this.memUsed+=e,this.textures.set(t,e);this.memUsed>this.threshold&&this.gc()}gc(){this.textures.forEach((t,e)=>{e.renderable||e.free()})}}const rl={isWhite:!0,a:1,r:255,g:255,b:255};function gr(r){if(r===4294967295)return rl;const t=(r>>>24&255)/255,e=r>>>16&255&255,s=r>>>8&255&255,i=r&255&255;return{isWhite:!1,a:t,r:i,g:s,b:e}}function Ws({a:r,r:t,g:e,b:s}){return`rgba(${t},${e},${s},${r})`}class il extends Sn{constructor(){super(...arguments);l(this,"image");l(this,"tintCache")}load(){this.textureSource.state==="freed"&&(this.textureSource.setState("loading"),this.onLoadRequest().then(e=>{this.textureSource.setState("loaded",e),this.updateMemSize()}).catch(e=>{this.textureSource.setState("failed",e)}))}free(){this.image=void 0,this.tintCache=void 0,this.textureSource.setState("freed"),this.memManager.setTextureMemUse(this,0)}updateMemSize(){const e=this.tintCache?8:4;if(this.textureSource.dimensions){const{width:s,height:i}=this.textureSource.dimensions;this.memManager.setTextureMemUse(this,s*i*e)}}hasImage(){return this.image!==void 0}getImage(e){var o;const s=this.image;if(P(s,"Attempt to get unloaded image texture"),e.isWhite)return this.tintCache&&(this.tintCache=void 0,this.updateMemSize()),s;const i=Ws(e);if(((o=this.tintCache)==null?void 0:o.key)===i)return this.tintCache.image;const n=this.tintTexture(s,i);return this.tintCache={key:i,image:n},this.updateMemSize(),n}tintTexture(e,s){const{width:i,height:n}=e,o=document.createElement("canvas");o.width=i,o.height=n;const a=o.getContext("2d");return a&&(a.fillStyle=s,a.globalCompositeOperation="copy",a.fillRect(0,0,i,n),a.globalCompositeOperation="multiply",a.drawImage(e,0,0,i,n,0,0,i,n),a.globalCompositeOperation="destination-in",a.drawImage(e,0,0,i,n,0,0,i,n)),o}get renderable(){return this.textureSource.renderable}async onLoadRequest(){const{data:e}=await this.textureSource.getTextureData();if(e instanceof ImageData){const s=document.createElement("canvas");s.width=e.width,s.height=e.height;const i=s.getContext("2d");return i&&i.putImageData(e,0,0),this.image=s,{width:e.width,height:e.height}}else if(e instanceof ImageBitmap)return this.image=e,{width:e.width,height:e.height};return{width:0,height:0}}}function nl(r){var t;return r.shader instanceof An&&r.shader.shType===In?((t=r.shaderProps)==null?void 0:t.radius)??0:0}class ol extends bn{constructor(e){super(e);l(this,"context");l(this,"canvas");l(this,"pixelRatio");l(this,"clearColor");this.mode="canvas",this.shManager.renderer=this;const{canvas:s,pixelRatio:i,clearColor:n}=e;this.canvas=s,this.context=s.getContext("2d"),this.pixelRatio=i,this.clearColor=n?ta(n):void 0}reset(){this.canvas.width=this.canvas.width;const e=this.context;if(this.clearColor){const[s,i,n,o]=this.clearColor;e.fillStyle=`rgba(${s}, ${i}, ${n}, ${o/255})`,e.fillRect(0,0,this.canvas.width,this.canvas.height)}e.scale(this.pixelRatio,this.pixelRatio)}render(){}addQuad(e){const s=this.context,{tx:i,ty:n,width:o,height:a,alpha:c,colorTl:u,colorTr:h,colorBr:d,ta:x,tb:g,tc:_,td:m,clippingRect:v}=e;let T=e.texture,O,R;if(T){if(T instanceof Gt&&(R=T.props,T=T.parentTexture),O=this.txManager.getCtxTexture(T),T.state==="freed"){O.load();return}if(T.state!=="loaded"||!O.hasImage())return}const E=gr(u),F=x!==1,B=v.width!==0&&v.height!==0,w=u!==h||u!==d,D=e.shader?nl(e):0;if((F||B||D)&&s.save(),B){const k=new Path2D,{x:Y,y:X,width:ee,height:J}=v;k.rect(Y,X,ee,J),s.clip(k)}if(F){const k=this.pixelRatio;s.setTransform(x,_,g,m,i*k,n*k),s.scale(k,k),s.translate(-i,-n)}if(D){const k=new Path2D;k.roundRect(i,n,o,a,D),s.clip(k)}if(O){const k=O.getImage(E);s.globalAlpha=c,R?s.drawImage(k,R.x,R.y,R.width,R.height,i,n,o,a):s.drawImage(k,i,n,o,a),s.globalAlpha=1}else if(w){let k=i,Y=n,X;u===h?(k=i,Y=n+a,X=gr(d)):(k=i+o,Y=n,X=gr(h));const ee=s.createLinearGradient(i,n,k,Y);ee.addColorStop(0,Ws(E)),ee.addColorStop(1,Ws(X)),s.fillStyle=ee,s.fillRect(i,n,o,a)}else s.fillStyle=Ws(E),s.fillRect(i,n,o,a);(F||B||D)&&s.restore()}createCtxTexture(e){return new il(this.txMemManager,e)}getShaderManager(){return this.shManager}}const al=2e6;class ll extends it{constructor(e){super();l(this,"options");l(this,"animationManager");l(this,"txManager");l(this,"txMemManager");l(this,"fontManager");l(this,"textRenderers");l(this,"shManager");l(this,"renderer");l(this,"root");l(this,"boundsMargin");l(this,"deltaTime",0);l(this,"lastFrameTime",0);l(this,"currentFrameTime",0);l(this,"fpsNumFrames",0);l(this,"fpsElapsedTime",0);l(this,"renderRequested",!1);l(this,"contextSpy",null);this.options=e;const{canvas:s,clearColor:i,rootId:n,debug:o,appWidth:a,appHeight:c,boundsMargin:u,enableContextSpy:h,numImageWorkers:d,txMemByteThreshold:x,renderMode:g}=e;this.txManager=new el(d),this.txMemManager=new sl(x),this.shManager=new ya,this.animationManager=new Za,this.contextSpy=h?new tl:null;let _=[0,0,0,0];u&&(_=Array.isArray(u)?u:[u,u,u,u]),this.boundsMargin=_,o!=null&&o.monitorTextureCache&&setInterval(()=>{P(this.txManager);const T=this.txManager.getDebugInfo();console.log("Texture ID Cache Size: ",T.idCacheSize),console.log("Texture Key Cache Size: ",T.keyCacheSize)},1e3);const m={stage:this,canvas:s,pixelRatio:e.devicePhysicalPixelRatio*e.deviceLogicalPixelRatio,clearColor:i??4278190080,bufferMemory:al,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy};g==="canvas"?this.renderer=new ol(m):this.renderer=new Jr(m),Yo(g),this.txManager.renderer=this.renderer,this.textRenderers=g==="webgl"?{canvas:new Fi(this),sdf:new $a(this)}:{canvas:new Fi(this)},this.fontManager=new Ln(this.textRenderers);const v=new ei(this,{id:n,x:0,y:0,width:a,height:c,alpha:1,autosize:!1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null});this.root=v,qa(this)}updateAnimations(){const{animationManager:e}=this;this.root&&(this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=Qa(),this.deltaTime=this.lastFrameTime?this.currentFrameTime-this.lastFrameTime:100/6,this.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime}),e.update(this.deltaTime))}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested}drawFrame(){const{renderer:e,renderRequested:s}=this;this.root.updateType!==0&&this.root.update(this.deltaTime,this.root.clippingRect),e==null||e.reset(),this.addQuads(this.root),e==null||e.render(),this.calculateFps(),s&&(this.renderRequested=!1)}calculateFps(){var s,i;const{fpsUpdateInterval:e}=this.options;if(e&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=e)){const n=Math.round(this.fpsNumFrames*1e3/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.emit("fpsUpdate",{fps:n,contextSpyData:((s=this.contextSpy)==null?void 0:s.getData())??null}),(i=this.contextSpy)==null||i.reset()}}addQuads(e){P(this.renderer&&e.globalTransform),e.isRenderable&&e.renderQuads(this.renderer);for(let s=0;s<e.children.length;s++){const i=e.children[s];i&&(i==null?void 0:i.worldAlpha)!==0&&this.addQuads(i)}}requestRender(){this.renderRequested=!0}resolveTextRenderer(e,s=null){let i=s,n=!1;if(i){const a=this.textRenderers[i];a?a.canRenderFont(e)||(console.warn(`Cannot use override text renderer '${i}' for font`,e),i=null,n=!0):(console.warn(`Text renderer override '${i}' not found.`),i=null,n=!0)}if(!i){for(const[a,c]of Object.entries(this.textRenderers))if(a!=="canvas"&&c.canRenderFont(e)){i=a;break}i||(i="canvas")}n&&console.warn(`Falling back to text renderer ${String(i)}`);const o=this.textRenderers[i];return P(o,"resolvedTextRenderer undefined"),o}}class cl extends ei{constructor(e,s){super(e,s);l(this,"textRenderer");l(this,"trState");l(this,"_textRendererOverride",null);l(this,"onTextLoaded",()=>{const{contain:e}=this,s=this.trState.props.width,i=this.trState.props.height,n=this.trState.textW||0,o=this.trState.textH||0;e==="both"?(this.props.width=s,this.props.height=i):e==="width"?(this.props.width=s,this.props.height=o):e==="none"&&(this.props.width=n,this.props.height=o),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});l(this,"onTextFailed",(e,s)=>{this.emit("failed",{type:"text",error:s})});this._textRendererOverride=s.textRendererOverride;const{resolvedTextRenderer:i,textRendererState:n}=this.resolveTextRendererAndState({x:this.absX,y:this.absY,width:s.width,height:s.height,textAlign:s.textAlign,color:s.color,zIndex:s.zIndex,contain:s.contain,scrollable:s.scrollable,scrollY:s.scrollY,offsetY:s.offsetY,letterSpacing:s.letterSpacing,debug:s.debug,fontFamily:s.fontFamily,fontSize:s.fontSize,fontStretch:s.fontStretch,fontStyle:s.fontStyle,fontWeight:s.fontWeight,text:s.text,lineHeight:s.lineHeight,maxLines:s.maxLines,textBaseline:s.textBaseline,verticalAlign:s.verticalAlign,overflowSuffix:s.overflowSuffix});this.textRenderer=i,this.trState=n}get width(){return this.props.width}set width(e){this.props.width=e,this.textRenderer.set.width(this.trState,e),this.contain==="none"&&this.setUpdateType(N.Local)}get height(){return this.props.height}set height(e){this.props.height=e,this.textRenderer.set.height(this.trState,e),this.contain!=="both"&&this.setUpdateType(N.Local)}get color(){return this.trState.props.color}set color(e){this.textRenderer.set.color(this.trState,e)}get text(){return this.trState.props.text}set text(e){this.textRenderer.set.text(this.trState,e)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(e){this._textRendererOverride=e,this.textRenderer.destroyState(this.trState);const{resolvedTextRenderer:s,textRendererState:i}=this.resolveTextRendererAndState(this.trState.props);this.textRenderer=s,this.trState=i}get fontSize(){return this.trState.props.fontSize}set fontSize(e){this.textRenderer.set.fontSize(this.trState,e)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(e){this.textRenderer.set.fontFamily(this.trState,e)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(e){this.textRenderer.set.fontStretch(this.trState,e)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(e){this.textRenderer.set.fontStyle(this.trState,e)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(e){this.textRenderer.set.fontWeight(this.trState,e)}get textAlign(){return this.trState.props.textAlign}set textAlign(e){this.textRenderer.set.textAlign(this.trState,e)}get contain(){return this.trState.props.contain}set contain(e){this.textRenderer.set.contain(this.trState,e)}get scrollable(){return this.trState.props.scrollable}set scrollable(e){this.textRenderer.set.scrollable(this.trState,e)}get scrollY(){return this.trState.props.scrollY}set scrollY(e){this.textRenderer.set.scrollY(this.trState,e)}get offsetY(){return this.trState.props.offsetY}set offsetY(e){this.textRenderer.set.offsetY(this.trState,e)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(e){this.textRenderer.set.letterSpacing(this.trState,e)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(e){this.textRenderer.set.lineHeight&&this.textRenderer.set.lineHeight(this.trState,e)}get maxLines(){return this.trState.props.maxLines}set maxLines(e){this.textRenderer.set.maxLines&&this.textRenderer.set.maxLines(this.trState,e)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(e){this.textRenderer.set.textBaseline&&this.textRenderer.set.textBaseline(this.trState,e)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(e){this.textRenderer.set.verticalAlign&&this.textRenderer.set.verticalAlign(this.trState,e)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(e){this.textRenderer.set.overflowSuffix&&this.textRenderer.set.overflowSuffix(this.trState,e)}get debug(){return this.trState.props.debug}set debug(e){this.textRenderer.set.debug(this.trState,e)}update(e,s){super.update(e,s),P(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkRenderProps(){return this.trState.props.text!==""?!0:super.checkRenderProps()}onChangeIsRenderable(e){super.onChangeIsRenderable(e),this.textRenderer.setIsRenderable(this.trState,e)}renderQuads(e){P(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha)}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}resolveTextRendererAndState(e){const s=this.stage.resolveTextRenderer(e,this._textRendererOverride),i=s.createState(e);return i.emitter.on("loaded",this.onTextLoaded),i.emitter.on("failed",this.onTextFailed),s.scheduleUpdateState(i),{resolvedTextRenderer:s,textRendererState:i}}}class hl extends Fr{constructor(t,e,s){super(t,e,s,new cl(s,{id:ti(),x:t.x,y:t.y,width:t.width,height:t.height,alpha:t.alpha,autosize:t.autosize,clipping:t.clipping,color:t.color,colorTop:t.colorTop,colorBottom:t.colorBottom,colorLeft:t.colorLeft,colorRight:t.colorRight,colorTl:t.colorTl,colorTr:t.colorTr,colorBl:t.colorBl,colorBr:t.colorBr,zIndex:t.zIndex,zIndexLocked:t.zIndexLocked,scaleX:t.scaleX,scaleY:t.scaleY,mountX:t.mountX,mountY:t.mountY,mount:t.mount,pivot:t.pivot,pivotX:t.pivotX,pivotY:t.pivotY,rotation:t.rotation,text:t.text,fontSize:t.fontSize,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontStretch:t.fontStretch,fontStyle:t.fontStyle,contain:t.contain,scrollable:t.scrollable,letterSpacing:t.letterSpacing,textAlign:t.textAlign,scrollY:t.scrollY,offsetY:t.offsetY,textRendererOverride:t.textRendererOverride,lineHeight:t.lineHeight,maxLines:t.maxLines,textBaseline:t.textBaseline,verticalAlign:t.verticalAlign,overflowSuffix:t.overflowSuffix,debug:t.debug,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null}))}get text(){return this.coreNode.text}set text(t){this.coreNode.text=t}get textRendererOverride(){return this.coreNode.textRendererOverride}set textRendererOverride(t){this.coreNode.textRendererOverride=t}get fontSize(){return this.coreNode.fontSize}set fontSize(t){this.coreNode.fontSize=t}get fontFamily(){return this.coreNode.fontFamily}set fontFamily(t){this.coreNode.fontFamily=t}get fontWeight(){return this.coreNode.fontWeight}set fontWeight(t){this.coreNode.fontWeight=t}get fontStretch(){return this.coreNode.fontStretch}set fontStretch(t){this.coreNode.fontStretch=t}get fontStyle(){return this.coreNode.fontStyle}set fontStyle(t){this.coreNode.fontStyle=t}get textAlign(){return this.coreNode.textAlign}set textAlign(t){this.coreNode.textAlign=t}get contain(){return this.coreNode.contain}set contain(t){this.coreNode.contain=t}get scrollable(){return this.coreNode.scrollable}set scrollable(t){this.coreNode.scrollable=t}get scrollY(){return this.coreNode.scrollY}set scrollY(t){this.coreNode.scrollY=t}get offsetY(){return this.coreNode.offsetY}set offsetY(t){this.coreNode.offsetY=t}get letterSpacing(){return this.coreNode.letterSpacing}set letterSpacing(t){this.coreNode.letterSpacing=t}get lineHeight(){return this.coreNode.lineHeight}set lineHeight(t){t&&(this.coreNode.lineHeight=t)}get maxLines(){return this.coreNode.maxLines}set maxLines(t){t&&(this.coreNode.maxLines=t)}get textBaseline(){return this.coreNode.textBaseline}set textBaseline(t){t&&(this.coreNode.textBaseline=t)}get verticalAlign(){return this.coreNode.verticalAlign}set verticalAlign(t){t&&(this.coreNode.verticalAlign=t)}get overflowSuffix(){return this.coreNode.overflowSuffix}set overflowSuffix(t){t&&(this.coreNode.overflowSuffix=t)}get debug(){return this.coreNode.debug}set debug(t){this.coreNode.debug=t}}class ul{constructor(){l(this,"root",null);l(this,"stage",null);l(this,"rendererMain",null)}async init(t,e,s){this.stage=new ll({rootId:ti(),appWidth:e.appWidth,appHeight:e.appHeight,txMemByteThreshold:e.txMemByteThreshold,boundsMargin:e.boundsMargin,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio,clearColor:e.clearColor,canvas:s,fpsUpdateInterval:e.fpsUpdateInterval,enableContextSpy:e.enableContextSpy,numImageWorkers:e.numImageWorkers,renderMode:e.renderMode,debug:{monitorTextureCache:!1}}),this.rendererMain=t,P(this.stage.root);const i=new Fr(t.resolveNodeDefaults({}),this.rendererMain,this.stage,this.stage.root);this.root=i,i.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,i)),this.onCreateNode(i),e.coreExtensionModule&&await Ya(e.coreExtensionModule,this.stage),this.stage.on("fpsUpdate",(n,o)=>{this.onFpsUpdate(o)}),this.stage.on("frameTick",(n,o)=>{this.onFrameTick(o)}),this.stage.on("idle",()=>{this.onIdle()})}createNode(t){P(this.rendererMain),P(this.stage);const e=new Fr(t,this.rendererMain,this.stage);return e.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,e)),this.onCreateNode(e),e}createTextNode(t){P(this.rendererMain),P(this.stage);const e=new hl(t,this.rendererMain,this.stage);return e.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,e)),this.onCreateNode(e),e}destroyNode(t){t.destroy()}releaseTexture(t){const{stage:e}=this;P(e),e.txManager.removeTextureIdFromCache(t)}getRootNode(){return P(this.root),this.root}onCreateNode(t){throw new Error("Method not implemented.")}onBeforeDestroyNode(t){throw new Error("Method not implemented.")}onFpsUpdate(t){throw new Error("Method not implemented.")}onFrameTick(t){throw new Error("Method not implemented.")}onIdle(){throw new Error("Method not implemented.")}}let $t,si;function dl(r={},t="app"){const e=new ul;return $t=new Ha(r,t,e),si=$t.createShader.bind($t),$t}class fl extends Array{constructor(e){super();l(this,"_parent");this._parent=e}get selected(){return this[this._parent.selected||0]}get firstChild(){return this[0]}insert(e,s){if(s){const i=this.indexOf(s);this.splice(i,0,e)}else this.push(e);e.parent=this._parent}remove(e){const s=this.indexOf(e);s>=0&&this.splice(s,1)}}var pl={BASE_URL:"/vue-lightning-demo/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function gl(){return pl&&!1}const xl=gl()||!1,ft={debug:!1,animationsEnabled:!0,animationSettings:{duration:250,easing:"ease-in-out"},fontSettings:{fontFamily:"Ubuntu",fontSize:100}};function ki(r){return ml(r)&&r.debug}function dt(r,t,...e){xl&&(ft.debug||ki(t)||ki(e[0]))&&console.log(r,t,...e)}function Ls(r){return typeof r=="function"}function ml(r){return typeof r=="object"}function qs(r){return Array.isArray(r)}function _l(r){return typeof r=="string"}function yl(r){return typeof r=="number"}function vl(r,t){for(const e of t)if(e in r)return!0;return!1}function Pn(r,t={}){if(qs(r))r.forEach(e=>{Pn(e,t)});else if(r)for(const e in r)t[e]===void 0&&(t[e]=r[e]);return t}class zi extends Array{constructor(e,s={}){var t=(...Vh)=>(super(...Vh),l(this,"onChange"),this);return qs(s)?t(...s):_l(s)?t(s):t(...Object.entries(s).filter(([i,n])=>n).map(([i])=>i)),this.onChange=e,this}has(e){return this.indexOf(e)>=0}is(e){return this.indexOf(e)>=0}add(e){this.push(e),this.onChange()}toggle(e){this.has(e)?this.remove(e):this.add(e)}remove(e){const s=this.indexOf(e);s>=0&&(this.splice(s,1),this.onChange())}}function Tl(r){const t=[];let e=!1;for(let R=0;R<r.children.length;R++){const E=r.children[R];if(E.name!=="TextNode"&&E.flexItem!==!1){if(E.name==="text"&&E.text!==""&&!(E.width||E.height))return!1;E.flexOrder!==void 0&&(e=!0),t.push(E)}}e&&t.sort((R,E)=>(R.flexOrder||0)-(E.flexOrder||0));const s=t.length,n=(r.flexDirection||"row")==="row",o=n?"width":"height",a=n?"height":"width",c=n?"marginLeft":"marginTop",u=n?"marginRight":"marginBottom",h=n?"x":"y",d=n?"y":"x",x=r[o]||0,g=r[a]||0,_=r.gap||0,m=r.justifyContent||"flexStart",v=r.alignItems;let T=0;["center","spaceBetween","spaceEvenly"].includes(m)&&(T=t.reduce((R,E)=>R+(E[o]||0),0));const O=g&&v?R=>{v==="flexStart"?R[d]=0:v==="center"?R[d]=(g-(R[a]||0))/2:v==="flexEnd"&&(R[d]=g-(R[a]||0))}:R=>R;if(m==="flexStart"){let R=0;if(t.forEach(E=>{E[h]=R+(E[c]||0),R+=(E[o]||0)+_+(E[c]||0)+(E[u]||0),O(E)}),r.flexBoundary!=="fixed"){const E=R-_;if(E!==r[o])return r[o]=E,!0}}else if(m==="flexEnd"){let R=x;for(let E=s-1;E>=0;E--){const F=t[E];P(F),F[h]=R-(F[o]||0)-(F[u]||0),R-=(F[o]||0)+_+(F[c]||0)+(F[u]||0),O(F)}}else if(m==="center"){let R=(x-(T+_*(s-1)))/2;t.forEach(E=>{E[h]=R,R+=(E[o]||0)+_,O(E)})}else if(m==="spaceBetween"){const R=(x-T)/(s-1);let E=0;t.forEach(F=>{F[h]=E,E+=(F[o]||0)+R,O(F)})}else if(m==="spaceEvenly"){const R=(x-T)/(s+1);let E=R;t.forEach(F=>{F[h]=E,E+=(F[o]||0)+R,O(F)})}return!1}/**
* @vue/shared v3.4.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function On(r,t){const e=new Set(r.split(","));return s=>e.has(s)}const oe={},Xt=[],ke=()=>{},wl=()=>!1,ri=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),Fn=r=>r.startsWith("onUpdate:"),we=Object.assign,ii=(r,t)=>{const e=r.indexOf(t);e>-1&&r.splice(e,1)},Sl=Object.prototype.hasOwnProperty,Z=(r,t)=>Sl.call(r,t),j=Array.isArray,Yt=r=>rr(r)==="[object Map]",Bn=r=>rr(r)==="[object Set]",q=r=>typeof r=="function",Ie=r=>typeof r=="string",Ct=r=>typeof r=="symbol",ae=r=>r!==null&&typeof r=="object",Dn=r=>(ae(r)||q(r))&&q(r.then)&&q(r.catch),Un=Object.prototype.toString,rr=r=>Un.call(r),bl=r=>rr(r).slice(8,-1),kn=r=>rr(r)==="[object Object]",ni=r=>Ie(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,is=On(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ir=r=>{const t=Object.create(null);return e=>t[e]||(t[e]=r(e))},Rl=/-(\w)/g,fs=ir(r=>r.replace(Rl,(t,e)=>e?e.toUpperCase():"")),El=/\B([A-Z])/g,nr=ir(r=>r.replace(El,"-$1").toLowerCase()),Cl=ir(r=>r.charAt(0).toUpperCase()+r.slice(1)),xr=ir(r=>r?`on${Cl(r)}`:""),mt=(r,t)=>!Object.is(r,t),mr=(r,t)=>{for(let e=0;e<r.length;e++)r[e](t)},zn=(r,t,e,s=!1)=>{Object.defineProperty(r,t,{configurable:!0,enumerable:!1,writable:s,value:e})},Il=r=>{const t=parseFloat(r);return isNaN(t)?r:t};let $i;const $n=()=>$i||($i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function oi(r){if(j(r)){const t={};for(let e=0;e<r.length;e++){const s=r[e],i=Ie(s)?Nl(s):oi(s);if(i)for(const n in i)t[n]=i[n]}return t}else if(Ie(r)||ae(r))return r}const Al=/;(?![^(]*\))/g,Ml=/:([^]+)/,Ll=/\/\*[^]*?\*\//g;function Nl(r){const t={};return r.replace(Ll,"").split(Al).forEach(e=>{if(e){const s=e.split(Ml);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function ai(r){let t="";if(Ie(r))t=r;else if(j(r))for(let e=0;e<r.length;e++){const s=ai(r[e]);s&&(t+=s+" ")}else if(ae(r))for(const e in r)r[e]&&(t+=e+" ");return t.trim()}const Wi=r=>Ie(r)?r:r==null?"":j(r)||ae(r)&&(r.toString===Un||!q(r.toString))?JSON.stringify(r,Wn,2):String(r),Wn=(r,t)=>t&&t.__v_isRef?Wn(r,t.value):Yt(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[s,i],n)=>(e[_r(s,n)+" =>"]=i,e),{})}:Bn(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>_r(e))}:Ct(t)?_r(t):ae(t)&&!j(t)&&!kn(t)?String(t):t,_r=(r,t="")=>{var e;return Ct(r)?`Symbol(${(e=r.description)!=null?e:t})`:r};/**
* @vue/reactivity v3.4.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let We;class Pl{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=We,!t&&We&&(this.index=(We.scopes||(We.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const e=We;try{return We=this,t()}finally{We=e}}}on(){We=this}off(){We=this.parent}stop(t){if(this._active){let e,s;for(e=0,s=this.effects.length;e<s;e++)this.effects[e].stop();for(e=0,s=this.cleanups.length;e<s;e++)this.cleanups[e]();if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function Ol(r,t=We){t&&t.active&&t.effects.push(r)}function Fl(){return We}let Rt;class li{constructor(t,e,s,i){this.fn=t,this.trigger=e,this.scheduler=s,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,Ol(this,i)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,_t();for(let t=0;t<this._depsLength;t++){const e=this.deps[t];if(e.computed&&(Bl(e.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),yt()}return this._dirtyLevel>=4}set dirty(t){this._dirtyLevel=t?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let t=pt,e=Rt;try{return pt=!0,Rt=this,this._runnings++,Xi(this),this.fn()}finally{Yi(this),this._runnings--,Rt=e,pt=t}}stop(){this.active&&(Xi(this),Yi(this),this.onStop&&this.onStop(),this.active=!1)}}function Bl(r){return r.value}function Xi(r){r._trackId++,r._depsLength=0}function Yi(r){if(r.deps.length>r._depsLength){for(let t=r._depsLength;t<r.deps.length;t++)Xn(r.deps[t],r);r.deps.length=r._depsLength}}function Xn(r,t){const e=r.get(t);e!==void 0&&t._trackId!==e&&(r.delete(t),r.size===0&&r.cleanup())}let pt=!0,Dr=0;const Yn=[];function _t(){Yn.push(pt),pt=!1}function yt(){const r=Yn.pop();pt=r===void 0?!0:r}function ci(){Dr++}function hi(){for(Dr--;!Dr&&Ur.length;)Ur.shift()()}function Hn(r,t,e){if(t.get(r)!==r._trackId){t.set(r,r._trackId);const s=r.deps[r._depsLength];s!==t?(s&&Xn(s,r),r.deps[r._depsLength++]=t):r._depsLength++}}const Ur=[];function Gn(r,t,e){ci();for(const s of r.keys()){let i;s._dirtyLevel<t&&(i??(i=r.get(s)===s._trackId))&&(s._shouldSchedule||(s._shouldSchedule=s._dirtyLevel===0),s._dirtyLevel=t),s._shouldSchedule&&(i??(i=r.get(s)===s._trackId))&&(s.trigger(),(!s._runnings||s.allowRecurse)&&s._dirtyLevel!==2&&(s._shouldSchedule=!1,s.scheduler&&Ur.push(s.scheduler)))}hi()}const Vn=(r,t)=>{const e=new Map;return e.cleanup=r,e.computed=t,e},kr=new WeakMap,Et=Symbol(""),zr=Symbol("");function Le(r,t,e){if(pt&&Rt){let s=kr.get(r);s||kr.set(r,s=new Map);let i=s.get(e);i||s.set(e,i=Vn(()=>s.delete(e))),Hn(Rt,i)}}function st(r,t,e,s,i,n){const o=kr.get(r);if(!o)return;let a=[];if(t==="clear")a=[...o.values()];else if(e==="length"&&j(r)){const c=Number(s);o.forEach((u,h)=>{(h==="length"||!Ct(h)&&h>=c)&&a.push(u)})}else switch(e!==void 0&&a.push(o.get(e)),t){case"add":j(r)?ni(e)&&a.push(o.get("length")):(a.push(o.get(Et)),Yt(r)&&a.push(o.get(zr)));break;case"delete":j(r)||(a.push(o.get(Et)),Yt(r)&&a.push(o.get(zr)));break;case"set":Yt(r)&&a.push(o.get(Et));break}ci();for(const c of a)c&&Gn(c,4);hi()}const Dl=On("__proto__,__v_isRef,__isVue"),jn=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(Ct)),Hi=Ul();function Ul(){const r={};return["includes","indexOf","lastIndexOf"].forEach(t=>{r[t]=function(...e){const s=te(this);for(let n=0,o=this.length;n<o;n++)Le(s,"get",n+"");const i=s[t](...e);return i===-1||i===!1?s[t](...e.map(te)):i}}),["push","pop","shift","unshift","splice"].forEach(t=>{r[t]=function(...e){_t(),ci();const s=te(this)[t].apply(this,e);return hi(),yt(),s}}),r}function kl(r){Ct(r)||(r=String(r));const t=te(this);return Le(t,"has",r),t.hasOwnProperty(r)}class Kn{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,s){const i=this._isReadonly,n=this._isShallow;if(e==="__v_isReactive")return!i;if(e==="__v_isReadonly")return i;if(e==="__v_isShallow")return n;if(e==="__v_raw")return s===(i?n?Zl:Jn:n?Zn:Qn).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const o=j(t);if(!i){if(o&&Z(Hi,e))return Reflect.get(Hi,e,s);if(e==="hasOwnProperty")return kl}const a=Reflect.get(t,e,s);return(Ct(e)?jn.has(e):Dl(e))||(i||Le(t,"get",e),n)?a:Ne(a)?o&&ni(e)?a:a.value:ae(a)?i?eo(a):fi(a):a}}class qn extends Kn{constructor(t=!1){super(!1,t)}set(t,e,s,i){let n=t[e];if(!this._isShallow){const c=ps(n);if(!Qs(s)&&!ps(s)&&(n=te(n),s=te(s)),!j(t)&&Ne(n)&&!Ne(s))return c?!1:(n.value=s,!0)}const o=j(t)&&ni(e)?Number(e)<t.length:Z(t,e),a=Reflect.set(t,e,s,i);return t===te(i)&&(o?mt(s,n)&&st(t,"set",e,s):st(t,"add",e,s)),a}deleteProperty(t,e){const s=Z(t,e);t[e];const i=Reflect.deleteProperty(t,e);return i&&s&&st(t,"delete",e,void 0),i}has(t,e){const s=Reflect.has(t,e);return(!Ct(e)||!jn.has(e))&&Le(t,"has",e),s}ownKeys(t){return Le(t,"iterate",j(t)?"length":Et),Reflect.ownKeys(t)}}class zl extends Kn{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const $l=new qn,Wl=new zl,Xl=new qn(!0);const ui=r=>r,or=r=>Reflect.getPrototypeOf(r);function Ns(r,t,e=!1,s=!1){r=r.__v_raw;const i=te(r),n=te(t);e||(mt(t,n)&&Le(i,"get",t),Le(i,"get",n));const{has:o}=or(i),a=s?ui:e?gi:gs;if(o.call(i,t))return a(r.get(t));if(o.call(i,n))return a(r.get(n));r!==i&&r.get(t)}function Ps(r,t=!1){const e=this.__v_raw,s=te(e),i=te(r);return t||(mt(r,i)&&Le(s,"has",r),Le(s,"has",i)),r===i?e.has(r):e.has(r)||e.has(i)}function Os(r,t=!1){return r=r.__v_raw,!t&&Le(te(r),"iterate",Et),Reflect.get(r,"size",r)}function Gi(r){r=te(r);const t=te(this);return or(t).has.call(t,r)||(t.add(r),st(t,"add",r,r)),this}function Vi(r,t){t=te(t);const e=te(this),{has:s,get:i}=or(e);let n=s.call(e,r);n||(r=te(r),n=s.call(e,r));const o=i.call(e,r);return e.set(r,t),n?mt(t,o)&&st(e,"set",r,t):st(e,"add",r,t),this}function ji(r){const t=te(this),{has:e,get:s}=or(t);let i=e.call(t,r);i||(r=te(r),i=e.call(t,r)),s&&s.call(t,r);const n=t.delete(r);return i&&st(t,"delete",r,void 0),n}function Ki(){const r=te(this),t=r.size!==0,e=r.clear();return t&&st(r,"clear",void 0,void 0),e}function Fs(r,t){return function(s,i){const n=this,o=n.__v_raw,a=te(o),c=t?ui:r?gi:gs;return!r&&Le(a,"iterate",Et),o.forEach((u,h)=>s.call(i,c(u),c(h),n))}}function Bs(r,t,e){return function(...s){const i=this.__v_raw,n=te(i),o=Yt(n),a=r==="entries"||r===Symbol.iterator&&o,c=r==="keys"&&o,u=i[r](...s),h=e?ui:t?gi:gs;return!t&&Le(n,"iterate",c?zr:Et),{next(){const{value:d,done:x}=u.next();return x?{value:d,done:x}:{value:a?[h(d[0]),h(d[1])]:h(d),done:x}},[Symbol.iterator](){return this}}}}function at(r){return function(...t){return r==="delete"?!1:r==="clear"?void 0:this}}function Yl(){const r={get(n){return Ns(this,n)},get size(){return Os(this)},has:Ps,add:Gi,set:Vi,delete:ji,clear:Ki,forEach:Fs(!1,!1)},t={get(n){return Ns(this,n,!1,!0)},get size(){return Os(this)},has:Ps,add:Gi,set:Vi,delete:ji,clear:Ki,forEach:Fs(!1,!0)},e={get(n){return Ns(this,n,!0)},get size(){return Os(this,!0)},has(n){return Ps.call(this,n,!0)},add:at("add"),set:at("set"),delete:at("delete"),clear:at("clear"),forEach:Fs(!0,!1)},s={get(n){return Ns(this,n,!0,!0)},get size(){return Os(this,!0)},has(n){return Ps.call(this,n,!0)},add:at("add"),set:at("set"),delete:at("delete"),clear:at("clear"),forEach:Fs(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(n=>{r[n]=Bs(n,!1,!1),e[n]=Bs(n,!0,!1),t[n]=Bs(n,!1,!0),s[n]=Bs(n,!0,!0)}),[r,e,t,s]}const[Hl,Gl,Vl,jl]=Yl();function di(r,t){const e=t?r?jl:Vl:r?Gl:Hl;return(s,i,n)=>i==="__v_isReactive"?!r:i==="__v_isReadonly"?r:i==="__v_raw"?s:Reflect.get(Z(e,i)&&i in s?e:s,i,n)}const Kl={get:di(!1,!1)},ql={get:di(!1,!0)},Ql={get:di(!0,!1)};const Qn=new WeakMap,Zn=new WeakMap,Jn=new WeakMap,Zl=new WeakMap;function Jl(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ec(r){return r.__v_skip||!Object.isExtensible(r)?0:Jl(bl(r))}function fi(r){return ps(r)?r:pi(r,!1,$l,Kl,Qn)}function tc(r){return pi(r,!1,Xl,ql,Zn)}function eo(r){return pi(r,!0,Wl,Ql,Jn)}function pi(r,t,e,s,i){if(!ae(r)||r.__v_raw&&!(t&&r.__v_isReactive))return r;const n=i.get(r);if(n)return n;const o=ec(r);if(o===0)return r;const a=new Proxy(r,o===2?s:e);return i.set(r,a),a}function ns(r){return ps(r)?ns(r.__v_raw):!!(r&&r.__v_isReactive)}function ps(r){return!!(r&&r.__v_isReadonly)}function Qs(r){return!!(r&&r.__v_isShallow)}function to(r){return r?!!r.__v_raw:!1}function te(r){const t=r&&r.__v_raw;return t?te(t):r}function so(r){return Object.isExtensible(r)&&zn(r,"__v_skip",!0),r}const gs=r=>ae(r)?fi(r):r,gi=r=>ae(r)?eo(r):r;class ro{constructor(t,e,s,i){this.getter=t,this._setter=e,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new li(()=>t(this._value),()=>Xs(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=s}get value(){const t=te(this);return(!t._cacheable||t.effect.dirty)&&mt(t._value,t._value=t.effect.run())&&Xs(t,4),io(t),t.effect._dirtyLevel>=2&&Xs(t,2),t._value}set value(t){this._setter(t)}get _dirty(){return this.effect.dirty}set _dirty(t){this.effect.dirty=t}}function sc(r,t,e=!1){let s,i;const n=q(r);return n?(s=r,i=ke):(s=r.get,i=r.set),new ro(s,i,n||!i,e)}function io(r){var t;pt&&Rt&&(r=te(r),Hn(Rt,(t=r.dep)!=null?t:r.dep=Vn(()=>r.dep=void 0,r instanceof ro?r:void 0)))}function Xs(r,t=4,e){r=te(r);const s=r.dep;s&&Gn(s,t)}function Ne(r){return!!(r&&r.__v_isRef===!0)}function os(r){return rc(r,!1)}function rc(r,t){return Ne(r)?r:new ic(r,t)}class ic{constructor(t,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?t:te(t),this._value=e?t:gs(t)}get value(){return io(this),this._value}set value(t){const e=this.__v_isShallow||Qs(t)||ps(t);t=e?t:te(t),mt(t,this._rawValue)&&(this._rawValue=t,this._value=e?t:gs(t),Xs(this,4))}}function $r(r){return Ne(r)?r.value:r}const nc={get:(r,t,e)=>$r(Reflect.get(r,t,e)),set:(r,t,e,s)=>{const i=r[t];return Ne(i)&&!Ne(e)?(i.value=e,!0):Reflect.set(r,t,e,s)}};function no(r){return ns(r)?r:new Proxy(r,nc)}const oo=os(void 0),oc=r=>oo.value=r,{animationSettings:ac}=ft,Ds=[];let yr=!0;function qi(r){const t=[];for(const[e,s]of Object.entries(r))t.push({type:e,props:s});return si("DynamicShader",{effects:t})}function qt(r=""){return{set(t){yl(t)&&(t={width:t,color:255}),this.effects={...this.effects||{},[`border${r}`]:t},this[`_border${r}`]=t},get(){return this[`_border${r}`]}}}const lc=["alpha","color","colorTop","colorRight","colorLeft","colorBottom","colorTl","colorTr","colorBl","colorBr","height","fontSize","lineHeight","mount","mountX","mountY","pivot","pivotX","pivotY","rotation","scale","width","worldX","worldY","x","y","zIndex","zIndexLocked"],cc=["autosize","clipping","contain","fontFamily","fontStretch","fontStyle","fontWeight","letterSpacing","maxLines","offsetY","overflowSuffix","rtt","scrollable","scrollY","src","text","textAlign","textBaseline","textOverflow","texture","verticalAlign","wordWrap"];class Ze extends Object{constructor(e){super();l(this,"id");l(this,"debug");l(this,"name");l(this,"lng");l(this,"renderer");l(this,"selected");l(this,"autofocus");l(this,"flexItem");l(this,"flexOrder");l(this,"flexBoundary");l(this,"_queueDelete");l(this,"forwardFocus");l(this,"_undoStyles");l(this,"_renderProps");l(this,"_effects");l(this,"_parent");l(this,"_shader");l(this,"_style");l(this,"_states");l(this,"_events");l(this,"_animationSettings");l(this,"_borderRadius");l(this,"_border");l(this,"_borderLeft");l(this,"_borderRight");l(this,"_borderTop");l(this,"_borderBottom");l(this,"_animationQueue",[]);l(this,"_animationQueueSettings");l(this,"_animationRunning",!1);l(this,"children");this.name=e,this._renderProps={},this.children=new fl(this)}get effects(){return this._effects}set effects(e){this._effects=e,this.lng&&(this.shader=qi(e))}get parent(){return this._parent}set parent(e){this._parent=e,this.lng&&(this.lng.parent=(e==null?void 0:e.lng)??null)}get shader(){return this._shader}set shader(e){qs(e)?this._shader=si(...e):this._shader=e,this._sendToLightning("shader",this._shader)}_sendToLightningAnimatable(e,s){if(this.lng){if(this.transition&&(this.transition===!0||this.transition[e])){const i=this.transition===!0||this.transition[e]===!0?void 0:this.transition[e];return this.animate({[e]:s},i).start()}this.lng[e]=s}else this._renderProps[e]=s}_sendToLightning(e,s){this.lng?this.lng[e]=s:this._renderProps[e]=s}animate(e,s){return P(this.lng,"Node must be rendered before animating"),this.lng.animate(e,s||this.animationSettings)}chain(e,s){return this._animationRunning&&(this._animationQueue=[],this._animationRunning=!1),s?this._animationQueueSettings=s:this._animationQueueSettings||(this._animationQueueSettings=s||this.animationSettings),s=s||this._animationQueueSettings,this._animationQueue.push({props:e,animationSettings:s}),this}async start(){let e=this._animationQueue.shift();for(;e;)this._animationRunning=!0,await this.animate(e.props,e.animationSettings).start().waitUntilStopped(),e=this._animationQueue.shift();this._animationRunning=!1,this._animationQueueSettings=void 0}setFocus(){if(this.lng){if(this.forwardFocus!==void 0)if(Ls(this.forwardFocus)){if(this.forwardFocus.call(this,this)!==!1)return}else{const e=typeof this.forwardFocus=="number"?this.forwardFocus:null;if(e!==null&&e<this.children.length){const s=this.children[e];s instanceof Ze&&s.setFocus();return}}queueMicrotask(()=>oc(this))}else this.autofocus=!0}isTextNode(){return this.name==="text"}_layoutOnLoad(){this.lng.on("loaded",(e,s)=>{const{dimensions:i}=s;this.parent.updateLayout(this,i)})}getText(){return this.children.map(e=>e.text).join("")}destroy(){var e;this._queueDelete&&((e=this.lng)==null||e.destroy())}set onEvents(e){this._events=e}get onEvents(){return this._events||[]}set style(e){qs(e)?this._style=Pn(e):this._style=e;for(const s in this._style)this[s]===void 0&&(this[s]=this._style[s])}get style(){return this._style}get hasChildren(){return this.children.length>0}getChildById(e){return this.children.find(s=>s.id===e)}searchChildrenById(e){for(let s=0;s<this.children.length;s++){const i=this.children[s];if(i instanceof Ze){if(i.id===e)return i;const n=i.searchChildrenById(e);if(n)return n}}}set states(e){this._states=new zi(this._stateChanged.bind(this),e),this.lng&&this._stateChanged()}get states(){return this._states=this._states||new zi(this._stateChanged.bind(this)),this._states}get animationSettings(){return this._animationSettings||ac}set animationSettings(e){this._animationSettings=e}requiresLayout(){return this.display==="flex"||this.onBeforeLayout}updateLayout(e,s){var i,n;if(this.hasChildren){dt("Layout: ",this);let o=!1;Ls(this.onBeforeLayout)&&(o=this.onBeforeLayout.call(this,this,e,s)),this.display==="flex"?(Tl(this)||o)&&((i=this.parent)==null||i.updateLayout()):o&&((n=this.parent)==null||n.updateLayout()),Ls(this.onLayout)&&this.onLayout.call(this,this,e,s)}}_stateChanged(){if(dt("State Changed: ",this,this.states),this.forwardStates){const s=this.states.slice();this.children.forEach(i=>i.states=s)}const e=this.states;if(this._undoStyles||this.style&&vl(this.style,e)){this._undoStyles=this._undoStyles||[];const s={};this._undoStyles.forEach(n=>{s[n]=this.style[n]});const i=e.reduce((n,o)=>{const a=this.style[o];return a&&(n={...n,...a}),n},{});this._undoStyles=Object.keys(i),i.transition!==void 0&&(this.transition=i.transition),Object.assign(this,s,i)}}render(){const e=this,s=this.parent;if(!s){console.warn("Parent not set - no node created for: ",this);return}if(!s.lng){console.warn("Parent not rendered yet: ",this);return}if(this.lng){console.warn("Node already rendered: ",this);return}s.requiresLayout()&&Ds.indexOf(s)===-1&&(Ds.push(s),yr&&(yr=!1,queueMicrotask(()=>{for(yr=!0;Ds.length;)Ds.pop().updateLayout()}))),this.states.length&&this._stateChanged();const i=e._renderProps;if(i.x=i.x||0,i.y=i.y||0,s.lng&&(i.parent=s.lng),e._effects&&(this.shader=qi(e._effects)),e.isTextNode()){if(ft.fontSettings)for(const n in ft.fontSettings)i[n]===void 0&&(i[n]=ft.fontSettings[n]);i.text=e.getText(),i.contain&&(i.width||(i.width=(s.width||0)-i.x-(i.marginRight||0)),i.contain==="both"&&!i.height&&!i.maxLines?i.height=(s.height||0)-i.y-(i.marginBottom||0):i.maxLines===1&&(i.height=i.height||i.lineHeight||i.fontSize)),dt("Rendering: ",this,i),e.lng=$t.createTextNode(i),s.requiresLayout()&&(!i.width||!i.height)&&e._layoutOnLoad()}else i.texture||(isNaN(i.width)&&(i.width=(s.width||0)-i.x),isNaN(i.height)&&(i.height=(s.height||0)-i.y),!i.color&&!i.src&&(i.color=0)),dt("Rendering: ",this,i),e.lng=$t.createNode(i);i.autosize&&s.requiresLayout()&&e._layoutOnLoad(),e.onFail&&e.lng.on("failed",e.onFail),e.onLoad&&e.lng.on("loaded",e.onLoad),Ls(this.onCreate)&&this.onCreate.call(this,e),e.onEvents.forEach(([n,o])=>{var a;(a=e.lng)==null||a.on(n,(c,u)=>o(e,u))}),e.lng.div&&(e.lng.div.solid=e),e.name!=="text"&&e.children.forEach(n=>{n.render?n.render():n.text!==""&&console.warn("TextNode outside of <Text>: ",n)}),e.autofocus&&e.setFocus(),this._renderProps={}}}for(const r of lc)Object.defineProperty(Ze.prototype,r,{get(){return this.lng?this.lng[r]:this._renderProps[r]},set(t){this._sendToLightningAnimatable(r,t)}});for(const r of cc)Object.defineProperty(Ze.prototype,r,{get(){return this.lng?this.lng[r]:this._renderProps[r]},set(t){this._sendToLightning(r,t)}});Object.defineProperties(Ze.prototype,{borderRadius:{set(r){this._borderRadius=r,this.effects={...this.effects||{},radius:{radius:r}}},get(){return this._borderRadius}},border:qt(),borderLeft:qt("Left"),borderRight:qt("Right"),borderTop:qt("Top"),borderBottom:qt("Bottom")});Object.defineProperties(Ze.prototype,{linearGradient:{set(r={}){this._linearGradient=r,this.effects={...this.effects||{},linearGradient:r}},get(){return this._linearGradient}}});/**
* @vue/runtime-core v3.4.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function gt(r,t,e,s){try{return s?r(...s):r()}catch(i){ar(i,t,e)}}function Je(r,t,e,s){if(q(r)){const i=gt(r,t,e,s);return i&&Dn(i)&&i.catch(n=>{ar(n,t,e)}),i}if(j(r)){const i=[];for(let n=0;n<r.length;n++)i.push(Je(r[n],t,e,s));return i}}function ar(r,t,e,s=!0){const i=t?t.vnode:null;if(t){let n=t.parent;const o=t.proxy,a=`https://vuejs.org/error-reference/#runtime-${e}`;for(;n;){const u=n.ec;if(u){for(let h=0;h<u.length;h++)if(u[h](r,o,a)===!1)return}n=n.parent}const c=t.appContext.config.errorHandler;if(c){_t(),gt(c,null,10,[r,o,a]),yt();return}}hc(r,e,i,s)}function hc(r,t,e,s=!0){console.error(r)}let xs=!1,Wr=!1;const be=[];let Ke=0;const Ht=[];let lt=null,wt=0;const ao=Promise.resolve();let xi=null;function uc(r){const t=xi||ao;return r?t.then(this?r.bind(this):r):t}function dc(r){let t=Ke+1,e=be.length;for(;t<e;){const s=t+e>>>1,i=be[s],n=ms(i);n<r||n===r&&i.pre?t=s+1:e=s}return t}function mi(r){(!be.length||!be.includes(r,xs&&r.allowRecurse?Ke+1:Ke))&&(r.id==null?be.push(r):be.splice(dc(r.id),0,r),lo())}function lo(){!xs&&!Wr&&(Wr=!0,xi=ao.then(ho))}function fc(r){const t=be.indexOf(r);t>Ke&&be.splice(t,1)}function pc(r){j(r)?Ht.push(...r):(!lt||!lt.includes(r,r.allowRecurse?wt+1:wt))&&Ht.push(r),lo()}function Qi(r,t,e=xs?Ke+1:0){for(;e<be.length;e++){const s=be[e];if(s&&s.pre){if(r&&s.id!==r.uid)continue;be.splice(e,1),e--,s()}}}function co(r){if(Ht.length){const t=[...new Set(Ht)].sort((e,s)=>ms(e)-ms(s));if(Ht.length=0,lt){lt.push(...t);return}for(lt=t,wt=0;wt<lt.length;wt++)lt[wt]();lt=null,wt=0}}const ms=r=>r.id==null?1/0:r.id,gc=(r,t)=>{const e=ms(r)-ms(t);if(e===0){if(r.pre&&!t.pre)return-1;if(t.pre&&!r.pre)return 1}return e};function ho(r){Wr=!1,xs=!0,be.sort(gc);try{for(Ke=0;Ke<be.length;Ke++){const t=be[Ke];t&&t.active!==!1&&gt(t,null,14)}}finally{Ke=0,be.length=0,co(),xs=!1,xi=null,(be.length||Ht.length)&&ho()}}function xc(r,t,...e){if(r.isUnmounted)return;const s=r.vnode.props||oe;let i=e;const n=t.startsWith("update:"),o=n&&t.slice(7);if(o&&o in s){const h=`${o==="modelValue"?"model":o}Modifiers`,{number:d,trim:x}=s[h]||oe;x&&(i=e.map(g=>Ie(g)?g.trim():g)),d&&(i=e.map(Il))}let a,c=s[a=xr(t)]||s[a=xr(fs(t))];!c&&n&&(c=s[a=xr(nr(t))]),c&&Je(c,r,6,i);const u=s[a+"Once"];if(u){if(!r.emitted)r.emitted={};else if(r.emitted[a])return;r.emitted[a]=!0,Je(u,r,6,i)}}function uo(r,t,e=!1){const s=t.emitsCache,i=s.get(r);if(i!==void 0)return i;const n=r.emits;let o={},a=!1;if(!q(r)){const c=u=>{const h=uo(u,t,!0);h&&(a=!0,we(o,h))};!e&&t.mixins.length&&t.mixins.forEach(c),r.extends&&c(r.extends),r.mixins&&r.mixins.forEach(c)}return!n&&!a?(ae(r)&&s.set(r,null),null):(j(n)?n.forEach(c=>o[c]=null):we(o,n),ae(r)&&s.set(r,o),o)}function lr(r,t){return!r||!ri(t)?!1:(t=t.slice(2).replace(/Once$/,""),Z(r,t[0].toLowerCase()+t.slice(1))||Z(r,nr(t))||Z(r,t))}let qe=null,fo=null;function Zs(r){const t=qe;return qe=r,fo=r&&r.type.__scopeId||null,t}function mc(r,t=qe,e){if(!t||r._n)return r;const s=(...i)=>{s._d&&cn(-1);const n=Zs(t);let o;try{o=r(...i)}finally{Zs(n),s._d&&cn(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function vr(r){const{type:t,vnode:e,proxy:s,withProxy:i,propsOptions:[n],slots:o,attrs:a,emit:c,render:u,renderCache:h,props:d,data:x,setupState:g,ctx:_,inheritAttrs:m}=r,v=Zs(r);let T,O;try{if(e.shapeFlag&4){const E=i||s,F=E;T=je(u.call(F,E,h,d,g,x,_)),O=a}else{const E=t;T=je(E.length>1?E(d,{attrs:a,slots:o,emit:c}):E(d,null)),O=t.props?a:_c(a)}}catch(E){cs.length=0,ar(E,r,1),T=xt(_s)}let R=T;if(O&&m!==!1){const E=Object.keys(O),{shapeFlag:F}=R;E.length&&F&7&&(n&&E.some(Fn)&&(O=yc(O,n)),R=Vt(R,O,!1,!0))}return e.dirs&&(R=Vt(R,null,!1,!0),R.dirs=R.dirs?R.dirs.concat(e.dirs):e.dirs),e.transition&&(R.transition=e.transition),T=R,Zs(v),T}const _c=r=>{let t;for(const e in r)(e==="class"||e==="style"||ri(e))&&((t||(t={}))[e]=r[e]);return t},yc=(r,t)=>{const e={};for(const s in r)(!Fn(s)||!(s.slice(9)in t))&&(e[s]=r[s]);return e};function vc(r,t,e){const{props:s,children:i,component:n}=r,{props:o,children:a,patchFlag:c}=t,u=n.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&c>=0){if(c&1024)return!0;if(c&16)return s?Zi(s,o,u):!!o;if(c&8){const h=t.dynamicProps;for(let d=0;d<h.length;d++){const x=h[d];if(o[x]!==s[x]&&!lr(u,x))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?Zi(s,o,u):!0:!!o;return!1}function Zi(r,t,e){const s=Object.keys(t);if(s.length!==Object.keys(r).length)return!0;for(let i=0;i<s.length;i++){const n=s[i];if(t[n]!==r[n]&&!lr(e,n))return!0}return!1}function Tc({vnode:r,parent:t},e){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===r&&(s.el=r.el),s===r)(r=t.vnode).el=e,t=t.parent;else break}}const wc=Symbol.for("v-ndc"),Sc=r=>r.__isSuspense;function bc(r,t){t&&t.pendingBranch?j(r)?t.effects.push(...r):t.effects.push(r):pc(r)}const Rc=Symbol.for("v-scx"),Ec=()=>Gs(Rc),Us={};function Ys(r,t,e){return po(r,t,e)}function po(r,t,{immediate:e,deep:s,flush:i,once:n,onTrack:o,onTrigger:a}=oe){if(t&&n){const B=t;t=(...w)=>{B(...w),F()}}const c=Ce,u=B=>s===!0?B:Wt(B,s===!1?1:void 0);let h,d=!1,x=!1;if(Ne(r)?(h=()=>r.value,d=Qs(r)):ns(r)?(h=()=>u(r),d=!0):j(r)?(x=!0,d=r.some(B=>ns(B)||Qs(B)),h=()=>r.map(B=>{if(Ne(B))return B.value;if(ns(B))return u(B);if(q(B))return gt(B,c,2)})):q(r)?t?h=()=>gt(r,c,2):h=()=>(g&&g(),Je(r,c,3,[_])):h=ke,t&&s){const B=h;h=()=>Wt(B())}let g,_=B=>{g=R.onStop=()=>{gt(B,c,4),g=R.onStop=void 0}},m;if(ur)if(_=ke,t?e&&Je(t,c,3,[h(),x?[]:void 0,_]):h(),i==="sync"){const B=Ec();m=B.__watcherHandles||(B.__watcherHandles=[])}else return ke;let v=x?new Array(r.length).fill(Us):Us;const T=()=>{if(!(!R.active||!R.dirty))if(t){const B=R.run();(s||d||(x?B.some((w,D)=>mt(w,v[D])):mt(B,v)))&&(g&&g(),Je(t,c,3,[B,v===Us?void 0:x&&v[0]===Us?[]:v,_]),v=B)}else R.run()};T.allowRecurse=!!t;let O;i==="sync"?O=T:i==="post"?O=()=>Me(T,c&&c.suspense):(T.pre=!0,c&&(T.id=c.uid),O=()=>mi(T));const R=new li(h,ke,O),E=Fl(),F=()=>{R.stop(),E&&ii(E.effects,R)};return t?e?T():v=R.run():i==="post"?Me(R.run.bind(R),c&&c.suspense):R.run(),m&&m.push(F),F}function Cc(r,t,e){const s=this.proxy,i=Ie(r)?r.includes(".")?go(s,r):()=>s[r]:r.bind(s,s);let n;q(t)?n=t:(n=t.handler,e=t);const o=Ts(this),a=po(i,n.bind(s),e);return o(),a}function go(r,t){const e=t.split(".");return()=>{let s=r;for(let i=0;i<e.length&&s;i++)s=s[e[i]];return s}}function Wt(r,t=1/0,e){if(t<=0||!ae(r)||r.__v_skip||(e=e||new Set,e.has(r)))return r;if(e.add(r),t--,Ne(r))Wt(r.value,t,e);else if(j(r))for(let s=0;s<r.length;s++)Wt(r[s],t,e);else if(Bn(r)||Yt(r))r.forEach(s=>{Wt(s,t,e)});else if(kn(r))for(const s in r)Wt(r[s],t,e);return r}function vt(r,t,e,s){const i=r.dirs,n=t&&t.dirs;for(let o=0;o<i.length;o++){const a=i[o];n&&(a.oldValue=n[o].value);let c=a.dir[s];c&&(_t(),Je(c,e,8,[r.el,a,r,t]),yt())}}const Hs=r=>!!r.type.__asyncLoader,xo=r=>r.type.__isKeepAlive;function Ic(r,t){mo(r,"a",t)}function Ac(r,t){mo(r,"da",t)}function mo(r,t,e=Ce){const s=r.__wdc||(r.__wdc=()=>{let i=e;for(;i;){if(i.isDeactivated)return;i=i.parent}return r()});if(cr(t,s,e),e){let i=e.parent;for(;i&&i.parent;)xo(i.parent.vnode)&&Mc(s,t,e,i),i=i.parent}}function Mc(r,t,e,s){const i=cr(t,r,s,!0);yo(()=>{ii(s[t],i)},e)}function cr(r,t,e=Ce,s=!1){if(e){const i=e[r]||(e[r]=[]),n=t.__weh||(t.__weh=(...o)=>{if(e.isUnmounted)return;_t();const a=Ts(e),c=Je(t,e,r,o);return a(),yt(),c});return s?i.unshift(n):i.push(n),n}}const nt=r=>(t,e=Ce)=>(!ur||r==="sp")&&cr(r,(...s)=>t(...s),e),Lc=nt("bm"),_o=nt("m"),Nc=nt("bu"),Pc=nt("u"),Oc=nt("bum"),yo=nt("um"),Fc=nt("sp"),Bc=nt("rtg"),Dc=nt("rtc");function Uc(r,t=Ce){cr("ec",r,t)}function Ji(r,t,e,s){let i;const n=e;if(j(r)||Ie(r)){i=new Array(r.length);for(let o=0,a=r.length;o<a;o++)i[o]=t(r[o],o,void 0,n)}else if(typeof r=="number"){i=new Array(r);for(let o=0;o<r;o++)i[o]=t(o+1,o,void 0,n)}else if(ae(r))if(r[Symbol.iterator])i=Array.from(r,(o,a)=>t(o,a,void 0,n));else{const o=Object.keys(r);i=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const u=o[a];i[a]=t(r[u],u,a,n)}}else i=[];return i}const Xr=r=>r?Po(r)?Ti(r)||r.proxy:Xr(r.parent):null,as=we(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>Xr(r.parent),$root:r=>Xr(r.root),$emit:r=>r.emit,$options:r=>_i(r),$forceUpdate:r=>r.f||(r.f=()=>{r.effect.dirty=!0,mi(r.update)}),$nextTick:r=>r.n||(r.n=uc.bind(r.proxy)),$watch:r=>Cc.bind(r)}),Tr=(r,t)=>r!==oe&&!r.__isScriptSetup&&Z(r,t),kc={get({_:r},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:s,data:i,props:n,accessCache:o,type:a,appContext:c}=r;let u;if(t[0]!=="$"){const g=o[t];if(g!==void 0)switch(g){case 1:return s[t];case 2:return i[t];case 4:return e[t];case 3:return n[t]}else{if(Tr(s,t))return o[t]=1,s[t];if(i!==oe&&Z(i,t))return o[t]=2,i[t];if((u=r.propsOptions[0])&&Z(u,t))return o[t]=3,n[t];if(e!==oe&&Z(e,t))return o[t]=4,e[t];Yr&&(o[t]=0)}}const h=as[t];let d,x;if(h)return t==="$attrs"&&Le(r.attrs,"get",""),h(r);if((d=a.__cssModules)&&(d=d[t]))return d;if(e!==oe&&Z(e,t))return o[t]=4,e[t];if(x=c.config.globalProperties,Z(x,t))return x[t]},set({_:r},t,e){const{data:s,setupState:i,ctx:n}=r;return Tr(i,t)?(i[t]=e,!0):s!==oe&&Z(s,t)?(s[t]=e,!0):Z(r.props,t)||t[0]==="$"&&t.slice(1)in r?!1:(n[t]=e,!0)},has({_:{data:r,setupState:t,accessCache:e,ctx:s,appContext:i,propsOptions:n}},o){let a;return!!e[o]||r!==oe&&Z(r,o)||Tr(t,o)||(a=n[0])&&Z(a,o)||Z(s,o)||Z(as,o)||Z(i.config.globalProperties,o)},defineProperty(r,t,e){return e.get!=null?r._.accessCache[t]=0:Z(e,"value")&&this.set(r,t,e.value,null),Reflect.defineProperty(r,t,e)}};function en(r){return j(r)?r.reduce((t,e)=>(t[e]=null,t),{}):r}let Yr=!0;function zc(r){const t=_i(r),e=r.proxy,s=r.ctx;Yr=!1,t.beforeCreate&&tn(t.beforeCreate,r,"bc");const{data:i,computed:n,methods:o,watch:a,provide:c,inject:u,created:h,beforeMount:d,mounted:x,beforeUpdate:g,updated:_,activated:m,deactivated:v,beforeDestroy:T,beforeUnmount:O,destroyed:R,unmounted:E,render:F,renderTracked:B,renderTriggered:w,errorCaptured:D,serverPrefetch:k,expose:Y,inheritAttrs:X,components:ee,directives:J,filters:se}=t;if(u&&$c(u,s,null),o)for(const V in o){const K=o[V];q(K)&&(s[V]=K.bind(e))}if(i){const V=i.call(e,e);ae(V)&&(r.data=fi(V))}if(Yr=!0,n)for(const V in n){const K=n[V],ie=q(K)?K.bind(e,e):q(K.get)?K.get.bind(e,e):ke,le=!q(K)&&q(K.set)?K.set.bind(e):ke,xe=yh({get:ie,set:le});Object.defineProperty(s,V,{enumerable:!0,configurable:!0,get:()=>xe.value,set:me=>xe.value=me})}if(a)for(const V in a)vo(a[V],s,e,V);if(c){const V=q(c)?c.call(e):c;Reflect.ownKeys(V).forEach(K=>{Vc(K,V[K])})}h&&tn(h,r,"c");function W(V,K){j(K)?K.forEach(ie=>V(ie.bind(e))):K&&V(K.bind(e))}if(W(Lc,d),W(_o,x),W(Nc,g),W(Pc,_),W(Ic,m),W(Ac,v),W(Uc,D),W(Dc,B),W(Bc,w),W(Oc,O),W(yo,E),W(Fc,k),j(Y))if(Y.length){const V=r.exposed||(r.exposed={});Y.forEach(K=>{Object.defineProperty(V,K,{get:()=>e[K],set:ie=>e[K]=ie})})}else r.exposed||(r.exposed={});F&&r.render===ke&&(r.render=F),X!=null&&(r.inheritAttrs=X),ee&&(r.components=ee),J&&(r.directives=J)}function $c(r,t,e=ke){j(r)&&(r=Hr(r));for(const s in r){const i=r[s];let n;ae(i)?"default"in i?n=Gs(i.from||s,i.default,!0):n=Gs(i.from||s):n=Gs(i),Ne(n)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>n.value,set:o=>n.value=o}):t[s]=n}}function tn(r,t,e){Je(j(r)?r.map(s=>s.bind(t.proxy)):r.bind(t.proxy),t,e)}function vo(r,t,e,s){const i=s.includes(".")?go(e,s):()=>e[s];if(Ie(r)){const n=t[r];q(n)&&Ys(i,n)}else if(q(r))Ys(i,r.bind(e));else if(ae(r))if(j(r))r.forEach(n=>vo(n,t,e,s));else{const n=q(r.handler)?r.handler.bind(e):t[r.handler];q(n)&&Ys(i,n,r)}}function _i(r){const t=r.type,{mixins:e,extends:s}=t,{mixins:i,optionsCache:n,config:{optionMergeStrategies:o}}=r.appContext,a=n.get(t);let c;return a?c=a:!i.length&&!e&&!s?c=t:(c={},i.length&&i.forEach(u=>Js(c,u,o,!0)),Js(c,t,o)),ae(t)&&n.set(t,c),c}function Js(r,t,e,s=!1){const{mixins:i,extends:n}=t;n&&Js(r,n,e,!0),i&&i.forEach(o=>Js(r,o,e,!0));for(const o in t)if(!(s&&o==="expose")){const a=Wc[o]||e&&e[o];r[o]=a?a(r[o],t[o]):t[o]}return r}const Wc={data:sn,props:rn,emits:rn,methods:rs,computed:rs,beforeCreate:Ee,created:Ee,beforeMount:Ee,mounted:Ee,beforeUpdate:Ee,updated:Ee,beforeDestroy:Ee,beforeUnmount:Ee,destroyed:Ee,unmounted:Ee,activated:Ee,deactivated:Ee,errorCaptured:Ee,serverPrefetch:Ee,components:rs,directives:rs,watch:Yc,provide:sn,inject:Xc};function sn(r,t){return t?r?function(){return we(q(r)?r.call(this,this):r,q(t)?t.call(this,this):t)}:t:r}function Xc(r,t){return rs(Hr(r),Hr(t))}function Hr(r){if(j(r)){const t={};for(let e=0;e<r.length;e++)t[r[e]]=r[e];return t}return r}function Ee(r,t){return r?[...new Set([].concat(r,t))]:t}function rs(r,t){return r?we(Object.create(null),r,t):t}function rn(r,t){return r?j(r)&&j(t)?[...new Set([...r,...t])]:we(Object.create(null),en(r),en(t??{})):t}function Yc(r,t){if(!r)return t;if(!t)return r;const e=we(Object.create(null),r);for(const s in t)e[s]=Ee(r[s],t[s]);return e}function To(){return{app:null,config:{isNativeTag:wl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Hc=0;function Gc(r,t){return function(s,i=null){q(s)||(s=we({},s)),i!=null&&!ae(i)&&(i=null);const n=To(),o=new WeakSet;let a=!1;const c=n.app={_uid:Hc++,_component:s,_props:i,_container:null,_context:n,_instance:null,version:vh,get config(){return n.config},set config(u){},use(u,...h){return o.has(u)||(u&&q(u.install)?(o.add(u),u.install(c,...h)):q(u)&&(o.add(u),u(c,...h))),c},mixin(u){return n.mixins.includes(u)||n.mixins.push(u),c},component(u,h){return h?(n.components[u]=h,c):n.components[u]},directive(u,h){return h?(n.directives[u]=h,c):n.directives[u]},mount(u,h,d){if(!a){const x=xt(s,i);return x.appContext=n,d===!0?d="svg":d===!1&&(d=void 0),h&&t?t(x,u):r(x,u,d),a=!0,c._container=u,u.__vue_app__=c,Ti(x.component)||x.component.proxy}},unmount(){a&&(r(null,c._container),delete c._container.__vue_app__)},provide(u,h){return n.provides[u]=h,c},runWithContext(u){const h=ls;ls=c;try{return u()}finally{ls=h}}};return c}}let ls=null;function Vc(r,t){if(Ce){let e=Ce.provides;const s=Ce.parent&&Ce.parent.provides;s===e&&(e=Ce.provides=Object.create(s)),e[r]=t}}function Gs(r,t,e=!1){const s=Ce||qe;if(s||ls){const i=s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:ls._context.provides;if(i&&r in i)return i[r];if(arguments.length>1)return e&&q(t)?t.call(s&&s.proxy):t}}const wo={},So=()=>Object.create(wo),bo=r=>Object.getPrototypeOf(r)===wo;function jc(r,t,e,s=!1){const i={},n=So();r.propsDefaults=Object.create(null),Ro(r,t,i,n);for(const o in r.propsOptions[0])o in i||(i[o]=void 0);e?r.props=s?i:tc(i):r.type.props?r.props=i:r.props=n,r.attrs=n}function Kc(r,t,e,s){const{props:i,attrs:n,vnode:{patchFlag:o}}=r,a=te(i),[c]=r.propsOptions;let u=!1;if((s||o>0)&&!(o&16)){if(o&8){const h=r.vnode.dynamicProps;for(let d=0;d<h.length;d++){let x=h[d];if(lr(r.emitsOptions,x))continue;const g=t[x];if(c)if(Z(n,x))g!==n[x]&&(n[x]=g,u=!0);else{const _=fs(x);i[_]=Gr(c,a,_,g,r,!1)}else g!==n[x]&&(n[x]=g,u=!0)}}}else{Ro(r,t,i,n)&&(u=!0);let h;for(const d in a)(!t||!Z(t,d)&&((h=nr(d))===d||!Z(t,h)))&&(c?e&&(e[d]!==void 0||e[h]!==void 0)&&(i[d]=Gr(c,a,d,void 0,r,!0)):delete i[d]);if(n!==a)for(const d in n)(!t||!Z(t,d))&&(delete n[d],u=!0)}u&&st(r.attrs,"set","")}function Ro(r,t,e,s){const[i,n]=r.propsOptions;let o=!1,a;if(t)for(let c in t){if(is(c))continue;const u=t[c];let h;i&&Z(i,h=fs(c))?!n||!n.includes(h)?e[h]=u:(a||(a={}))[h]=u:lr(r.emitsOptions,c)||(!(c in s)||u!==s[c])&&(s[c]=u,o=!0)}if(n){const c=te(e),u=a||oe;for(let h=0;h<n.length;h++){const d=n[h];e[d]=Gr(i,c,d,u[d],r,!Z(u,d))}}return o}function Gr(r,t,e,s,i,n){const o=r[e];if(o!=null){const a=Z(o,"default");if(a&&s===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&q(c)){const{propsDefaults:u}=i;if(e in u)s=u[e];else{const h=Ts(i);s=u[e]=c.call(null,t),h()}}else s=c}o[0]&&(n&&!a?s=!1:o[1]&&(s===""||s===nr(e))&&(s=!0))}return s}function Eo(r,t,e=!1){const s=t.propsCache,i=s.get(r);if(i)return i;const n=r.props,o={},a=[];let c=!1;if(!q(r)){const h=d=>{c=!0;const[x,g]=Eo(d,t,!0);we(o,x),g&&a.push(...g)};!e&&t.mixins.length&&t.mixins.forEach(h),r.extends&&h(r.extends),r.mixins&&r.mixins.forEach(h)}if(!n&&!c)return ae(r)&&s.set(r,Xt),Xt;if(j(n))for(let h=0;h<n.length;h++){const d=fs(n[h]);nn(d)&&(o[d]=oe)}else if(n)for(const h in n){const d=fs(h);if(nn(d)){const x=n[h],g=o[d]=j(x)||q(x)?{type:x}:we({},x);if(g){const _=ln(Boolean,g.type),m=ln(String,g.type);g[0]=_>-1,g[1]=m<0||_<m,(_>-1||Z(g,"default"))&&a.push(d)}}}const u=[o,a];return ae(r)&&s.set(r,u),u}function nn(r){return r[0]!=="$"&&!is(r)}function on(r){return r===null?"null":typeof r=="function"?r.name||"":typeof r=="object"&&r.constructor&&r.constructor.name||""}function an(r,t){return on(r)===on(t)}function ln(r,t){return j(t)?t.findIndex(e=>an(e,r)):q(t)&&an(t,r)?0:-1}const Co=r=>r[0]==="_"||r==="$stable",yi=r=>j(r)?r.map(je):[je(r)],qc=(r,t,e)=>{if(t._n)return t;const s=mc((...i)=>yi(t(...i)),e);return s._c=!1,s},Io=(r,t,e)=>{const s=r._ctx;for(const i in r){if(Co(i))continue;const n=r[i];if(q(n))t[i]=qc(i,n,s);else if(n!=null){const o=yi(n);t[i]=()=>o}}},Ao=(r,t)=>{const e=yi(t);r.slots.default=()=>e},Qc=(r,t)=>{const e=r.slots=So();if(r.vnode.shapeFlag&32){const s=t._;s?(we(e,t),zn(e,"_",s,!0)):Io(t,e)}else t&&Ao(r,t)},Zc=(r,t,e)=>{const{vnode:s,slots:i}=r;let n=!0,o=oe;if(s.shapeFlag&32){const a=t._;a?e&&a===1?n=!1:(we(i,t),!e&&a===1&&delete i._):(n=!t.$stable,Io(t,i)),o=t}else t&&(Ao(r,t),o={default:1});if(n)for(const a in i)!Co(a)&&o[a]==null&&delete i[a]};function Vr(r,t,e,s,i=!1){if(j(r)){r.forEach((x,g)=>Vr(x,t&&(j(t)?t[g]:t),e,s,i));return}if(Hs(s)&&!i)return;const n=s.shapeFlag&4?Ti(s.component)||s.component.proxy:s.el,o=i?null:n,{i:a,r:c}=r,u=t&&t.r,h=a.refs===oe?a.refs={}:a.refs,d=a.setupState;if(u!=null&&u!==c&&(Ie(u)?(h[u]=null,Z(d,u)&&(d[u]=null)):Ne(u)&&(u.value=null)),q(c))gt(c,a,12,[o,h]);else{const x=Ie(c),g=Ne(c);if(x||g){const _=()=>{if(r.f){const m=x?Z(d,c)?d[c]:h[c]:c.value;i?j(m)&&ii(m,n):j(m)?m.includes(n)||m.push(n):x?(h[c]=[n],Z(d,c)&&(d[c]=h[c])):(c.value=[n],r.k&&(h[r.k]=c.value))}else x?(h[c]=o,Z(d,c)&&(d[c]=o)):g&&(c.value=o,r.k&&(h[r.k]=o))};o?(_.id=-1,Me(_,e)):_()}}}const Me=bc;function Jc(r){return eh(r)}function eh(r,t){const e=$n();e.__VUE__=!0;const{insert:s,remove:i,patchProp:n,createElement:o,createText:a,createComment:c,setText:u,setElementText:h,parentNode:d,nextSibling:x,setScopeId:g=ke,insertStaticContent:_}=r,m=(f,p,y,S=null,b=null,I=null,L=void 0,A=null,M=!!p.dynamicChildren)=>{if(f===p)return;f&&!Qt(f,p)&&(S=Ae(f),me(f,b,I,!0),f=null),p.patchFlag===-2&&(M=!1,p.dynamicChildren=null);const{type:C,ref:U,shapeFlag:$}=p;switch(C){case hr:v(f,p,y,S);break;case _s:T(f,p,y,S);break;case Sr:f==null&&O(p,y,S,L);break;case Xe:ee(f,p,y,S,b,I,L,A,M);break;default:$&1?F(f,p,y,S,b,I,L,A,M):$&6?J(f,p,y,S,b,I,L,A,M):($&64||$&128)&&C.process(f,p,y,S,b,I,L,A,M,ze)}U!=null&&b&&Vr(U,f&&f.ref,I,p||f,!p)},v=(f,p,y,S)=>{if(f==null)s(p.el=a(p.children),y,S);else{const b=p.el=f.el;p.children!==f.children&&u(b,p.children)}},T=(f,p,y,S)=>{f==null?s(p.el=c(p.children||""),y,S):p.el=f.el},O=(f,p,y,S)=>{[f.el,f.anchor]=_(f.children,p,y,S,f.el,f.anchor)},R=({el:f,anchor:p},y,S)=>{let b;for(;f&&f!==p;)b=x(f),s(f,y,S),f=b;s(p,y,S)},E=({el:f,anchor:p})=>{let y;for(;f&&f!==p;)y=x(f),i(f),f=y;i(p)},F=(f,p,y,S,b,I,L,A,M)=>{p.type==="svg"?L="svg":p.type==="math"&&(L="mathml"),f==null?B(p,y,S,b,I,L,A,M):k(f,p,b,I,L,A,M)},B=(f,p,y,S,b,I,L,A)=>{let M,C;const{props:U,shapeFlag:$,transition:z,dirs:H}=f;if(M=f.el=o(f.type,I,U&&U.is,U),$&8?h(M,f.children):$&16&&D(f.children,M,null,S,b,wr(f,I),L,A),H&&vt(f,null,S,"created"),w(M,f,f.scopeId,L,S),U){for(const re in U)re!=="value"&&!is(re)&&n(M,re,null,U[re],I,f.children,S,b,_e);"value"in U&&n(M,"value",null,U.value,I),(C=U.onVnodeBeforeMount)&&Ve(C,S,f)}H&&vt(f,null,S,"beforeMount");const Q=th(b,z);Q&&z.beforeEnter(M),s(M,p,y),((C=U&&U.onVnodeMounted)||Q||H)&&Me(()=>{C&&Ve(C,S,f),Q&&z.enter(M),H&&vt(f,null,S,"mounted")},b)},w=(f,p,y,S,b)=>{if(y&&g(f,y),S)for(let I=0;I<S.length;I++)g(f,S[I]);if(b){let I=b.subTree;if(p===I){const L=b.vnode;w(f,L,L.scopeId,L.slotScopeIds,b.parent)}}},D=(f,p,y,S,b,I,L,A,M=0)=>{for(let C=M;C<f.length;C++){const U=f[C]=A?ct(f[C]):je(f[C]);m(null,U,p,y,S,b,I,L,A)}},k=(f,p,y,S,b,I,L)=>{const A=p.el=f.el;let{patchFlag:M,dynamicChildren:C,dirs:U}=p;M|=f.patchFlag&16;const $=f.props||oe,z=p.props||oe;let H;if(y&&Tt(y,!1),(H=z.onVnodeBeforeUpdate)&&Ve(H,y,p,f),U&&vt(p,f,y,"beforeUpdate"),y&&Tt(y,!0),C?Y(f.dynamicChildren,C,A,y,S,wr(p,b),I):L||K(f,p,A,null,y,S,wr(p,b),I,!1),M>0){if(M&16)X(A,p,$,z,y,S,b);else if(M&2&&$.class!==z.class&&n(A,"class",null,z.class,b),M&4&&n(A,"style",$.style,z.style,b),M&8){const Q=p.dynamicProps;for(let re=0;re<Q.length;re++){const ne=Q[re],ye=$[ne],$e=z[ne];($e!==ye||ne==="value")&&n(A,ne,ye,$e,b,f.children,y,S,_e)}}M&1&&f.children!==p.children&&h(A,p.children)}else!L&&C==null&&X(A,p,$,z,y,S,b);((H=z.onVnodeUpdated)||U)&&Me(()=>{H&&Ve(H,y,p,f),U&&vt(p,f,y,"updated")},S)},Y=(f,p,y,S,b,I,L)=>{for(let A=0;A<p.length;A++){const M=f[A],C=p[A],U=M.el&&(M.type===Xe||!Qt(M,C)||M.shapeFlag&70)?d(M.el):y;m(M,C,U,null,S,b,I,L,!0)}},X=(f,p,y,S,b,I,L)=>{if(y!==S){if(y!==oe)for(const A in y)!is(A)&&!(A in S)&&n(f,A,y[A],null,L,p.children,b,I,_e);for(const A in S){if(is(A))continue;const M=S[A],C=y[A];M!==C&&A!=="value"&&n(f,A,C,M,L,p.children,b,I,_e)}"value"in S&&n(f,"value",y.value,S.value,L)}},ee=(f,p,y,S,b,I,L,A,M)=>{const C=p.el=f?f.el:a(""),U=p.anchor=f?f.anchor:a("");let{patchFlag:$,dynamicChildren:z,slotScopeIds:H}=p;H&&(A=A?A.concat(H):H),f==null?(s(C,y,S),s(U,y,S),D(p.children||[],y,U,b,I,L,A,M)):$>0&&$&64&&z&&f.dynamicChildren?(Y(f.dynamicChildren,z,y,b,I,L,A),(p.key!=null||b&&p===b.subTree)&&Mo(f,p,!0)):K(f,p,y,U,b,I,L,A,M)},J=(f,p,y,S,b,I,L,A,M)=>{p.slotScopeIds=A,f==null?p.shapeFlag&512?b.ctx.activate(p,y,S,L,M):se(p,y,S,b,I,L,M):G(f,p,M)},se=(f,p,y,S,b,I,L)=>{const A=f.component=fh(f,S,b);if(xo(f)&&(A.ctx.renderer=ze),ph(A),A.asyncDep){if(b&&b.registerDep(A,W),!f.el){const M=A.subTree=xt(_s);T(null,M,p,y)}}else W(A,f,p,y,b,I,L)},G=(f,p,y)=>{const S=p.component=f.component;if(vc(f,p,y))if(S.asyncDep&&!S.asyncResolved){V(S,p,y);return}else S.next=p,fc(S.update),S.effect.dirty=!0,S.update();else p.el=f.el,S.vnode=p},W=(f,p,y,S,b,I,L)=>{const A=()=>{if(f.isMounted){let{next:U,bu:$,u:z,parent:H,vnode:Q}=f;{const Mt=Lo(f);if(Mt){U&&(U.el=Q.el,V(f,U,L)),Mt.asyncDep.then(()=>{f.isUnmounted||A()});return}}let re=U,ne;Tt(f,!1),U?(U.el=Q.el,V(f,U,L)):U=Q,$&&mr($),(ne=U.props&&U.props.onVnodeBeforeUpdate)&&Ve(ne,H,U,Q),Tt(f,!0);const ye=vr(f),$e=f.subTree;f.subTree=ye,m($e,ye,d($e.el),Ae($e),f,b,I),U.el=ye.el,re===null&&Tc(f,ye.el),z&&Me(z,b),(ne=U.props&&U.props.onVnodeUpdated)&&Me(()=>Ve(ne,H,U,Q),b)}else{let U;const{el:$,props:z}=p,{bm:H,m:Q,parent:re}=f,ne=Hs(p);if(Tt(f,!1),H&&mr(H),!ne&&(U=z&&z.onVnodeBeforeMount)&&Ve(U,re,p),Tt(f,!0),$&&ce){const ye=()=>{f.subTree=vr(f),ce($,f.subTree,f,b,null)};ne?p.type.__asyncLoader().then(()=>!f.isUnmounted&&ye()):ye()}else{const ye=f.subTree=vr(f);m(null,ye,y,S,f,b,I),p.el=ye.el}if(Q&&Me(Q,b),!ne&&(U=z&&z.onVnodeMounted)){const ye=p;Me(()=>Ve(U,re,ye),b)}(p.shapeFlag&256||re&&Hs(re.vnode)&&re.vnode.shapeFlag&256)&&f.a&&Me(f.a,b),f.isMounted=!0,p=y=S=null}},M=f.effect=new li(A,ke,()=>mi(C),f.scope),C=f.update=()=>{M.dirty&&M.run()};C.id=f.uid,Tt(f,!0),C()},V=(f,p,y)=>{p.component=f;const S=f.vnode.props;f.vnode=p,f.next=null,Kc(f,p.props,S,y),Zc(f,p.children,y),_t(),Qi(f),yt()},K=(f,p,y,S,b,I,L,A,M=!1)=>{const C=f&&f.children,U=f?f.shapeFlag:0,$=p.children,{patchFlag:z,shapeFlag:H}=p;if(z>0){if(z&128){le(C,$,y,S,b,I,L,A,M);return}else if(z&256){ie(C,$,y,S,b,I,L,A,M);return}}H&8?(U&16&&_e(C,b,I),$!==C&&h(y,$)):U&16?H&16?le(C,$,y,S,b,I,L,A,M):_e(C,b,I,!0):(U&8&&h(y,""),H&16&&D($,y,S,b,I,L,A,M))},ie=(f,p,y,S,b,I,L,A,M)=>{f=f||Xt,p=p||Xt;const C=f.length,U=p.length,$=Math.min(C,U);let z;for(z=0;z<$;z++){const H=p[z]=M?ct(p[z]):je(p[z]);m(f[z],H,y,null,b,I,L,A,M)}C>U?_e(f,b,I,!0,!1,$):D(p,y,S,b,I,L,A,M,$)},le=(f,p,y,S,b,I,L,A,M)=>{let C=0;const U=p.length;let $=f.length-1,z=U-1;for(;C<=$&&C<=z;){const H=f[C],Q=p[C]=M?ct(p[C]):je(p[C]);if(Qt(H,Q))m(H,Q,y,null,b,I,L,A,M);else break;C++}for(;C<=$&&C<=z;){const H=f[$],Q=p[z]=M?ct(p[z]):je(p[z]);if(Qt(H,Q))m(H,Q,y,null,b,I,L,A,M);else break;$--,z--}if(C>$){if(C<=z){const H=z+1,Q=H<U?p[H].el:S;for(;C<=z;)m(null,p[C]=M?ct(p[C]):je(p[C]),y,Q,b,I,L,A,M),C++}}else if(C>z)for(;C<=$;)me(f[C],b,I,!0),C++;else{const H=C,Q=C,re=new Map;for(C=Q;C<=z;C++){const Pe=p[C]=M?ct(p[C]):je(p[C]);Pe.key!=null&&re.set(Pe.key,C)}let ne,ye=0;const $e=z-Q+1;let Mt=!1,Si=0;const jt=new Array($e);for(C=0;C<$e;C++)jt[C]=0;for(C=H;C<=$;C++){const Pe=f[C];if(ye>=$e){me(Pe,b,I,!0);continue}let Ge;if(Pe.key!=null)Ge=re.get(Pe.key);else for(ne=Q;ne<=z;ne++)if(jt[ne-Q]===0&&Qt(Pe,p[ne])){Ge=ne;break}Ge===void 0?me(Pe,b,I,!0):(jt[Ge-Q]=C+1,Ge>=Si?Si=Ge:Mt=!0,m(Pe,p[Ge],y,null,b,I,L,A,M),ye++)}const bi=Mt?sh(jt):Xt;for(ne=bi.length-1,C=$e-1;C>=0;C--){const Pe=Q+C,Ge=p[Pe],Ri=Pe+1<U?p[Pe+1].el:S;jt[C]===0?m(null,Ge,y,Ri,b,I,L,A,M):Mt&&(ne<0||C!==bi[ne]?xe(Ge,y,Ri,2):ne--)}}},xe=(f,p,y,S,b=null)=>{const{el:I,type:L,transition:A,children:M,shapeFlag:C}=f;if(C&6){xe(f.component.subTree,p,y,S);return}if(C&128){f.suspense.move(p,y,S);return}if(C&64){L.move(f,p,y,ze);return}if(L===Xe){s(I,p,y);for(let $=0;$<M.length;$++)xe(M[$],p,y,S);s(f.anchor,p,y);return}if(L===Sr){R(f,p,y);return}if(S!==2&&C&1&&A)if(S===0)A.beforeEnter(I),s(I,p,y),Me(()=>A.enter(I),b);else{const{leave:$,delayLeave:z,afterLeave:H}=A,Q=()=>s(I,p,y),re=()=>{$(I,()=>{Q(),H&&H()})};z?z(I,Q,re):re()}else s(I,p,y)},me=(f,p,y,S=!1,b=!1)=>{const{type:I,props:L,ref:A,children:M,dynamicChildren:C,shapeFlag:U,patchFlag:$,dirs:z}=f;if(A!=null&&Vr(A,null,y,f,!0),U&256){p.ctx.deactivate(f);return}const H=U&1&&z,Q=!Hs(f);let re;if(Q&&(re=L&&L.onVnodeBeforeUnmount)&&Ve(re,p,f),U&6)et(f.component,y,S);else{if(U&128){f.suspense.unmount(y,S);return}H&&vt(f,null,p,"beforeUnmount"),U&64?f.type.remove(f,p,y,b,ze,S):C&&(I!==Xe||$>0&&$&64)?_e(C,p,y,!1,!0):(I===Xe&&$&384||!b&&U&16)&&_e(M,p,y),S&&It(f)}(Q&&(re=L&&L.onVnodeUnmounted)||H)&&Me(()=>{re&&Ve(re,p,f),H&&vt(f,null,p,"unmounted")},y)},It=f=>{const{type:p,el:y,anchor:S,transition:b}=f;if(p===Xe){At(y,S);return}if(p===Sr){E(f);return}const I=()=>{i(y),b&&!b.persisted&&b.afterLeave&&b.afterLeave()};if(f.shapeFlag&1&&b&&!b.persisted){const{leave:L,delayLeave:A}=b,M=()=>L(y,I);A?A(f.el,I,M):M()}else I()},At=(f,p)=>{let y;for(;f!==p;)y=x(f),i(f),f=y;i(p)},et=(f,p,y)=>{const{bum:S,scope:b,update:I,subTree:L,um:A}=f;S&&mr(S),b.stop(),I&&(I.active=!1,me(L,f,p,y)),A&&Me(A,p),Me(()=>{f.isUnmounted=!0},p),p&&p.pendingBranch&&!p.isUnmounted&&f.asyncDep&&!f.asyncResolved&&f.suspenseId===p.pendingId&&(p.deps--,p.deps===0&&p.resolve())},_e=(f,p,y,S=!1,b=!1,I=0)=>{for(let L=I;L<f.length;L++)me(f[L],p,y,S,b)},Ae=f=>f.shapeFlag&6?Ae(f.component.subTree):f.shapeFlag&128?f.suspense.next():x(f.anchor||f.el);let ge=!1;const ot=(f,p,y)=>{f==null?p._vnode&&me(p._vnode,null,null,!0):m(p._vnode||null,f,p,null,null,null,y),ge||(ge=!0,Qi(),co(),ge=!1),p._vnode=f},ze={p:m,um:me,m:xe,r:It,mt:se,mc:D,pc:K,pbc:Y,n:Ae,o:r};let Oe,ce;return{render:ot,hydrate:Oe,createApp:Gc(ot,Oe)}}function wr({type:r,props:t},e){return e==="svg"&&r==="foreignObject"||e==="mathml"&&r==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function Tt({effect:r,update:t},e){r.allowRecurse=t.allowRecurse=e}function th(r,t){return(!r||r&&!r.pendingBranch)&&t&&!t.persisted}function Mo(r,t,e=!1){const s=r.children,i=t.children;if(j(s)&&j(i))for(let n=0;n<s.length;n++){const o=s[n];let a=i[n];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[n]=ct(i[n]),a.el=o.el),e||Mo(o,a)),a.type===hr&&(a.el=o.el)}}function sh(r){const t=r.slice(),e=[0];let s,i,n,o,a;const c=r.length;for(s=0;s<c;s++){const u=r[s];if(u!==0){if(i=e[e.length-1],r[i]<u){t[s]=i,e.push(s);continue}for(n=0,o=e.length-1;n<o;)a=n+o>>1,r[e[a]]<u?n=a+1:o=a;u<r[e[n]]&&(n>0&&(t[s]=e[n-1]),e[n]=s)}}for(n=e.length,o=e[n-1];n-- >0;)e[n]=o,o=t[o];return e}function Lo(r){const t=r.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Lo(t)}const rh=r=>r.__isTeleport,Xe=Symbol.for("v-fgt"),hr=Symbol.for("v-txt"),_s=Symbol.for("v-cmt"),Sr=Symbol.for("v-stc"),cs=[];let Ye=null;function Ut(r=!1){cs.push(Ye=r?null:[])}function ih(){cs.pop(),Ye=cs[cs.length-1]||null}let ys=1;function cn(r){ys+=r}function nh(r){return r.dynamicChildren=ys>0?Ye||Xt:null,ih(),ys>0&&Ye&&Ye.push(r),r}function kt(r,t,e,s,i,n){return nh(Qe(r,t,e,s,i,n,!0))}function oh(r){return r?r.__v_isVNode===!0:!1}function Qt(r,t){return r.type===t.type&&r.key===t.key}const No=({key:r})=>r??null,Vs=({ref:r,ref_key:t,ref_for:e})=>(typeof r=="number"&&(r=""+r),r!=null?Ie(r)||Ne(r)||q(r)?{i:qe,r,k:t,f:!!e}:r:null);function Qe(r,t=null,e=null,s=0,i=null,n=r===Xe?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:r,props:t,key:t&&No(t),ref:t&&Vs(t),scopeId:fo,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:qe};return a?(vi(c,e),n&128&&r.normalize(c)):e&&(c.shapeFlag|=Ie(e)?8:16),ys>0&&!o&&Ye&&(c.patchFlag>0||n&6)&&c.patchFlag!==32&&Ye.push(c),c}const xt=ah;function ah(r,t=null,e=null,s=0,i=null,n=!1){if((!r||r===wc)&&(r=_s),oh(r)){const a=Vt(r,t,!0);return e&&vi(a,e),ys>0&&!n&&Ye&&(a.shapeFlag&6?Ye[Ye.indexOf(r)]=a:Ye.push(a)),a.patchFlag|=-2,a}if(_h(r)&&(r=r.__vccOpts),t){t=lh(t);let{class:a,style:c}=t;a&&!Ie(a)&&(t.class=ai(a)),ae(c)&&(to(c)&&!j(c)&&(c=we({},c)),t.style=oi(c))}const o=Ie(r)?1:Sc(r)?128:rh(r)?64:ae(r)?4:q(r)?2:0;return Qe(r,t,e,s,i,o,n,!0)}function lh(r){return r?to(r)||bo(r)?we({},r):r:null}function Vt(r,t,e=!1,s=!1){const{props:i,ref:n,patchFlag:o,children:a,transition:c}=r,u=t?hh(i||{},t):i,h={__v_isVNode:!0,__v_skip:!0,type:r.type,props:u,key:u&&No(u),ref:t&&t.ref?e&&n?j(n)?n.concat(Vs(t)):[n,Vs(t)]:Vs(t):n,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:a,target:r.target,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:t&&r.type!==Xe?o===-1?16:o|16:o,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:c,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Vt(r.ssContent),ssFallback:r.ssFallback&&Vt(r.ssFallback),el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce};return c&&s&&(h.transition=c.clone(h)),h}function ch(r=" ",t=0){return xt(hr,null,r,t)}function je(r){return r==null||typeof r=="boolean"?xt(_s):j(r)?xt(Xe,null,r.slice()):typeof r=="object"?ct(r):xt(hr,null,String(r))}function ct(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:Vt(r)}function vi(r,t){let e=0;const{shapeFlag:s}=r;if(t==null)t=null;else if(j(t))e=16;else if(typeof t=="object")if(s&65){const i=t.default;i&&(i._c&&(i._d=!1),vi(r,i()),i._c&&(i._d=!0));return}else{e=32;const i=t._;!i&&!bo(t)?t._ctx=qe:i===3&&qe&&(qe.slots._===1?t._=1:(t._=2,r.patchFlag|=1024))}else q(t)?(t={default:t,_ctx:qe},e=32):(t=String(t),s&64?(e=16,t=[ch(t)]):e=8);r.children=t,r.shapeFlag|=e}function hh(...r){const t={};for(let e=0;e<r.length;e++){const s=r[e];for(const i in s)if(i==="class")t.class!==s.class&&(t.class=ai([t.class,s.class]));else if(i==="style")t.style=oi([t.style,s.style]);else if(ri(i)){const n=t[i],o=s[i];o&&n!==o&&!(j(n)&&n.includes(o))&&(t[i]=n?[].concat(n,o):o)}else i!==""&&(t[i]=s[i])}return t}function Ve(r,t,e,s=null){Je(r,t,7,[e,s])}const uh=To();let dh=0;function fh(r,t,e){const s=r.type,i=(t?t.appContext:r.appContext)||uh,n={uid:dh++,vnode:r,type:s,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new Pl(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Eo(s,i),emitsOptions:uo(s,i),emit:null,emitted:null,propsDefaults:oe,inheritAttrs:s.inheritAttrs,ctx:oe,data:oe,props:oe,attrs:oe,slots:oe,refs:oe,setupState:oe,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=t?t.root:n,n.emit=xc.bind(null,n),r.ce&&r.ce(n),n}let Ce=null,er,jr;{const r=$n(),t=(e,s)=>{let i;return(i=r[e])||(i=r[e]=[]),i.push(s),n=>{i.length>1?i.forEach(o=>o(n)):i[0](n)}};er=t("__VUE_INSTANCE_SETTERS__",e=>Ce=e),jr=t("__VUE_SSR_SETTERS__",e=>ur=e)}const Ts=r=>{const t=Ce;return er(r),r.scope.on(),()=>{r.scope.off(),er(t)}},hn=()=>{Ce&&Ce.scope.off(),er(null)};function Po(r){return r.vnode.shapeFlag&4}let ur=!1;function ph(r,t=!1){t&&jr(t);const{props:e,children:s}=r.vnode,i=Po(r);jc(r,e,i,t),Qc(r,s);const n=i?gh(r,t):void 0;return t&&jr(!1),n}function gh(r,t){const e=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,kc);const{setup:s}=e;if(s){const i=r.setupContext=s.length>1?mh(r):null,n=Ts(r);_t();const o=gt(s,r,0,[r.props,i]);if(yt(),n(),Dn(o)){if(o.then(hn,hn),t)return o.then(a=>{un(r,a,t)}).catch(a=>{ar(a,r,0)});r.asyncDep=o}else un(r,o,t)}else Oo(r,t)}function un(r,t,e){q(t)?r.type.__ssrInlineRender?r.ssrRender=t:r.render=t:ae(t)&&(r.setupState=no(t)),Oo(r,e)}let dn;function Oo(r,t,e){const s=r.type;if(!r.render){if(!t&&dn&&!s.render){const i=s.template||_i(r).template;if(i){const{isCustomElement:n,compilerOptions:o}=r.appContext.config,{delimiters:a,compilerOptions:c}=s,u=we(we({isCustomElement:n,delimiters:a},o),c);s.render=dn(i,u)}}r.render=s.render||ke}{const i=Ts(r);_t();try{zc(r)}finally{yt(),i()}}}const xh={get(r,t){return Le(r,"get",""),r[t]}};function mh(r){const t=e=>{r.exposed=e||{}};return{attrs:new Proxy(r.attrs,xh),slots:r.slots,emit:r.emit,expose:t}}function Ti(r){if(r.exposed)return r.exposeProxy||(r.exposeProxy=new Proxy(no(so(r.exposed)),{get(t,e){if(e in t)return t[e];if(e in as)return as[e](r)},has(t,e){return e in t||e in as}}))}function _h(r){return q(r)&&"__vccOpts"in r}const yh=(r,t)=>sc(r,t,ur),vh="3.4.26",wi={createElement(r){const t=new Ze(r);return so(t),t},createText(r){return{name:"TextNode",text:r,parent:void 0}},createComment(r){},setText(r,t){dt("Replace Text: ",r,t),r.text=t;const e=r.parent;P(e),e.text=e.getText()},setElementText(r,t){dt("SetElementText: ",r,t);const e={name:"TextNode",text:t,parent:void 0};r.children.insert(e),r.text=r.getText()},setProperty(r,t,e=!0,s=!0){r[t]=s},insert(r,t,e){dt("INSERT: ",t,r,e),t.children.insert(r,e),r._queueDelete=!1,r instanceof Ze?t.lng&&r.render():t.isTextNode()&&(t.text=t.getText())},isTextNode(r){return r.isTextNode()},remove(r){dt("REMOVE: ",r),r.parent.children.remove(r),r._queueDelete=!0,r instanceof Ze&&queueMicrotask(()=>r.destroy())},querySelector(r){},setScopeId(r,t){return r.id=t},parentNode(r){return r.parent},nextSibling(r){const t=r.parent.children||[],e=t.indexOf(r)+1;if(e<t.length)return t[e]}},Th=wi.setProperty,wh=async function(r,t){const e=dl(ft.rendererOptions,t);await e.init();const s=wi.createElement("App");return s.lng=e.root,Sh(r).mount(s),{rootNode:s,renderer:e}},{render:Gh,createApp:Sh}=Jc(we({patchProp:Th},wi)),bh="eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIyZDE4YjEwMTA0YjdiZTlkNjFiMWYwYjVlMGEwNzM2OCIsInN1YiI6IjYwZTVjMTdlNGNhNjc2MDA3NTA4Njc3MSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.D_nqH9kd-bhhWzeVsTDPYhHnsUaNAuyAa6YATmKHqsA",Rh="https://api.themoviedb.org/3";let Fo,Bo;const Eh="w185",Ch={headers:{"Content-Type":"application/json",Authorization:"Bearer "+bh}};function br(r,t=Eh){return Bo+t+r}function Ih(r,t={}){return Fo?Kr(r,t):Do().then(()=>Kr(r,t))}function Kr(r,t={}){return fetch(Rh+r,{...Ch,...t}).then(e=>e.json())}function Do(){return Kr("/configuration").then(r=>{var t;return Fo=r,Bo=(t=r.images)==null?void 0:t.secure_base_url,r})}const Ah={get:Ih,loadConfig:Do};function Mh(r,t){return r.length>t?r.substring(0,t-3)+"...":r}function Lh(r,t=7){const e=[];for(let s=0,i=r.length;s<i;s+=t)e.push(r.slice(s,s+t));return e}function Nh(r=[]){return r.map(t=>({src:br(t.poster_path||t.profile_path),tileSrc:br(t.backdrop_path||t.profile_path,"w300"),backdrop:br(t.backdrop_path,"w1280"),href:`/entity/${t.media_type||"people"}/${t.id}`,shortTitle:Mh(t.title||t.name,30),title:t.title||t.name,data:t,entityInfo:{type:t.media_type||"people",id:t.id},heroContent:{title:t.title||t.name,description:t.overview}}))}const Rr=new Map,ks=new Map;function Ph(r){return t=>{const e=`/trending/${r}/week?page=${t}`;if(Rr.has(e))return Rr.get(e);const s=Ah.get(e).then(i=>{const n=i.results.filter(c=>!c.adult),o=(ks.has(r)?ks.get(r):[]).concat(Nh(n)),a=Lh(o);return a[a.length-1].length<7?ks.set(r,a.pop()):ks.delete(r),a});return Rr.set(e,s),s}}const Er=1200,Oh={__name:"ContentBlock",props:{title:String,description:String},setup(r){const t={display:"flex",flexDirection:"column",flexBoundary:"fixed",width:Er,height:220,gap:16},e={fontSize:50,fontFamily:"Ubuntu",fontWeight:700,maxLines:1,width:Er,contain:"width"},s={fontSize:28,fontFamily:"Ubuntu",fontWeight:400,lineHeight:32,width:Er,maxLines:3,contain:"width"};return(i,n)=>(Ut(),kt("node",{id:"contentBlock",style:t},[Qe("text",{style:e},Wi(r.title),1),Qe("text",{style:s},Wi(r.description),1)]))}};function zs(r){return typeof r=="function"}const fn={ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"Enter",l:"Last"," ":"Space",Backspace:"Back",Escape:"Escape"},Uo=os([]),Fh=r=>{Uo.value=r},Bh=r=>{let t=[];Ys(()=>oo.value,(s,i)=>{let n=s;const o=[];for(;n;)n.states.has("focus")||(n.states.add("focus"),zs(n.onFocus)&&n.onFocus.call(n,s,i)),o.push(n),n=n.parent;t.forEach(a=>{o.includes(a)||(a.states.remove("focus"),zs(a.onBlur)&&a.onBlur.call(a,s,i))}),t=o,Fh(o)});const e=s=>{if(s){const i=fn[s.key]||fn[s.keyCode],n=Uo.value;let o;for(const a of n){if(o=o||a,i){const c=a[`on${i}`];if(zs(c)&&c.call(a,s,a,o)===!0)break}else console.log(`Unhandled key event: ${s.key||s.keyCode}`);if(zs(a.onKeyPress)&&a.onKeyPress.call(a,s,i,a,o)===!0)break}return!1}};document.addEventListener("keydown",e)};function pn(r){return function(){var n,o,a;const t=this.children.length,e=this.wrap,s=this.selected||0;if(t===0)return!1;if(r==="right"||r==="down")do if(this.selected=(this.selected||0)%t+1,this.selected>=t){if(!e){this.selected=void 0;break}this.selected=0}while((n=this.children[this.selected])!=null&&n.skipFocus);else if(r==="left"||r==="up")do if(this.selected=(this.selected||0)%t-1,this.selected<0){if(!e){this.selected=void 0;break}this.selected=t-1}while((o=this.children[this.selected])!=null&&o.skipFocus);if(this.selected===void 0&&(this.selected=s,(a=this.children[this.selected])!=null&&a.states.has("focus")))return!1;const i=this.children[this.selected];if(this.onSelectedChanged&&this.onSelectedChanged.call(this,this,i,this.selected,s),this.plinko&&s!==void 0){const u=this.children[s].selected||0;i.selected=u<i.children.length?u:i.children.length-1}return i.setFocus(),!0}}const Dh={style:{width:1920,height:1080}},Uh=Qe("node",{src:"./assets/vue.png",width:200,height:200,x:30,y:20},null,-1),kh=["onRight","onLeft"],zh=["src"],$h={width:1920,height:1080,zIndex:-5},Wh=Qe("node",{src:"./assets/hero-mask-inverted.png",color:255,width:1920,height:1080},null,-1),Xh="Follow the mythic journey of Paul Atreides as he unites with Chani and the Fremen while on a path of revenge against the conspirators who destroyed his family. Facing a choice between the love of his life and the fate of the known universe, Paul endeavors to prevent a terrible future only he can foresee.",Yh={__name:"App",setup(r){Bh();const t=os(1),e=os([]),s=os(null),i={alpha:t.value,color:4294967295},n=pn("right"),o=pn("left"),a={borderRadius:16,width:185,height:278,scale:1,zIndex:2,transition:{scale:{duration:250,easing:"ease-in-out"}},border:{width:0,color:0},focus:{scale:1.1,border:{color:4294967142,width:8}}};return _o(()=>{Ph("all")(1).then(c=>{e.value=c,setTimeout(()=>s.value.children[1].children[1].setFocus(),100)})}),(c,u)=>(Ut(),kt("node",Dh,[Uh,xt(Oh,{y:250,x:150,title:"Dune: Part 2",description:Xh}),Qe("node",{ref_key:"column",ref:s,x:150,y:450,width:1920,height:1080,display:"flex",flexDirection:"column"},[(Ut(!0),kt(Xe,null,Ji(e.value,h=>(Ut(),kt("node",{onRight:$r(n),onLeft:$r(o),display:"flex",justifyContent:"spaceBetween",width:1620,height:300},[(Ut(!0),kt(Xe,null,Ji(h,d=>(Ut(),kt("node",{style:a,src:d.src},null,8,zh))),256))],40,kh))),256))],512),Qe("node",$h,[Qe("node",{ref:"bg1",src:"https://image.tmdb.org/t/p/w1280/87IVlclAfWL6mdicU1DDuxdwXwe.jpg",style:i},null,512),Qe("node",{ref:"bg2",style:i,alpha:"0"},null,512),Wh])]))}};ft.debug=!1;ft.rendererOptions={enableInspector:!0};wh(Yh);
//# sourceMappingURL=main-DUXbbnt_.js.map
